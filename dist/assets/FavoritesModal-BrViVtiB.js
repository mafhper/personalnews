import{r as l,j as e}from"./performance-C3ZVEFVv.js";import{Modal as _}from"./Modal-CVWjlAkP.js";import{L as q}from"./LazyImage-CihW6eNW.js";import{u as Q,f as Z}from"./useFavorites-CwzlCAEB.js";import{u as P}from"./useNotificationReplacements-DNUlIiku.js";import{L as W,C as $,B as S}from"./Card-CtY6ZNQY.js";import{I as G}from"./Input-qX6wi8xy.js";import{d as H}from"./index-cnnzl-gl.js";import{S as k,B as M,A as C}from"./Badge-jsBobDwu.js";import{r as J}from"./services-DShKEQpD.js";import"./react-vendor-Cgg2GOmP.js";const K=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],V=H("chevron-down",K),X={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-12 px-4 text-base"},Y={outlined:"bg-[rgb(var(--color-surface))] border-[rgb(var(--color-border))] text-[rgb(var(--color-text))]",filled:"bg-[rgb(var(--color-background))] border-[rgb(var(--color-border))] text-[rgb(var(--color-text))]"},F=l.forwardRef(({label:g,error:n,helperText:a,size:b="md",variant:u="outlined",options:f,placeholder:h,className:v="",id:p,...d},m)=>{const y=l.useId(),c=p||`select-${y}`,j=!!n,i="w-full rounded-lg border transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-primary))] focus:border-[rgb(var(--color-primary))] disabled:opacity-50 disabled:cursor-not-allowed appearance-none pr-10",w=X[b],N=Y[u],A=`${i} ${w} ${N} ${j?"border-red-500 focus:ring-red-500 focus:border-red-500":""} ${v}`.trim();return e.jsxs("div",{className:"w-full",children:[g&&e.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-[rgb(var(--color-text))] mb-1",children:g}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{ref:m,id:c,className:A,"aria-invalid":j,"aria-describedby":n?`${c}-error`:a?`${c}-helper`:void 0,...d,children:[h&&e.jsx("option",{value:"",disabled:!0,children:h}),f.map(x=>e.jsx("option",{value:x.value,disabled:x.disabled,children:x.label},x.value))]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx(V,{className:"w-4 h-4 text-[rgb(var(--color-textSecondary))]"})})]}),n&&e.jsx("p",{id:`${c}-error`,className:"mt-1 text-sm text-red-600",children:n}),a&&!n&&e.jsx("p",{id:`${c}-helper`,className:"mt-1 text-sm text-[rgb(var(--color-textSecondary))]",children:a})]})}),ee={default:"bg-[rgb(var(--color-surface))] hover:bg-[rgb(var(--color-surface))]/80 text-[rgb(var(--color-text))] border-[rgb(var(--color-border))]",primary:"bg-[rgb(var(--color-primary))] hover:bg-[rgb(var(--color-primary))]/90 text-white border-transparent",secondary:"bg-[rgb(var(--color-surface))] hover:bg-[rgb(var(--color-surface))]/80 text-[rgb(var(--color-text))] border-[rgb(var(--color-border))]",danger:"bg-[rgb(var(--color-error))] hover:bg-[rgb(var(--color-error))]/90 text-white border-transparent",ghost:"bg-transparent hover:bg-[rgb(var(--color-surface))]/50 text-[rgb(var(--color-text))] border-transparent"},re={sm:"h-8 w-8 p-1.5",md:"h-10 w-10 p-2",lg:"h-12 w-12 p-2.5"},se=({children:g,icon:n,variant:a="default",size:b="md",loading:u=!1,disabled:f=!1,onClick:h,type:v="button",className:p="",title:d,"aria-label":m})=>{const y="inline-flex items-center justify-center rounded-lg border font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-primary))] focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",c=ee[a],j=re[b],i=`${y} ${c} ${j} ${p}`.trim(),w=u?e.jsx(W,{className:"w-4 h-4 animate-spin"}):n||g;return e.jsx("button",{type:v,className:i,onClick:h,disabled:f||u,title:d,"aria-label":m||d,children:w})},ge=({isOpen:g,onClose:n})=>{const{favorites:a,removeFromFavorites:b,clearAllFavorites:u,exportFavorites:f,importFavorites:h,getFavoritesByCategory:v,getFavoritesBySource:p}=Q(),{alertSuccess:d}=P(),[m,y]=l.useState(""),[c,j]=l.useState("All"),[i,w]=l.useState(""),[N,T]=l.useState("recent"),[A,x]=l.useState(!1),R=l.useMemo(()=>{const r=new Set;return a.forEach(o=>{o.categories?.forEach(t=>r.add(t))}),["All",...Array.from(r).sort()]},[a]),z=l.useMemo(()=>{const r=new Set;return a.forEach(o=>{r.add(o.sourceTitle),o.author&&r.add(o.author)}),["All",...Array.from(r).sort()]},[a]),I=l.useMemo(()=>{let r=a;if(c!=="All"&&(r=v(c)),i&&i!=="All"&&(r=p(i)),m.trim()){const t=m.toLowerCase();r=r.filter(s=>s.title.toLowerCase().includes(t)||s.sourceTitle.toLowerCase().includes(t)||s.author?.toLowerCase().includes(t)||s.description?.toLowerCase().includes(t))}return[...r].sort((t,s)=>{switch(N){case"title":return t.title.localeCompare(s.title);case"source":return t.sourceTitle.localeCompare(s.sourceTitle);default:return new Date(s.favoritedAt).getTime()-new Date(t.favoritedAt).getTime()}})},[a,c,i,m,N,v,p]),B=l.useCallback(()=>{const r=f(),o=new Blob([r],{type:"application/json"}),t=URL.createObjectURL(o),s=document.createElement("a");s.href=t,s.download=`favorites-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t)},[f]),D=l.useCallback(r=>{const o=r.target.files?.[0];if(!o)return;const t=new FileReader;t.onload=async s=>{const O=s.target?.result;h(O)?await d("Favorites imported successfully!"):await d("Failed to import favorites. Please check the file format.")},t.readAsText(o),r.target.value=""},[h,d]),E=l.useCallback(r=>{const o=Z(r);b(o)},[b]),U=l.useCallback(()=>{u(),x(!1)},[u]),L=r=>{const o=new Date(r),t=Math.floor((new Date().getTime()-o.getTime())/1e3);let s=t/31536e3;return s>1?Math.floor(s)+" years ago":(s=t/2592e3,s>1?Math.floor(s)+" months ago":(s=t/86400,s>1?Math.floor(s)+" days ago":(s=t/3600,s>1?Math.floor(s)+" hours ago":(s=t/60,s>1?Math.floor(s)+" minutes ago":Math.floor(t)+" seconds ago"))))};return e.jsx(_,{isOpen:g,onClose:n,children:e.jsxs($,{className:"max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col",elevation:"lg",children:[e.jsxs("div",{className:"border-b border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(k.Success,{className:"w-6 h-6 text-red-500"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"My Favorites"}),e.jsxs(M,{variant:"primary",children:[a.length," articles"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(S,{onClick:B,variant:"secondary",size:"sm",icon:e.jsx(C.Export,{}),children:"Export"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsxs("span",{className:"inline-flex items-center justify-center rounded-lg border font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-primary))] focus:ring-offset-2 bg-[rgb(var(--color-surface))] hover:bg-[rgb(var(--color-surface))]/80 text-[rgb(var(--color-text))] border-[rgb(var(--color-border))] h-8 px-3 text-sm gap-1.5",children:[e.jsx(C.Import,{}),"Import"]}),e.jsx("input",{type:"file",accept:".json",onChange:D,className:"hidden"})]}),e.jsx(S,{onClick:()=>x(!0),variant:"danger",size:"sm",icon:e.jsx(C.Delete,{}),disabled:a.length===0,children:"Clear All"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(G,{type:"text",placeholder:"Search favorites...",value:m,onChange:r=>y(r.target.value),className:"pl-10"}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-[rgb(var(--color-textSecondary))]",children:e.jsx(C.Search,{})})]}),e.jsx(F,{value:c,onChange:r=>j(r.target.value),options:R.map(r=>({value:r,label:r}))}),e.jsx(F,{value:i,onChange:r=>w(r.target.value),options:z.map(r=>({value:r,label:r}))}),e.jsx(F,{value:N,onChange:r=>T(r.target.value),options:[{value:"recent",label:"Most Recent"},{value:"title",label:"Title A-Z"},{value:"source",label:"Source A-Z"}]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:I.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(k.Success,{className:"w-16 h-16 mx-auto text-gray-600 mb-6 text-red-500"}),e.jsx("h3",{className:"text-xl font-semibold text-[rgb(var(--color-textSecondary))] mb-3",children:a.length===0?"No favorites yet":"No matching favorites"}),e.jsx("p",{className:"text-[rgb(var(--color-textSecondary))] max-w-md mx-auto",children:a.length===0?"Start favoriting articles to see them here. Click the heart icon on any article to add it to your favorites.":"Try adjusting your search terms or filters to find what you're looking for."})]}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:I.map(r=>e.jsx($,{className:"hover:border-gray-600 transition-all duration-200 hover:shadow-lg",elevation:"sm",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx(q,{src:r.imageUrl||`https://picsum.photos/seed/${r.link}/80/80`,alt:`Thumbnail for ${r.title}`,className:"w-20 h-20 object-cover rounded-lg flex-shrink-0 shadow-sm"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("a",{href:r.link,target:"_blank",rel:"noopener noreferrer",className:"text-white font-semibold hover:text-blue-400 transition-colors line-clamp-2 text-lg leading-tight",children:r.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-3 text-sm",children:[e.jsx(M,{variant:"secondary",className:"text-xs",children:r.author||r.sourceTitle}),e.jsx("span",{className:"text-[rgb(var(--color-textSecondary))]",children:L(r.pubDate)}),e.jsxs("span",{className:"text-[rgb(var(--color-textSecondary))]",children:["Favorited ",L(r.favoritedAt)]})]}),r.description&&e.jsx("p",{className:"text-[rgb(var(--color-textSecondary))] text-sm mt-3 line-clamp-2 leading-relaxed",children:J(r.description)})]}),e.jsx(se,{onClick:()=>E(r),variant:"ghost",size:"sm",icon:e.jsx(k.Success,{className:"text-red-400"}),className:"ml-4 text-red-400 hover:text-red-300 hover:bg-red-900/20 flex-shrink-0",title:"Remove from favorites"})]})})]})},r.id))})}),A&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10",children:e.jsxs($,{className:"max-w-md w-full mx-4",elevation:"lg",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(k.Warning,{className:"w-6 h-6 text-yellow-500 mr-3"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Clear All Favorites?"})]}),e.jsxs("p",{className:"text-[rgb(var(--color-textSecondary))] mb-6 leading-relaxed",children:["This will permanently remove all"," ",e.jsx("strong",{children:a.length})," favorites. This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(S,{onClick:U,variant:"danger",className:"flex-1",icon:e.jsx(C.Delete,{}),children:"Clear All"}),e.jsx(S,{onClick:()=>x(!1),variant:"secondary",className:"flex-1",children:"Cancel"})]})]})})]})})};export{ge as FavoritesModal};
