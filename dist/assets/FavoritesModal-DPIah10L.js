import{r as l,j as e}from"./performance-BuPgOiMU.js";import{Modal as _}from"./Modal-DEFs4uI7.js";import{u as q,f as Q,L as Z}from"./useFavorites-C2trdede.js";import{u as P}from"./useNotificationReplacements-C-4jLxqd.js";import{L as W,C as F,B as S}from"./Card-D5uq-kKH.js";import{I as G}from"./Input-DiH6K0tF.js";import{c as H}from"./index-DgGObAZ7.js";import{S as k,B as I,A as N}from"./Badge-qOmlqDCB.js";import{n as J}from"./services-CCwIs3xp.js";import"./react-vendor-DlBnNAMw.js";const K=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],V=H("chevron-down",K),X={sm:"h-8 px-3 text-sm",md:"h-10 px-4 text-sm",lg:"h-12 px-4 text-base"},Y={outlined:"bg-[rgb(var(--color-surface))] border-[rgb(var(--color-border))] text-[rgb(var(--color-text))]",filled:"bg-[rgb(var(--color-background))] border-[rgb(var(--color-border))] text-[rgb(var(--color-text))]"},M=l.forwardRef(({label:g,error:n,helperText:a,size:b="md",variant:x="outlined",options:f,placeholder:u,className:v="",id:p,...h},m)=>{const c=p||`select-${Math.random().toString(36).substr(2,9)}`,i=!!n,y="w-full rounded-lg border transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-primary))] focus:border-[rgb(var(--color-primary))] disabled:opacity-50 disabled:cursor-not-allowed appearance-none pr-10",d=X[b],w=Y[x],A=`${y} ${d} ${w} ${i?"border-red-500 focus:ring-red-500 focus:border-red-500":""} ${v}`.trim();return e.jsxs("div",{className:"w-full",children:[g&&e.jsx("label",{htmlFor:c,className:"block text-sm font-medium text-[rgb(var(--color-text))] mb-1",children:g}),e.jsxs("div",{className:"relative",children:[e.jsxs("select",{ref:m,id:c,className:A,"aria-invalid":i,"aria-describedby":n?`${c}-error`:a?`${c}-helper`:void 0,...h,children:[u&&e.jsx("option",{value:"",disabled:!0,children:u}),f.map(j=>e.jsx("option",{value:j.value,disabled:j.disabled,children:j.label},j.value))]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx(V,{className:"w-4 h-4 text-[rgb(var(--color-textSecondary))]"})})]}),n&&e.jsx("p",{id:`${c}-error`,className:"mt-1 text-sm text-red-600",children:n}),a&&!n&&e.jsx("p",{id:`${c}-helper`,className:"mt-1 text-sm text-[rgb(var(--color-textSecondary))]",children:a})]})}),ee={default:"bg-[rgb(var(--color-surface))] hover:bg-[rgb(var(--color-surface))]/80 text-[rgb(var(--color-text))] border-[rgb(var(--color-border))]",primary:"bg-[rgb(var(--color-primary))] hover:bg-[rgb(var(--color-primary))]/90 text-white border-transparent",secondary:"bg-[rgb(var(--color-surface))] hover:bg-[rgb(var(--color-surface))]/80 text-[rgb(var(--color-text))] border-[rgb(var(--color-border))]",danger:"bg-[rgb(var(--color-error))] hover:bg-[rgb(var(--color-error))]/90 text-white border-transparent",ghost:"bg-transparent hover:bg-[rgb(var(--color-surface))]/50 text-[rgb(var(--color-text))] border-transparent"},re={sm:"h-8 w-8 p-1.5",md:"h-10 w-10 p-2",lg:"h-12 w-12 p-2.5"},te=({children:g,icon:n,variant:a="default",size:b="md",loading:x=!1,disabled:f=!1,onClick:u,type:v="button",className:p="",title:h,"aria-label":m})=>{const c="inline-flex items-center justify-center rounded-lg border font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-primary))] focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",i=ee[a],y=re[b],d=`${c} ${i} ${y} ${p}`.trim(),w=x?e.jsx(W,{className:"w-4 h-4 animate-spin"}):n||g;return e.jsx("button",{type:v,className:d,onClick:u,disabled:f||x,title:h,"aria-label":m||h,children:w})},he=({isOpen:g,onClose:n})=>{const{favorites:a,removeFromFavorites:b,clearAllFavorites:x,exportFavorites:f,importFavorites:u,getFavoritesByCategory:v,getFavoritesBySource:p}=q(),{alertSuccess:h}=P(),[m,c]=l.useState(""),[i,y]=l.useState("All"),[d,w]=l.useState(""),[C,A]=l.useState("recent"),[j,$]=l.useState(!1),R=l.useMemo(()=>{const r=new Set;return a.forEach(o=>{o.categories?.forEach(s=>r.add(s))}),["All",...Array.from(r).sort()]},[a]),z=l.useMemo(()=>{const r=new Set;return a.forEach(o=>{r.add(o.sourceTitle),o.author&&r.add(o.author)}),["All",...Array.from(r).sort()]},[a]),T=l.useMemo(()=>{let r=a;if(i!=="All"&&(r=v(i)),d&&d!=="All"&&(r=p(d)),m.trim()){const s=m.toLowerCase();r=r.filter(t=>t.title.toLowerCase().includes(s)||t.sourceTitle.toLowerCase().includes(s)||t.author?.toLowerCase().includes(s)||t.description?.toLowerCase().includes(s))}return[...r].sort((s,t)=>{switch(C){case"title":return s.title.localeCompare(t.title);case"source":return s.sourceTitle.localeCompare(t.sourceTitle);case"recent":default:return new Date(t.favoritedAt).getTime()-new Date(s.favoritedAt).getTime()}})},[a,i,d,m,C,v,p]),B=l.useCallback(()=>{const r=f(),o=new Blob([r],{type:"application/json"}),s=URL.createObjectURL(o),t=document.createElement("a");t.href=s,t.download=`favorites-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s)},[f]),D=l.useCallback(r=>{const o=r.target.files?.[0];if(!o)return;const s=new FileReader;s.onload=async t=>{const O=t.target?.result;u(O)?await h("Favorites imported successfully!"):await h("Failed to import favorites. Please check the file format.")},s.readAsText(o),r.target.value=""},[u]),E=l.useCallback(r=>{const o=Q(r);b(o)},[b]),U=l.useCallback(()=>{x(),$(!1)},[x]),L=r=>{const o=new Date(r),s=Math.floor((new Date().getTime()-o.getTime())/1e3);let t=s/31536e3;return t>1?Math.floor(t)+" years ago":(t=s/2592e3,t>1?Math.floor(t)+" months ago":(t=s/86400,t>1?Math.floor(t)+" days ago":(t=s/3600,t>1?Math.floor(t)+" hours ago":(t=s/60,t>1?Math.floor(t)+" minutes ago":Math.floor(s)+" seconds ago"))))};return e.jsx(_,{isOpen:g,onClose:n,children:e.jsxs(F,{className:"max-w-6xl w-full max-h-[90vh] overflow-hidden flex flex-col",elevation:"lg",children:[e.jsxs("div",{className:"border-b border-gray-700 p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(k.Success,{className:"w-6 h-6 text-red-500"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"My Favorites"}),e.jsxs(I,{variant:"primary",children:[a.length," articles"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(S,{onClick:B,variant:"secondary",size:"sm",icon:e.jsx(N.Export,{}),children:"Export"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsxs("span",{className:"inline-flex items-center justify-center rounded-lg border font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-primary))] focus:ring-offset-2 bg-[rgb(var(--color-surface))] hover:bg-[rgb(var(--color-surface))]/80 text-[rgb(var(--color-text))] border-[rgb(var(--color-border))] h-8 px-3 text-sm gap-1.5",children:[e.jsx(N.Import,{}),"Import"]}),e.jsx("input",{type:"file",accept:".json",onChange:D,className:"hidden"})]}),e.jsx(S,{onClick:()=>$(!0),variant:"danger",size:"sm",icon:e.jsx(N.Delete,{}),disabled:a.length===0,children:"Clear All"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(G,{type:"text",placeholder:"Search favorites...",value:m,onChange:r=>c(r.target.value),className:"pl-10"}),e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-[rgb(var(--color-textSecondary))]",children:e.jsx(N.Search,{})})]}),e.jsx(M,{value:i,onChange:r=>y(r.target.value),options:R.map(r=>({value:r,label:r}))}),e.jsx(M,{value:d,onChange:r=>w(r.target.value),options:z.map(r=>({value:r,label:r}))}),e.jsx(M,{value:C,onChange:r=>A(r.target.value),options:[{value:"recent",label:"Most Recent"},{value:"title",label:"Title A-Z"},{value:"source",label:"Source A-Z"}]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:T.length===0?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(k.Success,{className:"w-16 h-16 mx-auto text-gray-600 mb-6 text-red-500"}),e.jsx("h3",{className:"text-xl font-semibold text-[rgb(var(--color-textSecondary))] mb-3",children:a.length===0?"No favorites yet":"No matching favorites"}),e.jsx("p",{className:"text-[rgb(var(--color-textSecondary))] max-w-md mx-auto",children:a.length===0?"Start favoriting articles to see them here. Click the heart icon on any article to add it to your favorites.":"Try adjusting your search terms or filters to find what you're looking for."})]}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:T.map(r=>e.jsx(F,{className:"hover:border-gray-600 transition-all duration-200 hover:shadow-lg",elevation:"sm",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx(Z,{src:r.imageUrl||`https://picsum.photos/seed/${r.link}/80/80`,alt:`Thumbnail for ${r.title}`,className:"w-20 h-20 object-cover rounded-lg flex-shrink-0 shadow-sm"}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("a",{href:r.link,target:"_blank",rel:"noopener noreferrer",className:"text-white font-semibold hover:text-blue-400 transition-colors line-clamp-2 text-lg leading-tight",children:r.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3 mt-3 text-sm",children:[e.jsx(I,{variant:"secondary",className:"text-xs",children:r.author||r.sourceTitle}),e.jsx("span",{className:"text-[rgb(var(--color-textSecondary))]",children:L(r.pubDate)}),e.jsxs("span",{className:"text-[rgb(var(--color-textSecondary))]",children:["Favorited ",L(r.favoritedAt)]})]}),r.description&&e.jsx("p",{className:"text-[rgb(var(--color-textSecondary))] text-sm mt-3 line-clamp-2 leading-relaxed",children:J(r.description)})]}),e.jsx(te,{onClick:()=>E(r),variant:"ghost",size:"sm",icon:e.jsx(k.Success,{className:"text-red-400"}),className:"ml-4 text-red-400 hover:text-red-300 hover:bg-red-900/20 flex-shrink-0",title:"Remove from favorites"})]})})]})},r.id))})}),j&&e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center z-10",children:e.jsxs(F,{className:"max-w-md w-full mx-4",elevation:"lg",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(k.Warning,{className:"w-6 h-6 text-yellow-500 mr-3"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Clear All Favorites?"})]}),e.jsxs("p",{className:"text-[rgb(var(--color-textSecondary))] mb-6 leading-relaxed",children:["This will permanently remove all"," ",e.jsx("strong",{children:a.length})," favorites. This action cannot be undone."]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(S,{onClick:U,variant:"danger",className:"flex-1",icon:e.jsx(N.Delete,{}),children:"Clear All"}),e.jsx(S,{onClick:()=>$(!1),variant:"secondary",className:"flex-1",children:"Cancel"})]})]})})]})})};export{he as FavoritesModal};
