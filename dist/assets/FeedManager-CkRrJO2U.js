import{j as e,r as g,R as Ve}from"./performance-C1sKO-E3.js";import{d as Ye,b as ae,a as Be,u as He,r as Ce,C as Ke,e as Je,D as Qe,f as Ze}from"./index-B0k4tHIf.js";import{u as We,n as qe,j as et,o as tt}from"./services-BY3oiKYC.js";import{u as Ie}from"./useNotificationReplacements-BPd9HQ_B.js";import{Modal as st}from"./Modal-Cjvi7lJz.js";import{C as je,B as ze}from"./Card-fr0dBY15.js";import{S as rt,B as _e,A as at}from"./Badge-B6u2DLXj.js";import"./react-vendor-Cgg2GOmP.js";const ot=[["path",{d:"M4 11a9 9 0 0 1 9 9",key:"pv89mb"}],["path",{d:"M4 4a16 16 0 0 1 16 16",key:"k0647b"}],["circle",{cx:"5",cy:"19",r:"1",key:"bfqh0e"}]],nt=Ye("rss",ot),it={RSS:({className:p="w-4 h-4",size:t})=>e.jsx(nt,{className:p,size:t})};class lt{constructor(t){this.PROXY_CONFIGS=[{url:"https://api.allorigins.win/get?url=",name:"AllOrigins",responseTransform:s=>{try{return JSON.parse(s).contents||s}catch{return s}},headers:{Accept:"application/json"},timeout:1e4,priority:1,enabled:!0},{url:"https://corsproxy.io/?",name:"CorsProxy.io",headers:{Accept:"application/rss+xml, application/atom+xml, application/xml, text/xml","User-Agent":"Personal News Dashboard/1.0"},timeout:8e3,priority:2,enabled:!0},{url:"https://cors-anywhere.herokuapp.com/",name:"CORS Anywhere",headers:{Accept:"application/rss+xml, application/atom+xml, application/xml, text/xml","User-Agent":"Personal News Dashboard/1.0","X-Requested-With":"XMLHttpRequest"},timeout:12e3,priority:3,enabled:!0},{url:"https://api.codetabs.com/v1/proxy?quest=",name:"CodeTabs",responseTransform:s=>{try{const r=JSON.parse(s);return r.data?r.data:s}catch{return s}},timeout:15e3,priority:4,enabled:!0}],this.proxyStats=new Map,this.proxyHealthCheck=new Map,this.config={maxRetries:3,healthCheckInterval:300*1e3,failureThreshold:3,recoveryThreshold:2,defaultTimeout:1e4,...t},this.initializeProxyStats(),this.startHealthMonitoring()}getAvailableProxies(){return this.PROXY_CONFIGS.filter(t=>t.enabled&&this.isProxyHealthy(t.name)).sort((t,s)=>{const r=this.proxyStats.get(t.name),a=this.proxyStats.get(s.name),o=r?.healthScore||0,n=a?.healthScore||0;return Math.abs(o-n)>.1?n-o:t.priority-s.priority})}async tryProxy(t,s){const r=Date.now();try{const a=this.buildProxyUrl(t,s),o=t.timeout||this.config.defaultTimeout,n=new AbortController,i=setTimeout(()=>n.abort(),o),c=await fetch(a,{method:"GET",signal:n.signal,headers:t.headers||{}});clearTimeout(i);const d=Date.now()-r;if(!c.ok)throw new Error(`HTTP ${c.status}: ${c.statusText}`);let m=await c.text();return t.responseTransform&&(m=t.responseTransform(m)),this.recordProxyAttempt({proxyName:t.name,proxyUrl:a,targetUrl:s,timestamp:r,success:!0,responseTime:d,statusCode:c.status}),m}catch(a){const o=Date.now()-r;throw this.recordProxyAttempt({proxyName:t.name,proxyUrl:this.buildProxyUrl(t,s),targetUrl:s,timestamp:r,success:!1,responseTime:o,error:a.message}),a}}async tryProxiesWithFailover(t){const s=this.getAvailableProxies(),r=[];if(s.length===0)throw new Error("No healthy proxies available");let a=null;for(const o of s){const n=Date.now();try{const i=await this.tryProxy(o,t),c={proxyName:o.name,proxyUrl:this.buildProxyUrl(o,t),targetUrl:t,timestamp:n,success:!0,responseTime:Date.now()-n};return r.push(c),{content:i,proxyUsed:o.name,attempts:r}}catch(i){a=i;const c={proxyName:o.name,proxyUrl:this.buildProxyUrl(o,t),targetUrl:t,timestamp:n,success:!1,responseTime:Date.now()-n,error:i.message};r.push(c),this.markProxyStatus(o.name,!1);continue}}throw new Error(`All proxies failed. Last error: ${a?.message||"Unknown error"}`)}markProxyStatus(t,s){const r=this.proxyStats.get(t);r&&(s?(r.consecutiveFailures=0,r.lastSuccess=Date.now()):(r.consecutiveFailures++,r.lastFailure=Date.now()),this.proxyHealthCheck.set(t,r.consecutiveFailures<this.config.failureThreshold),this.updateHealthScore(t))}getProxyStats(){return new Map(this.proxyStats)}getProxyStatsByName(t){return this.proxyStats.get(t)}getOverallStats(){const t=Array.from(this.proxyStats.values());return{totalProxies:this.PROXY_CONFIGS.length,healthyProxies:Array.from(this.proxyHealthCheck.values()).filter(Boolean).length,totalRequests:t.reduce((s,r)=>s+r.totalRequests,0),totalSuccesses:t.reduce((s,r)=>s+r.success,0),totalFailures:t.reduce((s,r)=>s+r.failures,0),averageResponseTime:t.length>0?t.reduce((s,r)=>s+r.avgResponseTime,0)/t.length:0}}resetStats(){this.initializeProxyStats()}disableProxy(t){const s=this.PROXY_CONFIGS.find(r=>r.name===t);s&&(s.enabled=!1,this.proxyHealthCheck.set(t,!1))}enableProxy(t){const s=this.PROXY_CONFIGS.find(r=>r.name===t);if(s){s.enabled=!0;const r=this.proxyStats.get(t);r&&(r.consecutiveFailures=0),this.proxyHealthCheck.set(t,!0)}}getConfiguration(){return{...this.config}}destroy(){this.healthCheckTimer&&(clearInterval(this.healthCheckTimer),this.healthCheckTimer=void 0)}initializeProxyStats(){this.PROXY_CONFIGS.forEach(t=>{this.proxyStats.set(t.name,{success:0,failures:0,totalRequests:0,avgResponseTime:0,lastUsed:0,lastSuccess:0,lastFailure:0,consecutiveFailures:0,healthScore:1}),this.proxyHealthCheck.set(t.name,!0)})}buildProxyUrl(t,s){return t.url+encodeURIComponent(s)}isProxyHealthy(t){return this.proxyHealthCheck.get(t)||!1}recordProxyAttempt(t){const s=this.proxyStats.get(t.proxyName);if(!s)return;s.totalRequests++,s.lastUsed=t.timestamp,t.success?(s.success++,s.lastSuccess=t.timestamp,s.consecutiveFailures=0):(s.failures++,s.lastFailure=t.timestamp,s.consecutiveFailures++);const r=s.avgResponseTime*(s.totalRequests-1)+t.responseTime;s.avgResponseTime=r/s.totalRequests,this.updateHealthScore(t.proxyName)}updateHealthScore(t){const s=this.proxyStats.get(t);if(!s)return;let r=1;if(s.totalRequests>0){const a=s.success/s.totalRequests;r*=a}if(s.consecutiveFailures>=this.config.failureThreshold)r*=.1;else{const a=s.consecutiveFailures/this.config.failureThreshold;r*=1-.4*a}if(s.avgResponseTime>5e3){const a=Math.min((s.avgResponseTime-5e3)/1e4,1);r*=1-.1*a}s.healthScore=Math.max(0,Math.min(1,r))}startHealthMonitoring(){this.healthCheckTimer=setInterval(()=>{this.performHealthCheck()},this.config.healthCheckInterval)}performHealthCheck(){this.PROXY_CONFIGS.forEach(t=>{if(!t.enabled)return;const s=this.proxyStats.get(t.name);if(!this.proxyHealthCheck.get(t.name)&&s){const a=Date.now()-s.lastFailure,o=300*1e3;a>o&&(s.consecutiveFailures=0,this.proxyHealthCheck.set(t.name,!0),this.updateHealthScore(t.name))}})}}const $e=new lt;class ct{constructor(t){this.cache=new Map,this.stats={hitCount:0,missCount:0},this.config={maxSize:50*1024*1024,maxEntries:1e4,defaultSuccessTTL:1800*1e3,defaultFailureTTL:300*1e3,discoveryTTL:3600*1e3,cleanupInterval:300*1e3,enableStats:!0},this.cleanupTimer=null,t&&this.configure(t),this.startAutomaticCleanup()}get(t){const s=this.cache.get(t);if(!s)return this.config.enableStats&&this.stats.missCount++,null;const r=Date.now();return r-s.timestamp>s.ttl?(this.cache.delete(t),this.config.enableStats&&this.stats.missCount++,null):(s.accessCount++,s.lastAccessed=r,this.config.enableStats&&this.stats.hitCount++,s)}set(t,s,r){const a=Date.now(),o=r||this.determineTTL(t,s),n=this.estimateSize(s);this.ensureCapacity(n);const i={data:s,timestamp:a,ttl:o,accessCount:0,lastAccessed:a,key:t,size:n};this.cache.set(t,i)}invalidate(t){return this.cache.delete(t)}invalidatePattern(t){const s=new RegExp(t.replace(/\*/g,".*"));let r=0;for(const[a]of this.cache)s.test(a)&&(this.cache.delete(a),r++);return r}cleanup(){const t=Date.now();let s=0;for(const[r,a]of this.cache)t-a.timestamp>a.ttl&&(this.cache.delete(r),s++);return s}clear(){this.cache.clear(),this.stats.hitCount=0,this.stats.missCount=0}getStats(){const t=Array.from(this.cache.values()),s=t.reduce((m,b)=>m+b.size,0),r=t.reduce((m,b)=>m+b.accessCount,0),a=t.map(m=>m.timestamp),o=a.length>0?Math.min(...a):0,n=a.length>0?Math.max(...a):0,i=this.stats.hitCount+this.stats.missCount,c=i>0?this.stats.hitCount/i:0,d={success:0,failure:0,discovery:0,custom:0};return t.forEach(m=>{m.ttl===this.config.defaultSuccessTTL?d.success++:m.ttl===this.config.defaultFailureTTL?d.failure++:m.ttl===this.config.discoveryTTL?d.discovery++:d.custom++}),{totalEntries:this.cache.size,totalSize:s,hitCount:this.stats.hitCount,missCount:this.stats.missCount,hitRate:Math.round(c*100)/100,oldestEntry:o,newestEntry:n,averageAccessCount:t.length>0?Math.round(r/t.length):0,memoryUsage:{used:s,limit:this.config.maxSize,percentage:this.config.maxSize>0?Math.round(s/this.config.maxSize*100):0},ttlDistribution:d}}configure(t){this.config={...this.config,...t},t.cleanupInterval!==void 0&&(this.stopAutomaticCleanup(),this.startAutomaticCleanup())}getConfiguration(){return{...this.config}}refresh(t){const s=this.cache.get(t);return s?(s.timestamp=0,!0):!1}getKeys(t){const s=Array.from(this.cache.keys());if(!t)return s;const r=new RegExp(t.replace(/\*/g,".*"));return s.filter(a=>r.test(a))}has(t){const s=this.cache.get(t);return s?Date.now()-s.timestamp<=s.ttl:!1}getMetadata(t){const s=this.cache.get(t);if(!s)return null;const{data:r,...a}=s;return a}determineTTL(t,s){if(t.includes("discovery:")||t.includes("feeds:"))return this.config.discoveryTTL;if(typeof s=="object"&&s!==null){if(s.isValid===!0||s.success===!0)return this.config.defaultSuccessTTL;if(s.isValid===!1||s.success===!1)return this.config.defaultFailureTTL}return this.config.defaultSuccessTTL}estimateSize(t){try{const s=JSON.stringify(t);return new Blob([s]).size}catch{return typeof t=="string"?t.length*2:typeof t=="object"&&t!==null?1e3:100}}ensureCapacity(t){this.cache.size>=this.config.maxEntries&&this.evictLRU(0),Array.from(this.cache.values()).reduce((r,a)=>r+a.size,0)+t>this.config.maxSize&&this.evictLRU(t)}evictLRU(t){const s=Array.from(this.cache.entries());s.sort(([,a],[,o])=>a.lastAccessed-o.lastAccessed);let r=0;for(const[a,o]of s)if(this.cache.delete(a),r+=o.size,r>=t&&this.cache.size<this.config.maxEntries||this.cache.size<=Math.floor(this.config.maxEntries*.8))break}startAutomaticCleanup(){this.cleanupTimer&&clearInterval(this.cleanupTimer),this.cleanupTimer=setInterval(()=>{this.cleanup()},this.config.cleanupInterval)}stopAutomaticCleanup(){this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}destroy(){this.stopAutomaticCleanup(),this.clear()}}const z=new ct;class dt{constructor(){this.COMMON_FEED_PATHS=["/rss.xml","/feed.xml","/atom.xml","/rss","/feed","/feeds/all.atom.xml","/feeds/posts/default","/blog/rss.xml","/blog/feed.xml","/news/rss.xml","/index.xml","/feed/","/rss/","/feeds/","/wp-rss2.php","/wp-atom.php","/wp-rdf.php"],this.FEED_DISCOVERY_SELECTORS=['link[type="application/rss+xml"]','link[type="application/atom+xml"]','link[type="application/rdf+xml"]','link[rel="alternate"][type*="xml"]','link[rel="alternate"][type*="rss"]','link[rel="alternate"][type*="atom"]','meta[property="og:rss"]','meta[name="rss"]','meta[name="feed"]'],this.REQUEST_TIMEOUT=1e4,this.MAX_CONCURRENT_REQUESTS=5}async discoverFromWebsite(t){const s=Date.now(),r=this.normalizeUrl(t),a={originalUrl:t,discoveredFeeds:[],discoveryMethods:[],totalAttempts:0,successfulAttempts:0,discoveryTime:0,suggestions:[]};try{if(r.includes("youtube.com")||r.includes("youtu.be")){const n=await this.tryDiscoverYouTubeFeed(r);n&&(a.discoveredFeeds.push(n),a.successfulAttempts++)}a.discoveryMethods.push("common-paths");const o=await this.tryCommonFeedPaths(r);a.discoveredFeeds.push(...o),a.totalAttempts+=this.COMMON_FEED_PATHS.length,a.successfulAttempts+=o.length,a.discoveryMethods.push("html-parsing");try{const n=await this.fetchWebsiteContent(r),i=await this.scanHtmlForFeeds(n,r),c=new Set(a.discoveredFeeds.map(m=>m.url)),d=i.filter(m=>!c.has(m.url));a.discoveredFeeds.push(...d),a.totalAttempts+=1,a.successfulAttempts+=d.length>0?1:0}catch(n){console.warn("HTML parsing failed:",n),a.suggestions.push("Could not parse website HTML for feed discovery links")}if(a.discoveredFeeds.length===0){a.discoveryMethods.push("content-scan");try{const n=await this.scanContentForFeeds(r);a.discoveredFeeds.push(...n),a.totalAttempts+=1,a.successfulAttempts+=n.length>0?1:0}catch(n){console.warn("Content scanning failed:",n)}}a.discoveredFeeds=this.deduplicateAndSortFeeds(a.discoveredFeeds),a.suggestions=this.generateDiscoverySuggestions(a)}catch(o){const n=o instanceof Error?o.message:String(o);console.error("Feed discovery failed:",o),a.suggestions.push(`Discovery failed: ${n}`)}return a.discoveryTime=Date.now()-s,a}async scanHtmlForFeeds(t,s){const r=[],a=new Set;try{const n=new DOMParser().parseFromString(t,"text/html");if(n.querySelector("parsererror"))throw new Error("Invalid HTML content");for(const i of this.FEED_DISCOVERY_SELECTORS){const c=n.querySelectorAll(i);for(const d of c){const m=this.extractFeedUrl(d,s);if(m&&!a.has(m)){a.add(m);const b=i.includes("meta")?"meta-tag":"link-tag",L=this.calculateConfidence(b,d),U=d.getAttribute("title")||d.getAttribute("alt")||d.textContent?.trim(),k={url:m,title:U||void 0,type:this.determineFeedType(d,m),discoveryMethod:b,confidence:L};try{const C=await this.extractFeedMetadata(await this.fetchFeedContent(m));k.title=C.title||k.title,k.description=C.description,k.type=C.type,k.lastValidated=Date.now()}catch(C){console.warn(`Failed to extract metadata for ${m}:`,C)}r.push(k)}}}}catch(o){const n=o instanceof Error?o.message:String(o);throw console.error("HTML scanning failed:",o),new Error(`Failed to scan HTML for feeds: ${n}`)}return r}async tryCommonFeedPaths(t){const s=[],r=this.normalizeUrl(t),a=this.COMMON_FEED_PATHS.map(async n=>{const i=new URL(n,r).toString();try{const c=await this.fetchFeedContent(i),d=await this.extractFeedMetadata(c);return{url:i,title:d.title,description:d.description,type:d.type,discoveryMethod:"common-path",confidence:this.calculatePathConfidence(n),lastValidated:Date.now()}}catch{return null}}),o=await this.executeConcurrently(a,this.MAX_CONCURRENT_REQUESTS);return s.push(...o.filter(Boolean)),s}async extractFeedMetadata(t){try{const s=new DOMParser;let r=s.parseFromString(t,"text/xml");if(r.querySelector("parsererror")){const o=this.cleanupMalformedXML(t);if(r=s.parseFromString(o,"text/xml"),r.querySelector("parsererror"))throw new Error("Invalid XML content")}if(r.querySelector("rss")){const o=r.querySelector("channel > title")?.textContent?.trim(),n=r.querySelector("channel > description")?.textContent?.trim();return{title:o,description:n,type:"rss"}}else if(r.querySelector('feed[xmlns*="atom"]')||r.querySelector('feed[xmlns="http://www.w3.org/2005/Atom"]')){const o=r.querySelector("feed > title")?.textContent?.trim(),n=r.querySelector("feed > subtitle")?.textContent?.trim();return{title:o,description:n,type:"atom"}}else if(r.querySelector("rdf\\:RDF, RDF")||r.querySelector('[xmlns\\:rdf], [xmlns="http://www.w3.org/1999/02/22-rdf-syntax-ns#"]')){const o=r.querySelector("channel > title, item > title")?.textContent?.trim(),n=r.querySelector("channel > description, item > description")?.textContent?.trim();return{title:o,description:n,type:"rdf"}}else throw new Error("Unknown feed format")}catch(s){throw new Error(`Failed to extract feed metadata: ${s.message}`)}}async fetchWebsiteContent(t){try{const s=new AbortController,r=setTimeout(()=>s.abort(),this.REQUEST_TIMEOUT);try{const o=await fetch(t,{method:"GET",signal:s.signal,headers:{Accept:"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8","User-Agent":"Personal News Dashboard Feed Discovery/1.0"}});if(clearTimeout(r),o.ok)return await o.text()}catch{}return(await $e.tryProxiesWithFailover(t)).content}catch(s){throw new Error(`Failed to fetch website content: ${s.message}`)}}async fetchFeedContent(t){try{const s=new AbortController,r=setTimeout(()=>s.abort(),this.REQUEST_TIMEOUT);try{const o=await fetch(t,{method:"GET",signal:s.signal,headers:{Accept:"application/rss+xml, application/atom+xml, application/xml, text/xml","User-Agent":"Personal News Dashboard Feed Discovery/1.0"}});if(clearTimeout(r),o.ok)return await o.text()}catch{}return(await $e.tryProxiesWithFailover(t)).content}catch(s){throw new Error(`Failed to fetch feed content: ${s.message}`)}}async scanContentForFeeds(t){const s=[];try{const r=await this.fetchWebsiteContent(t),a=[/href=["']([^"']*(?:rss|feed|atom)[^"']*)["']/gi,/url\s*=\s*["']([^"']*(?:rss|feed|atom)[^"']*)["']/gi,/(https?:\/\/[^\s<>"']*(?:rss|feed|atom)[^\s<>"']*)/gi];for(const o of a){let n;for(;(n=o.exec(r))!==null;){const i=n[1];if(i&&this.isValidFeedUrl(i)){const c=new URL(i,t).toString();try{const d=await this.fetchFeedContent(c),m=await this.extractFeedMetadata(d),b={url:c,title:m.title,description:m.description,type:m.type,discoveryMethod:"content-scan",confidence:.6,lastValidated:Date.now()};s.push(b)}catch{continue}}}}}catch(r){console.error("Content scanning failed:",r)}return s}extractFeedUrl(t,s){const r=t.getAttribute("href")||t.getAttribute("content")||t.getAttribute("value");if(!r)return null;try{return new URL(r,s).toString()}catch{return null}}determineFeedType(t,s){const r=t.getAttribute("type")?.toLowerCase()||"";if(r.includes("atom"))return"atom";if(r.includes("rdf"))return"rdf";if(r.includes("rss"))return"rss";const a=s.toLowerCase();return a.includes("atom")?"atom":a.includes("rdf")?"rdf":"rss"}calculateConfidence(t,s){let r=.5;switch(t){case"link-tag":r=.9;break;case"meta-tag":r=.7;break;case"common-path":r=.8;break;case"content-scan":r=.6;break}const a=s.getAttribute("type")?.toLowerCase()||"";(a.includes("rss")||a.includes("atom")||a.includes("rdf"))&&(r+=.1),(s.getAttribute("rel")?.toLowerCase()||"").includes("alternate")&&(r+=.05);const n=s.getAttribute("title")||"";return(n.toLowerCase().includes("rss")||n.toLowerCase().includes("feed"))&&(r+=.05),Math.min(r,1)}calculatePathConfidence(t){return["/rss.xml","/feed.xml","/atom.xml","/rss","/feed"].includes(t)?.9:["/feeds/all.atom.xml","/blog/rss.xml","/news/rss.xml"].includes(t)?.8:.7}isValidFeedUrl(t){const s=t.toLowerCase();return["rss","feed","atom","xml"].some(a=>s.includes(a)&&(s.startsWith("http")||s.startsWith("/")))}normalizeUrl(t){let s=t.trim();return!s.startsWith("http://")&&!s.startsWith("https://")&&(s="https://"+s),s.endsWith("/")&&(s=s.slice(0,-1)),s}deduplicateAndSortFeeds(t){const s=new Map;for(const r of t){const a=s.get(r.url);(!a||r.confidence>a.confidence)&&s.set(r.url,r)}return Array.from(s.values()).sort((r,a)=>a.confidence-r.confidence)}generateDiscoverySuggestions(t){const s=[];return t.discoveredFeeds.length===0?(s.push("No RSS feeds found on this website"),s.push("Try checking if the website provides RSS feeds in their footer or sidebar"),s.push("Look for 'RSS', 'Feed', or 'Subscribe' links on the website")):t.discoveredFeeds.length===1?s.push("Found one RSS feed on this website"):(s.push(`Found ${t.discoveredFeeds.length} RSS feeds on this website`),s.push("Choose the feed that best matches your interests")),t.discoveryMethods.includes("html-parsing")&&t.discoveredFeeds.length>0&&s.push("Feeds discovered from website HTML meta tags and links"),t.discoveryMethods.includes("common-paths")&&t.discoveredFeeds.length>0&&s.push("Feeds found at common RSS feed locations"),s}cleanupMalformedXML(t){let s=t;s.charCodeAt(0)===65279&&(s=s.slice(1));const r=s.match(/<\?xml[^>]*\?>/g);if(r&&r.length>1&&(s=r[0]+s.replace(/<\?xml[^>]*\?>/g,"")),s=s.replace(/<!\[CDATA\[([^]*?)(?:\]\]>|$)/g,"<![CDATA[$1]]>"),s=s.replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/\u2014/g,"-").replace(/\u2026/g,"...").replace(/\u00A0/g," "),s=s.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,""),s.includes("<rss")&&!s.includes("<channel>")){const o=s.match(/(<rss[^>]*>)(.*?)(<\/rss>)/s);if(o){const[,n,i,c]=o;s=`${n}<channel>${i}</channel>${c}`}}return s=s.replace(/<rss(?!\s+version)([^>]*)>/g,'<rss version="2.0"$1>'),s=s.replace(/(<description[^>]*>)([^<]*?)(\s*<(?!\/description))/g,"$1$2</description>$3"),["title","link","pubDate","author"].forEach(o=>{const n=new RegExp(`(<${o}[^>]*>)([^<]*?)(\\s*<(?!\\/${o})(?!${o}))`,"g");s=s.replace(n,`$1$2</${o}>$3`)}),s=s.replace(/>\s+</g,"><").trim(),s}async executeConcurrently(t,s){const r=[];for(let a=0;a<t.length;a+=s){const o=t.slice(a,a+s),n=await Promise.allSettled(o);for(const i of n)i.status==="fulfilled"&&r.push(i.value)}return r}async tryDiscoverYouTubeFeed(t){try{let s=null,r="content-scan";const a=t.match(/\/channel\/(UC[\w-]+)/);a&&(s=`https://www.youtube.com/feeds/videos.xml?channel_id=${a[1]}`);const o=t.match(/\/user\/([\w-]+)/);o&&(s=`https://www.youtube.com/feeds/videos.xml?user=${o[1]}`);const n=t.match(/[?&]list=(PL[\w-]+)/);if(n&&(s=`https://www.youtube.com/feeds/videos.xml?playlist_id=${n[1]}`),!s&&(t.includes("/watch")||t.includes("youtu.be")))try{const i=await this.fetchWebsiteContent(t),c=i.match(/itemprop=["']channelId["']\s+content=["'](UC[\w-]+)["']/i)||i.match(/content=["'](UC[\w-]+)["']\s+itemprop=["']channelId["']/i);if(c&&c[1]&&(s=`https://www.youtube.com/feeds/videos.xml?channel_id=${c[1]}`),!s){const d=i.match(/"channelId"\s*:\s*"(UC[\w-]+)"/);d&&d[1]&&(s=`https://www.youtube.com/feeds/videos.xml?channel_id=${d[1]}`)}}catch(i){console.warn("Failed to fetch YouTube video page for discovery:",i)}if(!s&&(t.includes("/@")||t.includes("/c/")||t.includes("youtube.com")&&!t.includes("/watch")))try{const i=await this.fetchWebsiteContent(t),c=i.match(/<link[^>]+type=["']application\/rss\+xml["'][^>]+href=["']([^"']+)["']/i)||i.match(/<link[^>]+href=["']([^"']+)["'][^>]+type=["']application\/rss\+xml["']/i);if(c&&c[1]&&(s=c[1],r="link-tag"),!s){const d=i.match(/itemprop=["']channelId["']\s+content=["'](UC[\w-]+)["']/i)||i.match(/content=["'](UC[\w-]+)["']\s+itemprop=["']channelId["']/i);d&&d[1]&&(s=`https://www.youtube.com/feeds/videos.xml?channel_id=${d[1]}`)}if(!s)try{const d=i.match(/var ytInitialData\s*=\s*({.+?});/);if(d&&d[1]){const m=JSON.parse(d[1]),b=m?.metadata?.channelMetadataRenderer?.externalId||m?.header?.c4TabbedHeaderRenderer?.channelId||m?.contents?.twoColumnBrowseResultsRenderer?.tabs?.[0]?.tabRenderer?.endpoint?.browseEndpoint?.browseId;b&&b.startsWith("UC")&&(s=`https://www.youtube.com/feeds/videos.xml?channel_id=${b}`)}}catch(d){console.warn("Failed to parse ytInitialData",d)}}catch(i){console.warn("Failed to fetch YouTube channel page for discovery:",i)}if(s){const i=await this.fetchFeedContent(s),c=await this.extractFeedMetadata(i);return{url:s,title:c.title||"YouTube Feed",description:c.description,type:"atom",discoveryMethod:r,confidence:1,lastValidated:Date.now()}}}catch(s){console.warn("YouTube discovery failed:",s)}return null}}const ut=new dt;class ht{constructor(){this.INITIAL_TIMEOUT_MS=5e3,this.MAX_RETRIES=3,this.BASE_RETRY_DELAY=1e3}async validateFeedWithDiscovery(t,s){const r=Date.now(),a=this.getCachedResult(t);if(a&&!a.requiresUserSelection)return a;const o={url:t,isValid:!1,status:"checking",lastChecked:Date.now(),responseTime:0,validationAttempts:[],suggestions:[],totalRetries:0,totalValidationTime:0};s?.("Starting validation...",10);const n=await this.validateFeed(t);if(o.validationAttempts=n.validationAttempts,o.totalRetries=n.totalRetries,n.isValid){o.isValid=!0,o.status="valid",o.title=n.title,o.description=n.description,o.finalMethod="direct",o.suggestions=n.suggestions,o.responseTime=n.responseTime,o.statusCode=n.statusCode,s?.("Validation successful",100),o.totalValidationTime=Date.now()-r,o.lastChecked=Date.now();const c=`validation:${t}`;return z.set(c,o),o}s?.("Direct validation failed, attempting discovery...",30),o.status="discovery_in_progress";try{const c=await ut.discoverFromWebsite(t);if(o.discoveryResult=c,o.discoveredFeeds=c.discoveredFeeds,s?.("Discovery completed",70),c.discoveredFeeds.length===0)o.status="invalid",o.error="Feed discovery failed: No RSS feeds found on this website",o.suggestions=["Direct validation failed and feed discovery also failed","No RSS feeds were found on this website","Try checking if the website provides RSS feeds","Look for 'RSS', 'Feed', or 'Subscribe' links on the website",...c.suggestions],o.finalMethod="discovery",o.finalError=n.finalError||{type:"not_found",message:"Feed discovery failed: No RSS feeds found on this website",suggestions:["Direct validation failed and feed discovery also failed","No RSS feeds were found on this website","Try checking if the website provides RSS feeds","Look for 'RSS', 'Feed', or 'Subscribe' links on the website"],retryable:!1,context:{url:t,method:"discovery"}};else if(c.discoveredFeeds.length===1){const d=c.discoveredFeeds[0];s?.("Validating discovered feed...",90);const m=await this.validateFeed(d.url);m.isValid?(o.isValid=!0,o.status="valid",o.title=m.title||d.title,o.description=m.description||d.description,o.finalMethod="discovery",o.suggestions=[`Feed discovered and validated from ${t}`,`Using discovered feed: ${d.url}`,`Discovery method: ${d.discoveryMethod}`,...c.suggestions],o.url=d.url,o.finalMethod="discovery"):(o.status="invalid",o.error=`Discovered feed is invalid: ${m.error}`,o.suggestions=["A feed was discovered but it's not valid",`Discovered feed URL: ${d.url}`,...m.suggestions,...c.suggestions],o.finalMethod="discovery")}else o.status="discovery_required",o.requiresUserSelection=!0,o.error=`Found ${c.discoveredFeeds.length} RSS feeds - user selection required`,o.suggestions=[`Found ${c.discoveredFeeds.length} RSS feeds on this website`,"Please select which feed you want to add",...c.suggestions],o.finalMethod="discovery",o.finalError=n.finalError;s?.("Discovery process completed",100)}catch(c){const d=c instanceof Error?c.message:String(c);o.status="invalid",o.error=`Feed discovery failed: ${d}`,o.suggestions=["Direct validation failed and feed discovery also failed","The URL might not be a valid website or RSS feed","Please check the URL and try again",...n.suggestions],o.finalMethod="discovery",o.finalError=n.finalError||{type:"unknown_error",message:`Feed discovery failed: ${d}`,originalError:c instanceof Error?c:void 0,suggestions:["Direct validation failed and feed discovery also failed","The URL might not be a valid website or RSS feed","Please check the URL and try again"],retryable:!1,context:{url:t,method:"discovery"}},s?.("Discovery failed",100)}o.totalValidationTime=Date.now()-r,o.lastChecked=Date.now();const i=`validation:${t}`;return z.set(i,o),o}async validateFeed(t){const s=Date.now(),r=this.getCachedResult(t);if(r)return r.responseTime===0&&(r.responseTime=1),r;const a={url:t,isValid:!1,status:"checking",lastChecked:Date.now(),responseTime:0,validationAttempts:[],suggestions:[],totalRetries:0,totalValidationTime:0};let o;for(let i=1;i<=this.MAX_RETRIES;i++){const c=Date.now();try{const d=await this.attemptValidation(t,i),m={attemptNumber:i,timestamp:c,method:i===1?"direct":"retry",success:d.success,responseTime:Date.now()-c,statusCode:d.statusCode};if(d.success&&d.feedData){a.isValid=!0,a.status="valid",a.title=d.feedData.title,a.description=d.feedData.description,a.statusCode=d.statusCode,a.responseTime=Date.now()-c,a.suggestions=["Feed validated successfully"],m.success=!0,m.responseTime=a.responseTime,a.validationAttempts.push(m);break}else if(o=d.error,m.error=o,a.validationAttempts.push(m),i<this.MAX_RETRIES&&o.retryable){const b=this.calculateRetryDelay(i);m.retryDelay=b,a.totalRetries++,await this.delay(b)}else if(!o.retryable)break}catch(d){const m=this.classifyError(d,t,i);o=m;const b={attemptNumber:i,timestamp:c,method:i===1?"direct":"retry",success:!1,error:m,responseTime:Date.now()-c};if(a.validationAttempts.push(b),i<this.MAX_RETRIES&&m.retryable){const L=this.calculateRetryDelay(i);b.retryDelay=L,a.totalRetries++,await this.delay(L)}else if(!m.retryable)break}}if(!a.isValid&&o&&(o.type==="cors_error"||o.type==="network_error"||o.type==="timeout_error"))try{const i=await this.attemptProxyValidation(t),c={attemptNumber:a.validationAttempts.length+1,timestamp:Date.now(),method:"proxy",success:i.success,responseTime:i.responseTime,proxyUsed:i.proxyUsed};i.success&&i.feedData?(a.isValid=!0,a.status="valid",a.title=i.feedData.title,a.description=i.feedData.description,a.responseTime=i.responseTime,c.success=!0,a.validationAttempts.push(c),a.suggestions=["Feed validated successfully using proxy service",`Used ${i.proxyUsed} proxy to bypass CORS restrictions`]):(c.error=i.error,a.validationAttempts.push(c),i.error&&(o=i.error))}catch(i){const c=this.classifyError(i,t,a.validationAttempts.length+1),d={attemptNumber:a.validationAttempts.length+1,timestamp:Date.now(),method:"proxy",success:!1,error:c,responseTime:0};a.validationAttempts.push(d)}a.isValid||(o?(a.finalError=o,a.status=this.mapErrorTypeToStatus(o.type),a.error=o.message,a.suggestions=o.suggestions):(a.status="invalid",a.error="Validation failed for unknown reason",a.suggestions=["Please try again or check the feed URL"])),a.totalValidationTime=Date.now()-s,a.lastChecked=Date.now(),a.responseTime===0&&(a.responseTime=a.totalValidationTime);const n=`validation:${t}`;return z.set(n,a),a}async attemptProxyValidation(t){const s=Date.now();try{const r=await $e.tryProxiesWithFailover(t),a=Date.now()-s,o=this.validateFeedContent(r.content);return o.isValid?{success:!0,feedData:{title:o.title||"",description:o.description||""},responseTime:a,proxyUsed:r.proxyUsed}:{success:!1,responseTime:a,proxyUsed:r.proxyUsed,error:{type:"parse_error",message:o.error||"Invalid feed format received from proxy",suggestions:["The proxy returned content, but it's not a valid RSS/Atom feed","Check if the URL points to a valid RSS or Atom feed","The feed content might be corrupted during proxy transmission"],retryable:!1,context:{url:t,method:"proxy"}}}}catch(r){return{success:!1,responseTime:Date.now()-s,error:{type:"network_error",message:`Proxy validation failed: ${r.message}`,originalError:r,suggestions:["All proxy services failed to access the feed","The feed server might be blocking proxy requests","Try again later or check if the feed URL is correct"],retryable:!0,context:{url:t,method:"proxy"}}}}}async attemptValidation(t,s){const r=this.INITIAL_TIMEOUT_MS+(s-1)*1e3;try{const a=new AbortController,o=setTimeout(()=>a.abort(),r),n=await fetch(t,{method:"GET",signal:a.signal,headers:{Accept:"application/rss+xml, application/atom+xml, application/xml, text/xml","User-Agent":"Personal News Dashboard Feed Validator/2.0"}});if(clearTimeout(o),n.status===200){const i=await n.text(),c=this.validateFeedContent(i);return c.isValid?{success:!0,feedData:{title:c.title||"",description:c.description||""},statusCode:n.status}:{success:!1,statusCode:n.status,error:{type:"parse_error",message:c.error||"Invalid feed format",suggestions:["Check if the URL points to a valid RSS or Atom feed","Verify the feed content is properly formatted XML"],retryable:!1,context:{url:t,attempt:s,statusCode:n.status}}}}else{const i=this.getErrorTypeFromStatus(n.status);return{success:!1,statusCode:n.status,error:{type:i,message:`HTTP ${n.status}: ${n.statusText}`,suggestions:this.getSuggestionsForStatusCode(n.status),retryable:this.isRetryableStatusCode(n.status),context:{url:t,attempt:s,statusCode:n.status}}}}}catch(a){return a.name==="AbortError"?{success:!1,error:{type:"timeout_error",message:`Request timed out after ${r}ms`,suggestions:["The server might be slow or overloaded","Try again later when the server might be more responsive","Check if the URL is correct and accessible"],retryable:!0,context:{url:t,attempt:s}}}:{success:!1,error:this.classifyError(a,t,s)}}}calculateRetryDelay(t){const s=this.BASE_RETRY_DELAY*Math.pow(2,t-1),r=Math.random()*500;return Math.min(s+r,1e4)}delay(t){return new Promise(s=>setTimeout(s,t))}classifyError(t,s,r){const a=t.message.toLowerCase();return a.includes("cors")||a.includes("cross-origin")||a.includes("cross origin")?{type:"cors_error",message:"CORS policy prevents direct access to this feed",originalError:t,suggestions:["The feed server doesn't allow direct browser access","This is a common issue with RSS feeds","The system will try alternative methods to access the feed"],retryable:!1,context:{url:s,attempt:r}}:a.includes("network")||a.includes("fetch")?{type:"network_error",message:"Network error occurred while fetching the feed",originalError:t,suggestions:["Check your internet connection","The server might be temporarily unavailable","Try again in a few moments"],retryable:!0,context:{url:s,attempt:r}}:a.includes("timeout")||a.includes("aborted")?{type:"timeout_error",message:"Request timed out",originalError:t,suggestions:["The server is taking too long to respond","Try again later when the server might be more responsive"],retryable:!0,context:{url:s,attempt:r}}:{type:"unknown_error",message:t.message||"An unknown error occurred",originalError:t,suggestions:["An unexpected error occurred","Please try again or check the feed URL"],retryable:!0,context:{url:s,attempt:r}}}mapErrorTypeToStatus(t){switch(t){case"network_error":return"network_error";case"cors_error":return"cors_error";case"timeout_error":return"timeout";case"parse_error":return"parse_error";case"not_found":return"not_found";case"server_error":return"server_error";case"invalid_format":return"parse_error";default:return"invalid"}}getErrorTypeFromStatus(t){return t===404?"not_found":t>=500?"server_error":t===403||t===401?"cors_error":"network_error"}getSuggestionsForStatusCode(t){switch(t){case 404:return["The feed URL was not found on the server","Check if the URL is correct","The feed might have been moved or removed"];case 403:return["Access to this feed is forbidden","The server might require authentication","Try accessing the website directly to check if it's available"];case 401:return["Authentication is required to access this feed","The feed might be private or require login"];case 500:case 502:case 503:case 504:return["The server is experiencing issues","Try again later when the server might be working properly","This is a temporary server problem"];default:return["An HTTP error occurred","Check if the URL is correct and accessible"]}}isRetryableStatusCode(t){return t>=500||t===408||t===429}async validateDiscoveredFeed(t,s){const r=await this.validateFeed(t.url),a={...r,finalMethod:"discovery",discoveredFeeds:[t],suggestions:[`Feed selected from discovery results for ${s}`,`Discovery method: ${t.discoveryMethod}`,`Confidence: ${Math.round(t.confidence*100)}%`,...r.suggestions]},o=`validation:${s}`;return z.set(o,a),a}async validateFeeds(t){const s=t.map(r=>this.validateFeed(r));return Promise.all(s)}getValidationHistory(t){return this.getCachedResult(t)?.validationAttempts||[]}getValidationStats(t){const s=this.getCachedResult(t);if(!s)return null;const r=s.validationAttempts,a=r.filter(n=>n.success).length,o=r.length>0?r.reduce((n,i)=>n+(i.responseTime||0),0)/r.length:0;return{totalAttempts:r.length,successfulAttempts:a,failedAttempts:r.length-a,averageResponseTime:Math.round(o),totalRetries:s.totalRetries,lastValidation:s.lastChecked}}validateFeedContent(t){try{let s=this.attemptFeedParsing(t);if(s.isValid)return s;const r=this.cleanupFeedContent(t);return r!==t&&(s=this.attemptFeedParsing(r),s.isValid)?{...s,cleanupApplied:!0}:s}catch(s){return{isValid:!1,error:`Error processing content: ${s instanceof Error?s.message:String(s)}`}}}attemptFeedParsing(t){try{const r=new DOMParser().parseFromString(t,"text/xml");if(r.querySelector("parsererror"))return{isValid:!1,error:"Invalid XML content"};const o=this.detectFeedType(r);if(!o)return{isValid:!1,error:"Not a valid RSS, Atom, or RDF feed"};const n=this.extractFeedMetadata(r,o);return{isValid:!0,title:n.title,description:n.description,feedType:o}}catch(s){return{isValid:!1,error:`Error parsing feed: ${s instanceof Error?s.message:String(s)}`}}}detectFeedType(t){const s=t.documentElement;if(!s)return null;const r=s.tagName.toLowerCase(),a=s.namespaceURI;return r==="rss"?"rss":r==="feed"&&(a==="http://www.w3.org/2005/Atom"||s.getAttribute("xmlns")==="http://www.w3.org/2005/Atom"||s.getAttribute("xmlns")?.includes("atom"))?"atom":r==="rdf:rdf"||r==="rdf"||a==="http://www.w3.org/1999/02/22-rdf-syntax-ns#"||s.getAttribute("xmlns:rdf")==="http://www.w3.org/1999/02/22-rdf-syntax-ns#"?"rdf":t.querySelector("channel")?"rss":t.querySelector("channel[*|about]")||t.querySelector("[*|about]")||s.getAttribute("xmlns")?.includes("rss")?"rdf":null}extractFeedMetadata(t,s){let r="",a="";try{switch(s){case"rss":r=this.getTextContent(t,["channel > title","rss > channel > title","title"]),a=this.getTextContent(t,["channel > description","rss > channel > description","description"]);break;case"atom":r=this.getTextContent(t,["feed > title","*|feed > *|title","title"]),a=this.getTextContent(t,["feed > subtitle","*|feed > *|subtitle","subtitle","feed > summary","*|feed > *|summary","summary"]);break;case"rdf":r=this.getTextContent(t,["channel > title","*|channel > *|title","[*|about] > title","[*|about] > *|title","title"]),a=this.getTextContent(t,["channel > description","*|channel > *|description","[*|about] > description","[*|about] > *|description","description"]);break}}catch{r=t.querySelector("title")?.textContent||"",a=t.querySelector("description, subtitle, summary")?.textContent||""}return{title:this.cleanText(r),description:this.cleanText(a)}}getTextContent(t,s){for(const r of s)try{const a=t.querySelector(r);if(a?.textContent?.trim())return a.textContent.trim()}catch{continue}return""}cleanText(t){return t?t.trim().replace(/\s+/g," ").replace(/[\r\n\t]/g," ").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&#39;/g,"'").substring(0,500):""}cleanupFeedContent(t){let s=t;try{s.charCodeAt(0)===65279&&(s=s.slice(1)),s=this.fixXMLDeclaration(s),s=this.fixNamespaceIssues(s),s=this.fixEncodingIssues(s),s=this.fixCDATASections(s),s=this.fixUnClosedTags(s),s=this.removeInvalidXMLCharacters(s),s=this.fixRSSStructureIssues(s)}catch{return t}return s}fixXMLDeclaration(t){const s=/<\?xml[^>]*\?>/gi,r=t.match(s);return r&&r.length>1&&(t=t.replace(s,""),t=r[0]+`
`+t),t.includes("<?xml")&&!t.includes("encoding=")&&(t=t.replace(/<\?xml([^>]*)\?>/i,'<?xml$1 encoding="UTF-8"?>')),t}fixNamespaceIssues(t){return t.includes("<rdf:RDF")&&!t.includes("xmlns:rss=")&&(t=t.replace("<rdf:RDF",'<rdf:RDF xmlns:rss="http://purl.org/rss/1.0/"')),t.includes("<rdf:")&&!t.includes("xmlns:rdf=")&&(t=t.replace(/<(rdf:RDF|RDF)/,'<$1 xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"')),t.includes("<feed")&&!t.includes("xmlns=")&&(t.includes("<entry")||t.includes("<title"))&&(t=t.replace("<feed",'<feed xmlns="http://www.w3.org/2005/Atom"')),t}fixEncodingIssues(t){const s=[[/[\u2018\u2019]/g,"'"],[/[\u201C\u201D]/g,'"'],[/[\u2013\u2014]/g,"-"],[/\u2026/g,"..."],[/\u00A0/g," "]];for(const[r,a]of s)t=t.replace(r,a);return t}fixCDATASections(t){return t=t.replace(/<!\[CDATA\[([^]*?)(?:\]\]>|$)/g,(s,r)=>s.endsWith("]]>")?s:`<![CDATA[${r}]]>`),t=t.replace(/<!\[CDATA\[([^]*?)<!\[CDATA\[([^]*?)\]\]>([^]*?)\]\]>/g,"<![CDATA[$1$2$3]]>"),t}fixUnClosedTags(t){const s=["br","hr","img","input","meta","link"];for(const r of s){const a=new RegExp(`<${r}([^>]*[^/])>`,"gi");t=t.replace(a,`<${r}$1/>`)}return t}removeInvalidXMLCharacters(t){return t.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"")}fixRSSStructureIssues(t){return t.includes("<rss")&&!t.includes("<channel")&&(t=t.replace(/(<rss[^>]*>)([\s\S]*?)(<\/rss>)/,"$1<channel>$2</channel>$3")),t.includes("<rss")&&!t.includes("version=")&&(t=t.replace("<rss",'<rss version="2.0"')),t}getCachedResult(t){const s=`validation:${t}`;return z.get(s)?.data||null}clearCache(){z.invalidatePattern("validation:*")}getCacheStats(){return z.getStats()}refreshCachedResult(t){const s=`validation:${t}`;return z.refresh(s)}getValidationSummary(t){const s=t.map(r=>this.getCachedResult(r)).filter(Boolean);return{total:t.length,valid:s.filter(r=>r.status==="valid").length,invalid:s.filter(r=>r.status!=="valid"&&r.status!=="checking").length,checking:s.filter(r=>r.status==="checking").length,lastValidation:Math.max(...s.map(r=>r.lastChecked),0)}}getFeedStatus(t){return this.getCachedResult(t)}revalidateFeed(t){const s=`validation:${t}`;z.invalidate(s)}}const ke=new ht;class mt{constructor(){this.fingerprintCache=new Map,this.CACHE_TTL=1800*1e3}normalizeUrl(t){try{const s=new URL(t);s.hostname.startsWith("www.")&&(s.hostname=s.hostname.substring(4)),["utm_source","utm_medium","utm_campaign","utm_term","utm_content","fbclid","gclid","ref","source","campaign"].forEach(o=>{s.searchParams.delete(o)}),s.searchParams.sort();let a=s.href.toLowerCase();return a.endsWith("/")&&a!=="https://"&&a!=="http://"&&(a=a.slice(0,-1)),a}catch{return t.toLowerCase().trim().replace(/\/$/,"")}}async generateContentFingerprint(t){try{const s=this.fingerprintCache.get(t);if(s&&Date.now()-s.lastUpdated<this.CACHE_TTL)return s;const r=await ke.validateFeed(t);if(!r.isValid||!r.title)return null;const a=this.normalizeUrl(t),o={title:r.title?.toLowerCase().trim(),description:r.description?.toLowerCase().trim()||"",link:a},n=await this.hashContent(JSON.stringify(o)),i={url:t,normalizedUrl:a,title:r.title,description:r.description,link:a,contentHash:n,lastUpdated:Date.now()};return this.fingerprintCache.set(t,i),i}catch(s){return console.error("Failed to generate content fingerprint:",s),null}}async hashContent(t){if(typeof crypto<"u"&&crypto.subtle)try{const a=new TextEncoder().encode(t),o=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(o)).map(i=>i.toString(16).padStart(2,"0")).join("")}catch{}let s=0;for(let r=0;r<t.length;r++){const a=t.charCodeAt(r);s=(s<<5)-s+a,s=s&s}return Math.abs(s).toString(16)}async detectDuplicate(t,s){const r=this.normalizeUrl(t);for(const o of s)if(this.normalizeUrl(o.url)===r)return{isDuplicate:!0,duplicateOf:o,confidence:1,reason:"Identical normalized URLs",normalizedUrl:r};const a=await this.generateContentFingerprint(t);if(!a)return{isDuplicate:!1,confidence:0,reason:"Unable to generate content fingerprint"};for(const o of s){const n=await this.generateContentFingerprint(o.url);if(n){if(a.contentHash===n.contentHash)return{isDuplicate:!0,duplicateOf:o,confidence:.95,reason:"Identical content fingerprint",contentFingerprint:a.contentHash};if(a.title&&n.title){const i=this.calculateStringSimilarity(a.title.toLowerCase(),n.title.toLowerCase());if(i>.9)return{isDuplicate:!0,duplicateOf:o,confidence:i,reason:`Very similar titles (${Math.round(i*100)}% match)`}}}}return{isDuplicate:!1,confidence:0,reason:"No duplicates detected"}}async findDuplicateGroups(t){const s=[],r=new Set;for(const a of t){if(r.has(a.url))continue;const o=[a],n=await this.generateContentFingerprint(a.url);if(!n){r.add(a.url);continue}for(const i of t){if(i.url===a.url||r.has(i.url))continue;const c=await this.detectDuplicate(i.url,[a]);c.isDuplicate&&c.confidence>.8&&(o.push(i),r.add(i.url))}r.add(a.url),o.length>1&&s.push({feeds:o,fingerprint:n,confidence:Math.max(...o.map(()=>.9))})}return s}async removeDuplicates(t,s={action:"keep_first"}){const r=await this.findDuplicateGroups(t),a=[],o=[],n=new Set;for(const i of t){if(n.has(i.url))continue;const c=r.find(d=>d.feeds.some(m=>m.url===i.url));if(c){let d;switch(s.action){case"keep_first":d=c.feeds[0];break;case"keep_last":d=c.feeds[c.feeds.length-1];break;case"user_select":d=s.preferredFeed||c.feeds[0];break;case"merge":d=this.mergeFeeds(c.feeds,s);break;default:d=c.feeds[0]}a.push(d);for(const m of c.feeds)n.add(m.url),m.url!==d.url&&o.push({originalFeed:m,duplicateOf:d,reason:`Duplicate detected with ${Math.round(c.confidence*100)}% confidence`})}else a.push(i),n.add(i.url)}return{uniqueFeeds:a,removedDuplicates:o}}mergeFeeds(t,s){const r=t[0];let a=r.customTitle;if(s.mergeCustomTitles){const n=t.map(i=>i.customTitle).filter(Boolean).filter((i,c,d)=>d.indexOf(i)===c);n.length>1?a=n.join(" / "):n.length===1&&(a=n[0])}let o=r.categoryId;if(s.mergeCategories){const n=t.map(i=>i.categoryId).filter(Boolean).filter((i,c,d)=>d.indexOf(i)===c);n.length>0&&(o=n[0])}return{url:r.url,customTitle:a,categoryId:o}}calculateStringSimilarity(t,s){if(t===s)return 1;if(t.length===0||s.length===0)return 0;const r=[];for(let n=0;n<=s.length;n++)r[n]=[n];for(let n=0;n<=t.length;n++)r[0][n]=n;for(let n=1;n<=s.length;n++)for(let i=1;i<=t.length;i++)s.charAt(n-1)===t.charAt(i-1)?r[n][i]=r[n-1][i-1]:r[n][i]=Math.min(r[n-1][i-1]+1,r[n][i-1]+1,r[n-1][i]+1);const a=Math.max(t.length,s.length),o=r[s.length][t.length];return(a-o)/a}clearCache(){this.fingerprintCache.clear()}getCacheStats(){const t=Array.from(this.fingerprintCache.values());return{size:t.length,oldestEntry:t.length>0?Math.min(...t.map(s=>s.lastUpdated)):0,newestEntry:t.length>0?Math.max(...t.map(s=>s.lastUpdated)):0}}}const Xe=new mt,Oe=class Oe{static async generateOPML(t,s=[],r={}){const a={...this.DEFAULT_OPTIONS,...r},o=new Date,i=(await Xe.removeDuplicates(t,{action:"keep_first"})).uniqueFeeds,c=this.createOPMLDocument(a,o),d=this.createOPMLBody(i,s,a);return this.formatXML(c,d)}static createOPMLDocument(t,s){const r=s.toUTCString();return`<?xml version="1.0" encoding="UTF-8"?>
<opml version="2.0">
  <head>
    <title>${this.escapeXML(t.title)}</title>
    <dateCreated>${r}</dateCreated>
    <dateModified>${r}</dateModified>
    <ownerName>${this.escapeXML(t.ownerName)}</ownerName>
    ${t.ownerEmail?`<ownerEmail>${this.escapeXML(t.ownerEmail)}</ownerEmail>`:""}
    <docs>http://dev.opml.org/spec2.html</docs>
    <expansionState></expansionState>
    <vertScrollState>1</vertScrollState>
    <windowTop>146</windowTop>
    <windowLeft>107</windowLeft>
    <windowBottom>468</windowBottom>
    <windowRight>560</windowRight>
  </head>`}static createOPMLBody(t,s,r){let a=`  <body>
`;if(r.includeCategories&&s.length>0){const o=this.groupFeedsByCategory(t,s);for(const i of s.sort((c,d)=>c.order-d.order)){const c=o.get(i.id)||[];c.length>0&&(a+=this.createCategoryOutline(i,c,r))}const n=t.filter(i=>!i.categoryId);n.length>0&&(a+=this.createUncategorizedOutline(n,r))}else for(const o of t)a+=this.createFeedOutline(o,r);return a+=`  </body>
`,a}static groupFeedsByCategory(t,s){const r=new Map;return s.forEach(a=>{r.set(a.id,[])}),t.forEach(a=>{if(a.categoryId){const o=r.get(a.categoryId)||[];o.push(a),r.set(a.categoryId,o)}}),r}static createCategoryOutline(t,s,r){let a=`    <outline text="${this.escapeXML(t.name)}"`;t.description&&(a+=` description="${this.escapeXML(t.description)}"`),a+=`>
`;for(const o of s)a+=this.createFeedOutline(o,r,6);return a+=`    </outline>
`,a}static createUncategorizedOutline(t,s){let r=`    <outline text="Uncategorized">
`;for(const a of t)r+=this.createFeedOutline(a,s,6);return r+=`    </outline>
`,r}static createFeedOutline(t,s,r=4){const a=" ".repeat(r),o=t.customTitle||this.extractDomainFromUrl(t.url);let n=`${a}<outline`;n+=' type="rss"',n+=` text="${this.escapeXML(o)}"`,n+=` title="${this.escapeXML(o)}"`,n+=` xmlUrl="${this.escapeXML(t.url)}"`;const i=this.deriveHtmlUrl(t.url);return i&&(n+=` htmlUrl="${this.escapeXML(i)}"`),t.categoryId&&s.includeFeedMetadata&&(n+=` category="${this.escapeXML(t.categoryId)}"`),n+=` />
`,n}static extractDomainFromUrl(t){try{return new URL(t).hostname.replace(/^www\./,"")}catch{const s=t.match(/^https?:\/\/(?:www\.)?([^/]+)/);return s?s[1]:t}}static deriveHtmlUrl(t){try{const s=new URL(t);if(s.search&&new URLSearchParams(s.search).has("feed"))return`${s.protocol}//${s.host}${s.pathname==="/"?"":s.pathname}`;const r=[{pattern:/\/rss\.xml$/,replacement:""},{pattern:/\/feed\.xml$/,replacement:""},{pattern:/\/atom\.xml$/,replacement:""},{pattern:/\/rss\/?$/,replacement:""},{pattern:/\/feed\/?$/,replacement:""},{pattern:/\/feeds\/.*$/,replacement:""},{pattern:/\/blog\/rss\.xml$/,replacement:"/blog"},{pattern:/\/blog\/feed\.xml$/,replacement:"/blog"},{pattern:/\/news\/rss\.xml$/,replacement:"/news"},{pattern:/\/news\/feeds\/.*$/,replacement:"/news"}];let a=s.pathname,o=!1;for(const{pattern:i,replacement:c}of r)if(i.test(a)){a=a.replace(i,c),o=!0;break}o||(a="");const n=a===""||a==="/"?"":a;return`${s.protocol}//${s.host}${n}`}catch{return null}}static formatXML(t,s){return`${t}
${s}</opml>`}static escapeXML(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}static validateOPML(t){const s={isValid:!0,errors:[],warnings:[]};try{t.trim().startsWith("<?xml")||s.errors.push("OPML must start with XML declaration"),t.includes("<opml")||s.errors.push("Missing OPML root element"),t.includes("<head>")||s.errors.push("Missing OPML head section"),t.includes("<body>")||s.errors.push("Missing OPML body section"),t.includes("<title>")||s.warnings.push("Missing title in head section"),t.includes("<dateCreated>")||s.warnings.push("Missing dateCreated in head section");const r=t.match(/<outline[^>]*>/g);if((!r||r.length===0)&&s.warnings.push("No outline elements found"),typeof DOMParser<"u"){const n=new DOMParser().parseFromString(t,"text/xml").querySelector("parsererror");n&&s.errors.push(`XML parsing error: ${n.textContent}`)}s.isValid=s.errors.length===0}catch(r){s.errors.push(`Validation error: ${r instanceof Error?r.message:"Unknown error"}`),s.isValid=!1}return s}static downloadOPML(t,s="feeds.opml"){try{s.toLowerCase().endsWith(".opml")||(s+=".opml");const r=new Blob([t],{type:"application/xml;charset=utf-8"}),a=URL.createObjectURL(r),o=document.createElement("a");o.href=a,o.download=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(a)}catch(r){throw console.error("Failed to download OPML file:",r),new Error("Failed to download OPML file")}}static generateFilename(t="feeds"){const r=new Date().toISOString().slice(0,19).replace(/[T:]/g,"-");return`${t}-${r}.opml`}static normalizeUrl(t){try{const s=t.trim(),r=new URL(s);let a=r.hostname.toLowerCase();a.startsWith("www.")&&(a=a.substring(4));let o=r.pathname.toLowerCase();o.endsWith("/")&&o.length>1&&(o=o.slice(0,-1));const n=new URLSearchParams(r.search);["utm_source","utm_medium","utm_campaign","ref","source"].forEach(b=>{n.delete(b)});const d=`${r.protocol.toLowerCase()}//${a}${o}`,m=n.toString();return m?`${d}?${m}`:d}catch{return t.toLowerCase().trim()}}static detectDuplicates(t){const s=new Map,r=[],a=[];for(const o of t){const n=this.normalizeUrl(o.url),i=s.get(n);i?r.push({originalFeed:o,duplicateOf:i,normalizedUrl:n}):(s.set(n,o),a.push(o))}return{duplicates:r,uniqueFeeds:a,duplicateCount:r.length}}};Oe.DEFAULT_OPTIONS={title:"Personal News Dashboard Feeds",description:"RSS feeds exported from Personal News Dashboard",ownerName:"Personal News Dashboard User",ownerEmail:"",includeCategories:!0,includeFeedMetadata:!0};let Ne=Oe;const xt=({feeds:p,setFeeds:t})=>{const s=We(),{t:r}=ae(),{refreshAppearance:a}=Be(),{categories:o,createCategory:n,updateCategory:i,deleteCategory:c,reorderCategories:d,getCategorizedFeeds:m,moveFeedToCategory:b,exportCategories:L,importCategories:U,resetToDefaults:k}=He(),{alertSuccess:C,alertError:M,confirmDanger:F}=Ie(),[R,A]=g.useState({draggedItem:null,dragOverCategory:null}),[w,v]=g.useState(null),[f,S]=g.useState({name:"",color:"#3B82F6",description:"",layoutMode:void 0,headerPosition:void 0}),[oe,W]=g.useState({}),[D,_]=g.useState({name:"",color:"#3B82F6",description:"",layoutMode:void 0,headerPosition:void 0}),[Se,E]=g.useState(!1),[V,q]=g.useState(!1),[Le,Me]=g.useState({}),Te=g.useRef(null),Q=g.useRef(null),[ne,X]=g.useState(null),T=m(p),Z=V?o:o.slice(0,2),me=o.length-Z.length,G=[{value:"",label:"Default (Use Global Setting)"},{value:"bento",label:"Bento Grid"},{value:"brutalist",label:"Brutalist"},{value:"compact",label:"Compact (Data)"},{value:"cyberpunk",label:"Cyberpunk"},{value:"focus",label:"Focus (Single)"},{value:"gallery",label:"Gallery (Image)"},{value:"immersive",label:"Immersive / Netflix"},{value:"list",label:"List / Portal"},{value:"grid",label:"Magazine Grid"},{value:"masonry",label:"Masonry Cards"},{value:"minimal",label:"Minimal Text"},{value:"modern",label:"Modern Portal"},{value:"newspaper",label:"Newspaper (Classic)"},{value:"pocketfeeds",label:"PocketFeeds"},{value:"split",label:"Split (ZigZag)"},{value:"terminal",label:"Terminal"},{value:"timeline",label:"Timeline"}],Y=g.useCallback((l,h,u,x)=>{A(y=>({...y,draggedItem:{type:h,id:u,data:x}})),l.dataTransfer.effectAllowed="move"},[]),K=g.useCallback((l,h)=>{l.preventDefault(),l.dataTransfer.dropEffect="move",A(u=>({...u,dragOverCategory:h}))},[]),ee=async()=>{const l=await Ne.generateOPML(p,o),h=new Blob([l],{type:"text/xml"}),u=URL.createObjectURL(h),x=document.createElement("a");x.href=u,x.download=`personal_news_with_categories_${new Date().toISOString().split("T")[0]}.opml`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(u)},ie=g.useCallback(()=>{A(l=>({...l,dragOverCategory:null}))},[]),$=g.useCallback((l,h)=>{if(l.preventDefault(),!R.draggedItem)return;const{type:u,id:x,data:y}=R.draggedItem;if(u==="feed")b(y.url,h,p,t);else if(u==="category"){const N=o.find(j=>j.id===h),O=o.find(j=>j.id===x);if(N&&O){const j=[...o].sort((he,Ge)=>he.order-Ge.order).map(he=>he.id),P=j.indexOf(x),ye=j.indexOf(h);j.splice(P,1),j.splice(ye,0,x),d(j)}}A({draggedItem:null,dragOverCategory:null})},[R.draggedItem,o,p,t,b,d]),J=[{value:"",label:"Padro (Global)"},{value:"static",label:"Esttico"},{value:"sticky",label:"Fixo (Sticky)"},{value:"floating",label:"Flutuante"},{value:"hidden",label:"Oculto"}],Fe=g.useCallback(l=>{l.preventDefault(),D.name.trim()&&(n(D.name.trim(),D.color,D.description.trim()||void 0,D.layoutMode,D.headerPosition),_({name:"",color:"#3B82F6",description:"",layoutMode:void 0,headerPosition:void 0}),E(!1))},[D,n]),xe=g.useCallback(l=>{v(l.id),S({name:l.name,color:l.color,description:l.description||"",layoutMode:l.layoutMode,headerPosition:l.headerPosition})},[]),le=g.useCallback(l=>{l.preventDefault(),w&&f.name.trim()&&(i(w,{name:f.name.trim(),color:f.color,description:f.description.trim()||void 0,layoutMode:f.layoutMode,headerPosition:f.headerPosition}),v(null),S({name:"",color:"#3B82F6",description:"",layoutMode:void 0,headerPosition:void 0}))},[w,f,i]),De=g.useCallback(()=>{v(null),S({name:"",color:"#3B82F6",description:"",layoutMode:void 0,headerPosition:void 0})},[]),pe=g.useCallback(async l=>{const h=o.find(N=>N.id===l),u=T[l]||[],x=u.length;let y=`Tem certeza que deseja excluir a categoria "${h?.name}"?`;if(x>0&&(y+=`

Esta ao ir mover ${x} feed${x>1?"s":""} para "No categorizados":`,u.slice(0,3).forEach(N=>{y+=`
 ${N.customTitle||N.url}`}),x>3&&(y+=`
 ... e mais ${x-3} feed${x-3>1?"s":""}`)),await F(y)){u.forEach(O=>{b(O.url,"uncategorized",p,t)}),c(l);const N=x>0?`Categoria "${h?.name}" excluda com sucesso. ${x} feed${x>1?"s foram movidos":" foi movido"} para "No categorizados".`:`Categoria "${h?.name}" excluda com sucesso.`;setTimeout(async()=>{await C(N)},100)}},[o,T,p,t,b,c,F,C]);g.useCallback(()=>{const l=L(),h=new Blob([l],{type:"application/json"}),u=URL.createObjectURL(h),x=document.createElement("a");x.href=u,x.download=`feed-categories-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(x),x.click(),document.body.removeChild(x),URL.revokeObjectURL(u)},[L]);const ge=g.useCallback(async l=>{const h=l.target.files?.[0];if(h)try{const u=await h.text();U(u)?await C("Categories imported successfully!"):await M("Failed to import categories. Please check the file format.")}catch(u){await M("Failed to read the file."),s.error("Failed to read categories import file",u,{additionalData:{fileName:h.name,fileSize:h.size,fileType:h.type}})}l.target&&(l.target.value="")},[U,C,M,s]),Re=g.useCallback(async l=>{const h=l.target.files?.[0];if(h){try{const u=await h.text(),x=qe(u);if(x.length===0){await M("No feeds found in this OPML file.");return}const y=[],N=new Set(p.map(j=>j.url.toLowerCase())),O=ne||void 0;if(x.forEach(j=>{const P=j.url.toLowerCase().trim();N.has(P)||(N.add(P),y.push({url:j.url,customTitle:j.title,categoryId:O}))}),y.length>0){t(P=>[...P,...y]);const j=O?o.find(P=>P.id===O)?.name||"selected category":"Uncategorized";await C(`${y.length} feeds imported successfully to ${j}!`)}else await C("All feeds from this file are already in your collection.");s.info("OPML feeds imported",{additionalData:{totalInFile:x.length,newFeedsAdded:y.length,targetCategory:O}})}catch(u){await M("Failed to parse OPML file. Please check the file format."),s.error("Failed to import OPML feeds",u,{additionalData:{fileName:h.name,fileSize:h.size}})}l.target&&(l.target.value=""),X(null)}},[p,t,ne,o,C,M,s]),Ee=g.useCallback(async()=>{if(await F("Are you sure you want to reset to default categories? This will remove all custom categories and reset feed assignments.")){k(),a();const l=p.map(h=>({...h,categoryId:void 0}));t(l)}},[k,p,t,F,a]),fe=g.useCallback(async(l,h)=>{await F(`Tem certeza que deseja remover o feed "${h||l}"?`)&&(t(p.filter(u=>u.url!==l)),await C("Feed removido com sucesso."))},[p,t,F,C]),[I,ce]=g.useState(null),[te,se]=g.useState(""),ve=l=>{ce(l.url),se(l.customTitle||"")},be=()=>{I&&(t(p.map(l=>l.url===I?{...l,customTitle:te}:l)),ce(null),C("Feed atualizado."))},we=()=>{ce(null),se("")},[B,H]=g.useState(null),[de,Ae]=g.useState(null),ue=g.useRef({});return g.useEffect(()=>{const l=h=>{B&&ue.current[B]&&(ue.current[B]?.contains(h.target)||H(null))};return document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[B]),e.jsxs("div",{className:"h-full flex flex-col",role:"dialog","aria-labelledby":"category-manager-title",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-8",children:[e.jsxs("button",{onClick:()=>E(!0),className:"bg-[rgb(var(--color-accent))] hover:bg-[rgb(var(--color-accent))]/90 text-white font-medium px-4 py-2 rounded-lg transition-all shadow-lg shadow-[rgb(var(--color-accent))]/20 hover:shadow-[rgb(var(--color-accent))]/40 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),r("action.add")]}),e.jsxs("button",{onClick:ee,className:"bg-gray-800 hover:bg-gray-700 text-white font-medium px-4 py-2 rounded-lg transition-all border border-white/10 hover:border-white/20 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),r("action.export")," OPML"]}),e.jsxs("button",{onClick:()=>{X(null),Q.current?.click()},className:"bg-gray-800 hover:bg-gray-700 text-white font-medium px-4 py-2 rounded-lg transition-all border border-white/10 hover:border-white/20 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),r("action.import")," OPML"]}),e.jsxs("button",{onClick:Ee,className:"bg-red-500/10 hover:bg-red-500/20 text-red-400 hover:text-red-300 font-medium px-4 py-2 rounded-lg transition-all border border-red-500/20 flex items-center ml-auto",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),r("action.reset")]})]}),e.jsx("input",{type:"file",ref:Te,onChange:ge,accept:".json",className:"hidden"}),e.jsx("input",{type:"file",ref:Q,onChange:Re,accept:".opml,.xml",className:"hidden"}),Se&&e.jsxs("div",{className:"bg-gray-800/40 backdrop-blur-md border border-white/5 rounded-xl p-6 mb-8 animate-in slide-in-from-top-4",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("span",{className:"p-2 rounded-lg bg-[rgb(var(--color-accent))]/10 mr-3",children:e.jsx("svg",{className:"w-5 h-5 text-[rgb(var(--color-accent))]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Create New Category"})]}),e.jsxs("form",{onSubmit:Fe,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category-name",className:"block text-sm font-medium text-gray-300 mb-2",children:"Category Name"}),e.jsx("input",{id:"category-name",type:"text",value:D.name,onChange:l=>_(h=>({...h,name:l.target.value})),placeholder:"Enter category name",className:"w-full bg-black/30 text-white rounded-lg px-4 py-3 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent))] focus:border-transparent transition-all",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category-color",className:"block text-sm font-medium text-gray-300 mb-2",children:"Color Tag"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{id:"category-color",type:"color",value:D.color,onChange:l=>_(h=>({...h,color:l.target.value})),className:"w-14 h-14 bg-transparent rounded-lg cursor-pointer border-0 p-0"}),e.jsxs("div",{className:"flex items-center space-x-3 bg-black/20 px-4 py-2 rounded-lg border border-white/5",children:[e.jsx("div",{className:"w-6 h-6 rounded-full shadow-[0_0_10px_rgba(0,0,0,0.3)]",style:{backgroundColor:D.color}}),e.jsx("span",{className:"text-sm text-gray-400 font-mono",children:D.color})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category-layout",className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Layout"}),e.jsx("select",{id:"category-layout",value:D.layoutMode||"",onChange:l=>_(h=>({...h,layoutMode:l.target.value?l.target.value:void 0})),className:"w-full bg-black/30 text-white rounded-lg px-4 py-3 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent))] focus:border-transparent transition-all",children:G.map(l=>e.jsx("option",{value:l.value,children:l.label},l.label))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category-header-position",className:"block text-sm font-medium text-gray-300 mb-2",children:"Posio do Cabealho"}),e.jsx("select",{id:"category-header-position",value:D.headerPosition||"",onChange:l=>_(h=>({...h,headerPosition:l.target.value?l.target.value:void 0})),className:"w-full bg-black/30 text-white rounded-lg px-4 py-3 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent))] focus:border-transparent transition-all",children:J.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category-description",className:"block text-sm font-medium text-gray-300 mb-2",children:"Description (optional)"}),e.jsx("textarea",{id:"category-description",value:D.description,onChange:l=>_(h=>({...h,description:l.target.value})),className:"w-full bg-black/30 text-white rounded-lg px-4 py-3 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent))] focus:border-transparent transition-all resize-none",rows:3,placeholder:"Enter a description for this category..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",className:"bg-[rgb(var(--color-accent))] hover:bg-[rgb(var(--color-accent))]/90 text-white font-medium px-6 py-2.5 rounded-lg transition-all shadow-lg shadow-[rgb(var(--color-accent))]/20",children:"Create Category"}),e.jsx("button",{type:"button",onClick:()=>E(!1),className:"bg-gray-700 hover:bg-gray-600 text-white font-medium px-6 py-2.5 rounded-lg transition-all",children:"Cancel"})]})]})]}),w&&e.jsxs("div",{className:"bg-gray-800/40 backdrop-blur-md border border-[rgb(var(--color-accent))]/30 rounded-xl p-6 mb-8 animate-in slide-in-from-top-4 shadow-[0_0_30px_rgba(var(--color-accent),0.1)]",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("span",{className:"p-2 rounded-lg bg-[rgb(var(--color-accent))]/10 mr-3",children:e.jsx("svg",{className:"w-5 h-5 text-[rgb(var(--color-accent))]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Edit Category"})]}),e.jsxs("form",{onSubmit:le,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-category-name",className:"block text-sm font-medium text-gray-300 mb-2",children:"Category Name"}),e.jsx("input",{id:"edit-category-name",type:"text",value:f.name,onChange:l=>S(h=>({...h,name:l.target.value})),className:"w-full bg-black/30 text-white rounded-lg px-4 py-3 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent))] focus:border-transparent transition-all",required:!0,autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-category-color",className:"block text-sm font-medium text-gray-300 mb-2",children:"Color Tag"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{id:"edit-category-color",type:"color",value:f.color,onChange:l=>S(h=>({...h,color:l.target.value})),className:"w-14 h-14 bg-transparent rounded-lg cursor-pointer border-0 p-0"}),e.jsxs("div",{className:"flex items-center space-x-3 bg-black/20 px-4 py-2 rounded-lg border border-white/5",children:[e.jsx("div",{className:"w-6 h-6 rounded-full shadow-[0_0_10px_rgba(0,0,0,0.3)]",style:{backgroundColor:f.color}}),e.jsx("span",{className:"text-sm text-gray-400 font-mono",children:f.color})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-category-layout",className:"block text-sm font-medium text-gray-300 mb-2",children:"Default Layout"}),e.jsx("select",{id:"edit-category-layout",value:f.layoutMode||"",onChange:l=>S(h=>({...h,layoutMode:l.target.value?l.target.value:void 0})),className:"w-full bg-black/30 text-white rounded-lg px-4 py-3 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent))] focus:border-transparent transition-all",children:G.map(l=>e.jsx("option",{value:l.value,children:l.label},l.label))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-category-header-position",className:"block text-sm font-medium text-gray-300 mb-2",children:"Posio do Cabealho"}),e.jsx("select",{id:"edit-category-header-position",value:f.headerPosition||"",onChange:l=>S(h=>({...h,headerPosition:l.target.value?l.target.value:void 0})),className:"w-full bg-black/30 text-white rounded-lg px-4 py-3 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent))] focus:border-transparent transition-all",children:J.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-category-description",className:"block text-sm font-medium text-gray-300 mb-2",children:"Description (optional)"}),e.jsx("textarea",{id:"edit-category-description",value:f.description,onChange:l=>S(h=>({...h,description:l.target.value})),className:"w-full bg-black/30 text-white rounded-lg px-4 py-3 border border-white/10 focus:outline-none focus:ring-2 focus:ring-[rgb(var(--color-accent))] focus:border-transparent transition-all resize-none",rows:3,placeholder:"Enter a description for this category..."})]}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsx("button",{type:"submit",className:"bg-[rgb(var(--color-accent))] hover:bg-[rgb(var(--color-accent))]/90 text-white font-medium px-6 py-2.5 rounded-lg transition-all shadow-lg shadow-[rgb(var(--color-accent))]/20",children:"Save Changes"}),e.jsx("button",{type:"button",onClick:De,className:"bg-gray-700 hover:bg-gray-600 text-white font-medium px-6 py-2.5 rounded-lg transition-all",children:"Cancel"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 overflow-y-auto custom-scrollbar pr-2 pb-6 flex-grow",children:[Z.map(l=>((T[l.id]?.length||0)===0?Le[l.id]:Le[l.id],e.jsxs("div",{className:`bg-gray-800/40 backdrop-blur-sm border rounded-xl p-4 transition-all duration-300 flex flex-col h-full ${R.dragOverCategory===l.id?"border-[rgb(var(--color-accent))] bg-[rgb(var(--color-accent))]/10 shadow-[0_0_30px_rgba(var(--color-accent),0.1)] scale-[1.02]":"border-white/5 hover:border-white/10 hover:bg-gray-800/60"}`,onDragOver:u=>K(u,l.id),onDragLeave:ie,onDrop:u=>$(u,l.id),children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 cursor-move group",draggable:!0,onDragStart:u=>Y(u,"category",l.id,l),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full shadow-[0_0_10px_rgba(0,0,0,0.3)] ring-2 ring-white/10",style:{backgroundColor:l.color}}),e.jsx("h3",{className:"font-bold text-white text-lg tracking-tight group-hover:text-[rgb(var(--color-accent))] transition-colors",children:l.name}),l.isDefault&&e.jsx("span",{className:"text-[10px] uppercase tracking-wider font-semibold bg-white/10 text-gray-400 px-2 py-0.5 rounded-full",children:"Default"})]}),e.jsxs("div",{className:"flex space-x-1 transition-opacity",children:[e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:u=>{if(u.stopPropagation(),B===l.id)H(null);else{const x=u.currentTarget.getBoundingClientRect();Ae({top:x.bottom+5,left:x.left}),H(l.id)}},className:`p-1.5 rounded-lg transition-colors ${l.layoutMode?"text-[rgb(var(--color-accent))] bg-[rgb(var(--color-accent))]/10 hover:bg-[rgb(var(--color-accent))]/20":"text-gray-400 hover:text-white hover:bg-white/10"}`,title:`Layout: ${G.find(u=>u.value===(l.layoutMode||""))?.label||"Default"}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"})})}),B===l.id&&de&&Ce.createPortal(e.jsx("div",{ref:u=>{ue.current[l.id]=u},className:"fixed w-48 bg-[#0a0a0c] border border-white/10 rounded-lg shadow-2xl py-1 z-[9999] animate-in fade-in zoom-in-95 duration-100 max-h-[300px] overflow-y-auto custom-scrollbar",style:{top:de.top,left:de.left},onClick:u=>u.stopPropagation(),children:G.map(u=>e.jsx("button",{onClick:()=>{i(l.id,{layoutMode:u.value}),H(null)},className:`w-full text-left px-3 py-2 text-sm transition-colors ${(l.layoutMode||"")===u.value?"text-[rgb(var(--color-accent))] bg-white/5 font-medium":"text-gray-300 hover:bg-white/10 hover:text-white"}`,children:u.label},u.label))}),document.body)]},l.id+"-layout-switcher"),e.jsx("button",{onClick:()=>i(l.id,{isPinned:!l.isPinned}),className:`p-1.5 rounded-lg transition-colors ${l.isPinned?"text-[rgb(var(--color-accent))] bg-[rgb(var(--color-accent))]/10 hover:bg-[rgb(var(--color-accent))]/20":"text-gray-400 hover:text-white hover:bg-white/10"}`,title:l.isPinned?`Unpin ${l.name}`:`Pin ${l.name}`,children:e.jsx("svg",{className:"w-4 h-4",fill:l.isPinned?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})})}),e.jsx("button",{onClick:()=>{X(l.id),Q.current?.click()},className:"p-1.5 text-gray-400 hover:text-green-400 hover:bg-green-500/10 rounded-lg transition-colors",title:`Import OPML to ${l.name}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),e.jsx("button",{onClick:()=>xe(l),className:"p-1.5 text-gray-400 hover:text-white hover:bg-white/10 rounded-lg transition-colors",title:`Edit ${l.name}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>pe(l.id),className:"p-1.5 text-gray-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:`Delete ${l.name}`,children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),l.description&&e.jsx("p",{className:"text-gray-400 text-sm mb-4 leading-relaxed line-clamp-2",children:et(l.description)}),e.jsxs("div",{className:"space-y-2 min-h-[100px] flex-grow bg-black/20 rounded-xl p-3 border border-white/5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 px-1",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:[T[l.id]?.length||0," feeds"]}),(T[l.id]?.length||0)>0&&e.jsxs("span",{className:"text-[10px] text-gray-600 flex items-center",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"})}),"Arraste para reordenar"]})]}),(oe[l.id]?T[l.id]||[]:(T[l.id]||[]).slice(0,2)).map(u=>e.jsx("div",{className:`bg-gray-800/50 p-3 rounded-lg cursor-move transition-all duration-200 border border-white/5 group ${I===u.url?"ring-2 ring-[rgb(var(--color-accent))]":"hover:bg-gray-700 hover:border-[rgb(var(--color-accent))]/50"}`,draggable:I!==u.url,onDragStart:x=>!I&&Y(x,"feed",u.url,u),children:I===u.url?e.jsxs("div",{className:"flex flex-col gap-2",onClick:x=>x.stopPropagation(),children:[e.jsx("input",{type:"text",value:te,onChange:x=>se(x.target.value),className:"w-full bg-black/30 text-white rounded px-2 py-1 text-sm border border-white/10 focus:outline-none focus:border-[rgb(var(--color-accent))]",placeholder:"Nome do feed",autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:be,className:"text-xs bg-[rgb(var(--color-accent))] text-white px-2 py-1 rounded hover:opacity-90",children:"Salvar"}),e.jsx("button",{onClick:we,className:"text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded hover:bg-gray-600",children:"Cancelar"})]})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1 h-8 rounded-full bg-gray-700 group-hover:bg-[rgb(var(--color-accent))] transition-colors"}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("div",{className:"text-sm text-white font-medium truncate mb-0.5 group-hover:text-[rgb(var(--color-accent))] transition-colors",title:u.customTitle||u.url,children:u.customTitle||u.url}),e.jsx("div",{className:"text-xs text-gray-500 truncate font-mono opacity-60",children:u.url})]}),e.jsxs("div",{className:"flex items-center space-x-1 transition-opacity",children:[e.jsx("button",{onClick:()=>ve(u),className:"p-1 text-gray-400 hover:text-white hover:bg-white/10 rounded",title:"Editar nome",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>fe(u.url,u.customTitle),className:"p-1 text-gray-400 hover:text-red-400 hover:bg-red-500/10 rounded",title:"Excluir feed",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("div",{className:"cursor-move p-1 text-gray-600 hover:text-gray-400",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]})},u.url)),(T[l.id]?.length||0)>2&&e.jsx("button",{onClick:()=>W(u=>({...u,[l.id]:!u[l.id]})),className:"w-full py-2 text-xs text-center text-gray-500 hover:text-white hover:bg-white/5 rounded-lg transition-colors mt-2 flex items-center justify-center gap-1",children:oe[l.id]?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Mostrar Menos"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Mostrar mais ",(T[l.id]?.length||0)-2]})}),(T[l.id]||[]).length===0&&e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-600 text-xs py-8 border-2 border-dashed border-white/5 rounded-lg",children:[e.jsx("span",{className:"mb-1",children:"Categoria Vazia"}),e.jsx("span",{children:"Arraste feeds aqui"})]})]})]},l.id))),me>0&&!V&&e.jsxs("button",{onClick:()=>q(!0),className:"flex items-center justify-center gap-2 p-4 rounded-xl border-2 border-dashed border-white/10 text-gray-400 hover:text-white hover:border-white/20 hover:bg-white/5 transition-all",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Ver mais ",me," categorias"]}),V&&o.length>2&&e.jsxs("button",{onClick:()=>q(!1),className:"flex items-center justify-center gap-2 p-4 rounded-xl border-2 border-dashed border-white/10 text-gray-400 hover:text-white hover:border-white/20 hover:bg-white/5 transition-all",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}),"Mostrar menos"]}),(T.uncategorized||[]).length>0&&e.jsxs("div",{className:`bg-gray-800/40 backdrop-blur-sm border-2 border-dashed rounded-xl p-4 transition-all duration-300 flex flex-col h-full ${R.dragOverCategory==="uncategorized"?"border-[rgb(var(--color-accent))] bg-[rgb(var(--color-accent))]/10 shadow-[0_0_30px_rgba(var(--color-accent),0.1)] scale-[1.02]":"border-yellow-500/30 hover:border-yellow-500/50 hover:bg-gray-800/60"}`,onDragOver:l=>K(l,"uncategorized"),onDragLeave:ie,onDrop:l=>$(l,"uncategorized"),children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.3)]"}),e.jsx("h3",{className:"font-bold text-white text-lg tracking-tight",children:"Sem Categoria"}),e.jsx("span",{className:"text-[10px] uppercase tracking-wider font-semibold bg-yellow-500/20 text-yellow-400 px-2 py-0.5 rounded-full border border-yellow-500/20",children:"Organizar"})]}),e.jsxs("div",{className:"space-y-2 min-h-[100px] flex-grow bg-black/20 rounded-xl p-3 border border-white/5",children:[e.jsx("div",{className:"flex items-center justify-between mb-2 px-1",children:e.jsxs("span",{className:"text-xs font-medium text-gray-500 uppercase tracking-wider",children:[T.uncategorized?.length||0," feeds"]})}),(T.uncategorized||[]).map(l=>e.jsx("div",{className:`bg-gray-800/50 p-3 rounded-lg cursor-move transition-all duration-200 border border-white/5 group ${I===l.url?"ring-2 ring-[rgb(var(--color-accent))]":"hover:bg-gray-700 hover:border-yellow-500/50"}`,draggable:I!==l.url,onDragStart:h=>!I&&Y(h,"feed",l.url,l),children:I===l.url?e.jsxs("div",{className:"flex flex-col gap-2",onClick:h=>h.stopPropagation(),children:[e.jsx("input",{type:"text",value:te,onChange:h=>se(h.target.value),className:"w-full bg-black/30 text-white rounded px-2 py-1 text-sm border border-white/10 focus:outline-none focus:border-[rgb(var(--color-accent))]",placeholder:"Nome do feed",autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:be,className:"text-xs bg-[rgb(var(--color-accent))] text-white px-2 py-1 rounded hover:opacity-90",children:"Salvar"}),e.jsx("button",{onClick:we,className:"text-xs bg-gray-700 text-gray-300 px-2 py-1 rounded hover:bg-gray-600",children:"Cancelar"})]})]}):e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-1 h-8 rounded-full bg-yellow-500/50 group-hover:bg-yellow-500 transition-colors"}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("div",{className:"text-sm text-white font-medium truncate mb-0.5 group-hover:text-yellow-400 transition-colors",title:l.customTitle||l.url,children:l.customTitle||l.url}),e.jsx("div",{className:"text-xs text-gray-500 truncate font-mono opacity-60",children:l.url})]}),e.jsxs("div",{className:"flex items-center space-x-1 transition-opacity",children:[e.jsx("button",{onClick:()=>ve(l),className:"p-1 text-gray-400 hover:text-white hover:bg-white/10 rounded",title:"Editar nome",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>fe(l.url,l.customTitle),className:"p-1 text-gray-400 hover:text-red-400 hover:bg-red-500/10 rounded",title:"Excluir feed",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx("div",{className:"cursor-move p-1 text-gray-600 hover:text-gray-400",children:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]})},l.url))]})]})]}),e.jsxs("div",{className:"mt-6 bg-blue-900/10 border border-blue-500/20 rounded-xl p-4 flex items-start space-x-4",children:[e.jsx("div",{className:"p-2 bg-blue-500/20 rounded-lg text-blue-400 mt-1",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h4",{className:"font-semibold text-blue-100 mb-2",children:"Dicas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-2 text-sm text-blue-200/70",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),e.jsx("span",{children:"Arraste feeds entre categorias para organiz-los"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),e.jsx("span",{children:"Arraste categorias para reorden-las (apenas customizadas)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),e.jsx("span",{children:"Use cores para distinguir categorias visualmente"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),e.jsx("span",{children:"Exporte seu setup para compartilhar com outros"})]})]})]})]})]})},pt=({isOpen:p,onClose:t,originalUrl:s,discoveredFeeds:r,onSelectFeed:a,isLoading:o=!1})=>{const n=m=>m>=.8?"green":m>=.6?"yellow":"red",i=m=>m>=.8?"High":m>=.6?"Medium":"Low",c=m=>{switch(m){case"direct":return"Direct RSS";case"link_discovery":return"Link Discovery";case"html_parsing":return"HTML Parsing";case"common_paths":return"Common Paths";default:return m}},d=m=>{o||a(m)};return e.jsx(st,{isOpen:p,onClose:t,children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"mb-6",children:e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Multiple Feeds Discovered"})}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(rt.Info,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-1",children:"Multiple RSS feeds found"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["We discovered ",r.length," RSS feeds from the URL you provided. Please select the feed you want to add:"]}),e.jsx("p",{className:"text-xs text-blue-600 mt-2 font-mono break-all",children:s})]})]})}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:r.map((m,b)=>e.jsxs(je,{className:"cursor-pointer hover:shadow-md transition-all duration-200 hover:border-blue-300",onClick:()=>d(m),padding:"md",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(it.RSS,{className:"text-orange-500"}),e.jsxs(_e,{variant:n(m.confidence),className:"text-xs",children:[i(m.confidence)," Confidence"]}),e.jsx(_e,{variant:"gray",className:"text-xs",children:c(m.discoveryMethod)})]}),e.jsx(ze,{size:"sm",variant:"primary",onClick:L=>{L?.stopPropagation(),d(m)},disabled:o,icon:e.jsx(at.Add,{}),children:"Select"})]}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2 line-clamp-2",children:m.title||"Untitled Feed"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2 font-mono break-all",children:m.url.length>80?`${m.url.substring(0,77)}...`:m.url}),m.description&&e.jsx("p",{className:"text-sm text-gray-500 line-clamp-3 leading-relaxed",children:tt(m.description)}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-3 text-xs text-gray-500",children:[e.jsxs("span",{children:["Confidence: ",Math.round(m.confidence*100),"%"]}),m.type&&e.jsxs("span",{children:["Type: ",m.type]})]})]},`${m.url}-${b}`))}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[r.length," feed",r.length!==1?"s":""," found"]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(ze,{variant:"secondary",onClick:t,disabled:o,children:"Cancel"})})]})]})})},gt=({isOpen:p,onClose:t,feeds:s,onRemoveFeeds:r})=>{const[a,o]=g.useState([]),[n,i]=g.useState(new Set),[c,d]=g.useState(1),[m,b]=g.useState("all"),{confirmDanger:L,alertSuccess:U}=Ie(),k=Ve.useCallback(()=>{try{const w=localStorage.getItem("feed-error-history");if(w){const v=JSON.parse(w),f=Array.isArray(v)?v.map(S=>({url:S.url,failures:S.failures||1,lastError:S.lastError,lastErrorType:S.lastErrorType||"unknown"})):[];o(f)}}catch(w){console.error("Failed to load feed error history",w)}},[]);g.useEffect(()=>{if(p){const w=requestAnimationFrame(()=>k());return()=>cancelAnimationFrame(w)}},[p,k]);const M=a.filter(w=>!(!s.some(f=>f.url===w.url)||w.failures<c||m!=="all"&&w.lastErrorType!==m)),F=w=>{if(w){const v=M.map(f=>f.url);i(new Set(v))}else i(new Set)},R=w=>{const v=new Set(n);v.has(w)?v.delete(w):v.add(w),i(v)},A=async()=>{if(n.size===0)return;if(await L(`Tem certeza que deseja remover ${n.size} feeds selecionados? Esta ao no pode ser desfeita.`)){r(Array.from(n));const v=a.filter(f=>!n.has(f.url));localStorage.setItem("feed-error-history",JSON.stringify(v)),U(`${n.size} feeds removidos com sucesso.`),k(),i(new Set),t()}};return p?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"w-full max-w-2xl bg-gray-900 border border-white/10 rounded-2xl shadow-2xl overflow-hidden flex flex-col max-h-[80vh]",children:[e.jsxs("div",{className:"p-6 border-b border-white/10 flex justify-between items-center bg-black/20",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx("span",{className:"text-red-400",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),"Limpeza de Feeds"]}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Remova feeds que esto apresentando erros recorrentes."})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx("svg",{className:"w-6 h-6 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-4 bg-white/5 border-b border-white/10 flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Mnimo de Falhas"}),e.jsx("input",{type:"number",min:"1",value:c,onChange:w=>d(parseInt(w.target.value)||1),className:"bg-black/20 border border-white/10 rounded-lg px-3 py-2 text-white w-24 focus:outline-none focus:border-red-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Tipo de Erro"}),e.jsxs("select",{value:m,onChange:w=>b(w.target.value),className:"bg-black/20 border border-white/10 rounded-lg px-3 py-2 text-white w-40 focus:outline-none focus:border-red-500",children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"timeout",children:"Timeout"}),e.jsx("option",{value:"network",children:"Rede (Network)"}),e.jsx("option",{value:"parse",children:"Parse (Formato)"}),e.jsx("option",{value:"cors",children:"CORS"}),e.jsx("option",{value:"unknown",children:"Desconhecido"})]})]}),e.jsxs("div",{className:"flex-1 text-right text-xs text-gray-500 pb-2",children:["Encontrados: ",e.jsx("span",{className:"text-white font-medium",children:M.length})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-2 min-h-[200px]",children:M.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500 py-10",children:[e.jsx("svg",{className:"w-12 h-12 mb-3 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{children:"Nenhum feed corresponde aos critrios."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex items-center justify-between mb-2 px-2",children:e.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-400 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:M.length>0&&n.size===M.length,onChange:w=>F(w.target.checked),className:"rounded border-gray-600 bg-gray-800 text-red-500 focus:ring-red-500"}),"Selecionar Todos"]})}),M.map(w=>{const v=s.find(f=>f.url===w.url);return e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border transition-colors ${n.has(w.url)?"bg-red-500/10 border-red-500/30":"bg-black/20 border-white/5 hover:border-white/10"}`,children:[e.jsx("input",{type:"checkbox",checked:n.has(w.url),onChange:()=>R(w.url),className:"rounded border-gray-600 bg-gray-800 text-red-500 focus:ring-red-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-medium text-white truncate",children:v?.customTitle||new URL(w.url).hostname}),e.jsx("p",{className:"text-xs text-gray-500 truncate",title:w.url,children:w.url})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-red-500/10 text-red-400 border border-red-500/20",children:[w.failures," falhas"]}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-1 uppercase",children:w.lastErrorType})]})]},w.url)})]})}),e.jsxs("div",{className:"p-4 border-t border-white/10 bg-black/20 flex justify-end gap-3",children:[e.jsx("button",{onClick:t,className:"px-4 py-2 rounded-lg text-sm font-medium text-gray-400 hover:text-white hover:bg-white/5 transition-colors",children:"Cancelar"}),e.jsxs("button",{onClick:A,disabled:n.size===0,className:"px-4 py-2 rounded-lg text-sm font-medium bg-red-600 text-white hover:bg-red-500 transition-colors disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-red-900/20",children:["Excluir ",n.size>0?`(${n.size})`:""]})]})]})}):null},Pe=Ke,ft=({feeds:p,articles:t,feedValidations:s})=>{const r=g.useMemo(()=>{const n=new Map;p.forEach(c=>{const d=c.customTitle||c.url;n.set(d,0)}),t.forEach(c=>{const d=c.sourceTitle||"Unknown Source";if(n.has(d))n.set(d,(n.get(d)||0)+1);else{const m=p.find(b=>c.link.includes(new URL(b.url).hostname));if(m){const b=m.customTitle||m.url;n.set(b,(n.get(b)||0)+1)}}});const i=Array.from(n.entries()).sort((c,d)=>d[1]-c[1]);return{mostActive:i.slice(0,5),leastActive:i.filter(c=>c[1]===0).slice(0,5),totalArticles:t.length}},[p,t]),a=g.useMemo(()=>{const n=new Map;return t.forEach(i=>{i.categories&&i.categories.length>0&&i.categories.forEach(c=>{const d=c.trim().toLowerCase();d.length>2&&!["uncategorized","general","news"].includes(d)&&n.set(d,(n.get(d)||0)+1)})}),Array.from(n.entries()).sort((i,c)=>c[1]-i[1]).slice(0,10)},[t]),o=g.useMemo(()=>{let n=0,i=0,c=0;const d=[];return p.forEach(m=>{const b=s.get(m.url);b?b.isValid?n++:(i++,d.push({url:m.url,title:m.customTitle,error:b.error||"Erro desconhecido"})):c++}),{valid:n,invalid:i,unchecked:c,issues:d}},[p,s]);return e.jsxs("div",{className:"space-y-6 animate-in fade-in duration-300 p-2",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(je,{variant:"glass",className:"p-4 flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-blue-500/20 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Artigos em Cache"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:r.totalArticles}),e.jsxs("span",{className:"text-[10px] text-gray-500",children:["Atualizado: ",new Date().toLocaleTimeString()]})]})]}),e.jsxs(je,{variant:"glass",className:"p-4 flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-[rgb(var(--color-accent))]/20 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-[rgb(var(--color-accent))]",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 5c7.18 0 13 5.82 13 13M6 11c3.866 0 7 3.134 7 7m-7-7v7"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Feeds Monitorados"}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:p.length})]})]}),e.jsxs(je,{variant:"glass",className:"p-4 flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-full ${o.invalid>0?"bg-red-500/20":"bg-green-500/20"}`,children:e.jsx("svg",{className:`w-6 h-6 ${o.invalid>0?"text-red-400":"text-green-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-400",children:"Sade do Sistema"}),e.jsx("h3",{className:"text-xl font-bold text-white",children:o.invalid>0?`${o.invalid} com erro`:"100% Operacional"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800/40 rounded-xl border border-white/10 p-5",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-purple-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 20l4-16m2 16l4-16M6 9h14M4 15h14"})}),"Assuntos Populares"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.length>0?a.map(([n,i],c)=>e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${c<3?"bg-purple-500/20 text-purple-300 border-purple-500/30":"bg-gray-700/50 text-gray-300 border-white/5"}`,children:["#",n," ",e.jsxs("span",{className:"opacity-50 ml-1",children:["(",i,")"]})]},n)):e.jsx("p",{className:"text-sm text-gray-500 italic",children:"No h dados suficientes para anlise de tpicos ainda."})})]}),e.jsxs("div",{className:"bg-gray-800/40 rounded-xl border border-white/10 p-5",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"Maior Frequncia"]}),e.jsx("div",{className:"space-y-3",children:r.mostActive.map(([n,i],c)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("span",{className:"w-5 text-xs text-gray-500 mr-2",children:["#",c+1]}),e.jsx("span",{className:"text-sm text-gray-200 truncate max-w-[200px]",children:n})]}),e.jsxs("span",{className:"text-xs font-mono bg-green-900/30 text-green-400 px-2 py-0.5 rounded",children:[i," arts."]})]},n))})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800/40 rounded-xl border border-white/10 p-5",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Status dos Feeds"]}),e.jsxs("div",{className:"flex h-4 rounded-full overflow-hidden mb-4 bg-gray-700",children:[e.jsx("div",{className:"bg-green-500 transition-all duration-500",style:{width:`${o.valid/p.length*100}%`},title:"Vlidos"}),e.jsx("div",{className:"bg-red-500 transition-all duration-500",style:{width:`${o.invalid/p.length*100}%`},title:"Com Erro"}),e.jsx("div",{className:"bg-gray-500 transition-all duration-500",style:{width:`${o.unchecked/p.length*100}%`},title:"No Verificados"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center text-xs",children:[e.jsxs("div",{className:"text-green-400",children:[e.jsx("span",{className:"block font-bold text-lg",children:o.valid}),"Vlidos"]}),e.jsxs("div",{className:"text-red-400",children:[e.jsx("span",{className:"block font-bold text-lg",children:o.invalid}),"Erros"]}),e.jsxs("div",{className:"text-gray-400",children:[e.jsx("span",{className:"block font-bold text-lg",children:o.unchecked}),"Pendentes"]})]})]}),o.issues.length>0?e.jsxs("div",{className:"bg-red-900/10 rounded-xl border border-red-500/20 p-5",children:[e.jsxs("h3",{className:"text-lg font-semibold text-red-400 mb-4 flex items-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Ateno Necessria"]}),e.jsx("div",{className:"space-y-3 max-h-[200px] overflow-y-auto pr-2 custom-scrollbar",children:o.issues.map((n,i)=>e.jsxs("div",{className:"bg-red-500/5 p-3 rounded-lg border border-red-500/10",children:[e.jsx("p",{className:"text-sm font-medium text-red-200 truncate",children:n.title||n.url}),e.jsx("p",{className:"text-xs text-red-400 mt-1 break-all",children:n.error})]},i))})]}):e.jsxs("div",{className:"bg-green-900/10 rounded-xl border border-green-500/20 p-5 text-center",children:[e.jsx("svg",{className:"w-12 h-12 text-green-500/50 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:"text-green-300 font-medium",children:"Tudo Certo!"}),e.jsx("p",{className:"text-green-400/70 text-sm mt-1",children:"Nenhum problema detectado nos seus feeds."})]})]})]})]})},vt=({isOpen:p,onClose:t,onReplace:s,onAddAnyway:r,existingFeed:a,newFeedUrl:o,confidence:n})=>{const{t:i}=ae();return p?Ce.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[60] p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl shadow-2xl max-w-2xl w-full flex flex-col animate-in zoom-in-95 duration-200 max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-white/10 flex items-start justify-between bg-black/20",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0 bg-yellow-500/10 p-3 rounded-xl h-fit",children:e.jsx("svg",{className:"w-6 h-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 15.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white leading-tight",children:i("feeds.duplicate.title")||"Feed Duplicado Detectado"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:i("feeds.duplicate.message")||"Este feed parece ser uma duplicata de um existente."})]})]}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-white transition-colors p-1","aria-label":"Close",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 relative",children:[e.jsx("div",{className:"hidden md:flex absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-gray-800 rounded-full p-2 border border-white/10 z-10 shadow-lg",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),e.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-5 border border-white/5 flex flex-col h-full relative group hover:border-white/10 transition-colors",children:[e.jsx("div",{className:"absolute top-3 right-3 text-xs font-bold text-gray-500 uppercase tracking-wider bg-black/20 px-2 py-1 rounded",children:i("feeds.duplicate.existing")||"Existente"}),e.jsxs("div",{className:"mt-4 flex-1",children:[e.jsx("h4",{className:"text-white font-medium text-lg mb-2 line-clamp-2",title:a?.customTitle||a?.url,children:a?.customTitle||"Sem Ttulo"}),e.jsx("div",{className:"bg-black/30 rounded-lg p-3 border border-white/5 break-all",children:e.jsx("p",{className:"text-blue-300 text-sm font-mono leading-relaxed",children:a?.url})})]})]}),e.jsxs("div",{className:"bg-[rgb(var(--color-accent))]/5 rounded-xl p-5 border border-[rgb(var(--color-accent))]/20 flex flex-col h-full relative group hover:border-[rgb(var(--color-accent))]/30 transition-colors",children:[e.jsx("div",{className:"absolute top-3 right-3 text-xs font-bold text-[rgb(var(--color-accent))] uppercase tracking-wider bg-[rgb(var(--color-accent))]/10 px-2 py-1 rounded",children:i("feeds.duplicate.new")||"Novo"}),e.jsxs("div",{className:"mt-4 flex-1",children:[e.jsx("h4",{className:"text-gray-300 font-medium text-lg mb-2 italic",children:"(Novo Feed)"}),e.jsx("div",{className:"bg-black/30 rounded-lg p-3 border border-white/5 break-all",children:e.jsx("p",{className:"text-[rgb(var(--color-accent))] text-sm font-mono leading-relaxed",children:o})})]})]})]}),e.jsx("div",{className:"mt-6 flex items-center justify-center",children:e.jsxs("div",{className:"bg-gray-800/50 rounded-full px-4 py-1.5 border border-white/5 flex items-center gap-2 text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:[i("feeds.duplicate.confidence")||"Confiana",":"]}),e.jsxs("span",{className:`font-bold ${n>.9?"text-red-400":n>.7?"text-yellow-400":"text-green-400"}`,children:[Math.round(n*100),"%"]})]})})]}),e.jsxs("div",{className:"p-6 border-t border-white/10 bg-black/20 flex flex-col sm:flex-row gap-3 sm:justify-end",children:[e.jsx("button",{onClick:t,className:"px-5 py-2.5 rounded-lg text-gray-400 hover:text-white hover:bg-white/5 transition-colors font-medium text-sm",children:i("feeds.action.cancel_dont_add")||"Cancelar"}),e.jsx("button",{onClick:r,className:"px-5 py-2.5 rounded-lg border border-white/10 bg-white/5 hover:bg-white/10 text-white transition-colors font-medium text-sm flex items-center justify-center gap-2",children:e.jsx("span",{children:i("feeds.action.add_anyway")||"Adicionar Mesmo Assim"})}),e.jsxs("button",{onClick:s,className:"px-5 py-2.5 rounded-lg bg-yellow-600 hover:bg-yellow-500 text-white shadow-lg shadow-yellow-600/20 transition-all font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),e.jsx("span",{children:i("feeds.action.replace")||"Substituir Existente"})]})]})]})}),document.body):null},Ue=({feed:p,validation:t,onRemove:s,onRetry:r,onEdit:a,onShowError:o,categories:n,onMoveCategory:i})=>{const c=()=>t?t.isValid?"text-green-400":"text-red-400":"text-gray-400",d=()=>t?t.isValid?"":"":"?";return e.jsx("div",{className:"bg-black/20 border border-white/5 rounded-lg p-3 hover:border-white/10 transition-colors",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`text-sm font-bold ${c()}`,children:d()}),e.jsx("h4",{className:"text-white font-medium truncate",children:p.customTitle||t?.title||"Feed sem ttulo"})]}),e.jsx("p",{className:"text-gray-400 text-xs truncate mt-1",children:p.url}),t?.error&&e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx("p",{className:"text-red-400 text-xs truncate max-w-[200px] sm:max-w-xs",children:t.error}),o&&e.jsx("button",{onClick:()=>o(p.url),className:"text-[10px] uppercase font-bold text-red-300 hover:text-white bg-red-500/10 hover:bg-red-500/30 px-2 py-0.5 rounded transition-colors",children:"Ver Detalhes"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("select",{value:p.categoryId||"",onChange:m=>i(m.target.value),className:"bg-black/30 text-gray-400 text-xs rounded px-2 py-1 border border-white/10 focus:outline-none focus:border-[rgb(var(--color-accent))]",children:[e.jsx("option",{value:"",children:"Sem categoria"}),n.map(m=>e.jsx("option",{value:m.id,children:m.name},m.id))]}),t&&!t.isValid&&o&&e.jsx("button",{onClick:()=>o(p.url),className:"p-1.5 text-gray-400 hover:text-red-400 hover:bg-red-400/10 rounded transition-colors",title:"Ver Detalhes do Erro",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("button",{onClick:()=>r(p.url),className:"p-1.5 text-gray-400 hover:text-blue-400 hover:bg-blue-400/10 rounded transition-colors",title:"Revalidar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("button",{onClick:()=>a(p.url),className:"p-1.5 text-gray-400 hover:text-yellow-400 hover:bg-yellow-400/10 rounded transition-colors",title:"Editar",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>s(p.url),className:"p-1.5 text-gray-400 hover:text-red-400 hover:bg-red-400/10 rounded transition-colors",title:"Remover",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})})},bt=({feeds:p,validations:t,categories:s,onRemove:r,onRetry:a,onEdit:o,onShowError:n,onMoveCategory:i,onRefreshAll:c})=>{const{t:d}=ae(),[m,b]=g.useState(""),[L,U]=g.useState("all"),[k,C]=g.useState("issues"),M=v=>{C(k===v?null:v)},F=p.filter(v=>{const f=t.get(v.url),S=m.toLowerCase(),oe=!m||v.url.toLowerCase().includes(S)||f?.title&&f.title.toLowerCase().includes(S)||f?.description&&f.description.toLowerCase().includes(S)||v.customTitle&&v.customTitle.toLowerCase().includes(S),W=L==="all"||L==="valid"&&f?.status==="valid"||L==="invalid"&&f?.status&&f.status!=="valid"||L==="unchecked"&&!f;return oe&&W}),R=F.filter(v=>{const f=t.get(v.url);return!f||f.isValid}),A=F.filter(v=>{const f=t.get(v.url);return f&&!f.isValid}),w=F.filter(v=>!t.has(v.url));return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-3 sm:p-4 bg-white/5 border-b border-white/5 flex flex-col sm:flex-row gap-3 sm:gap-4 animate-in fade-in shrink-0",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),e.jsx("input",{type:"text",placeholder:d("search.placeholder")||"Buscar...",value:m,onChange:v=>b(v.target.value),className:"w-full bg-black/20 text-white pl-10 pr-4 py-2 rounded-lg border border-white/10 focus:outline-none focus:border-[rgb(var(--color-accent))]"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:L,onChange:v=>U(v.target.value),className:"flex-1 sm:flex-none bg-black/20 text-white px-4 py-2 rounded-lg border border-white/10 focus:outline-none focus:border-[rgb(var(--color-accent))]",children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"valid",children:d("analytics.valid")}),e.jsx("option",{value:"invalid",children:d("analytics.issues")}),e.jsx("option",{value:"unchecked",children:d("analytics.pending")})]}),c&&e.jsx("button",{onClick:()=>{window.confirm("Deseja forar a revalidao de todos os feeds? Isso pode levar alguns instantes.")&&c()},className:"bg-blue-500/10 hover:bg-blue-500/20 text-blue-400 p-2 rounded-lg border border-blue-500/20 transition-colors",title:"Forar Revalidao",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-1 sm:pr-2 custom-scrollbar p-3 sm:p-4 space-y-3",role:"list",children:[F.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[e.jsx("svg",{className:"w-16 h-16 mb-4 opacity-20",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),e.jsx("p",{children:"Nenhum feed encontrado com os filtros atuais."})]}),A.length>0&&e.jsxs("div",{className:"border border-red-500/20 rounded-lg overflow-hidden animate-in fade-in slide-in-from-left-2",children:[e.jsxs("button",{onClick:()=>M("issues"),className:"w-full flex items-center justify-between p-4 bg-red-500/10 hover:bg-red-500/20 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-red-400",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 15.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsxs("span",{className:"font-medium",children:[d("analytics.attention")," (",A.length,")"]})]}),e.jsx("svg",{className:`w-5 h-5 text-red-400 transform transition-transform ${k==="issues"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),k==="issues"&&e.jsx("div",{className:"p-4 bg-black/20 space-y-2",children:A.map(v=>e.jsx(Ue,{feed:v,validation:t.get(v.url),onRemove:r,onRetry:a,onEdit:o,onShowError:f=>n(f,t.get(f)),categories:s,onMoveCategory:f=>i(v.url,f)},v.url))})]}),R.length>0&&e.jsxs("div",{className:"border border-green-500/20 rounded-lg overflow-hidden animate-in fade-in slide-in-from-left-2 delay-75",children:[e.jsxs("button",{onClick:()=>M("valid"),className:"w-full flex items-center justify-between p-4 bg-green-500/10 hover:bg-green-500/20 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-green-400",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsxs("span",{className:"font-medium",children:[d("analytics.valid")," (",R.length,")"]})]}),e.jsx("svg",{className:`w-5 h-5 text-green-400 transform transition-transform ${k==="valid"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),k==="valid"&&e.jsx("div",{className:"p-4 bg-black/20 space-y-2",children:R.map(v=>e.jsx(Ue,{feed:v,validation:t.get(v.url),onRemove:r,onRetry:a,onEdit:o,onShowError:f=>n(f,t.get(f)),categories:s,onMoveCategory:f=>i(v.url,f)},v.url))})]}),w.length>0&&e.jsxs("div",{className:"border border-gray-500/20 rounded-lg overflow-hidden animate-in fade-in slide-in-from-left-2 delay-100",children:[e.jsxs("button",{onClick:()=>M("unchecked"),className:"w-full flex items-center justify-between p-4 bg-gray-500/10 hover:bg-gray-500/20 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{className:"font-medium",children:[d("analytics.pending")," (",w.length,")"]})]}),e.jsx("svg",{className:`w-5 h-5 text-gray-400 transform transition-transform ${k==="unchecked"?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),k==="unchecked"&&e.jsx("div",{className:"p-4 bg-black/20 space-y-2",children:w.map(v=>e.jsx(Ue,{feed:v,validation:t.get(v.url),onRemove:r,onRetry:a,onEdit:o,onShowError:f=>n(f,t.get(f)),categories:s,onMoveCategory:f=>i(v.url,f)},v.url))})]})]})]})},wt=({newFeedUrl:p,setNewFeedUrl:t,newFeedCategory:s,setNewFeedCategory:r,processingUrl:a,categories:o,onSubmit:n,discoveryProgress:i})=>{const{t:c}=ae();return e.jsx("div",{className:"p-4 sm:p-6 h-full overflow-y-auto custom-scrollbar",children:e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"text-center animate-in slide-in-from-top-2",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-white mb-2",children:"Adicionar Novo Feed"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-400",children:"Insira a URL de um site ou canal para comear a monitorar."})]}),e.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 sm:p-6 shadow-xl animate-in fade-in zoom-in-95 duration-300",children:[e.jsxs("form",{onSubmit:n,className:"flex flex-col gap-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"URL do Site ou Feed"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.jsx("input",{type:"text",value:p,onChange:d=>t(d.target.value),placeholder:"https://exemplo.com ou Canal YouTube",disabled:!!a,className:"w-full bg-black/40 text-white pl-10 pr-4 py-3 rounded-lg border border-white/10 focus:outline-none focus:border-[rgb(var(--color-accent))] focus:ring-1 focus:ring-[rgb(var(--color-accent))] disabled:opacity-50 disabled:cursor-not-allowed transition-all"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Categoria (Opcional)"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})})}),e.jsxs("select",{value:s,onChange:d=>r(d.target.value),disabled:!!a,className:"w-full bg-black/40 text-white pl-10 pr-4 py-3 rounded-lg border border-white/10 focus:outline-none focus:border-[rgb(var(--color-accent))] focus:ring-1 focus:ring-[rgb(var(--color-accent))] disabled:opacity-50 disabled:cursor-not-allowed appearance-none transition-all",children:[e.jsx("option",{value:"",children:c("feeds.category.none")}),o.map(d=>e.jsx("option",{value:d.id,children:d.name},d.id))]}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-4 w-4 text-gray-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]})]}),e.jsx("button",{type:"submit",disabled:!!a,className:"mt-2 w-full px-6 py-3 bg-[rgb(var(--color-accent))] hover:bg-[rgb(var(--color-accent))]/90 text-white rounded-lg transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 font-medium shadow-lg shadow-[rgb(var(--color-accent))]/20",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),e.jsx("span",{children:"Processando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{children:c("action.add")})]})})]}),a&&e.jsxs("div",{className:"mt-6 bg-black/30 rounded-lg p-4 border border-white/10 animate-in fade-in slide-in-from-top-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-blue-300 font-medium flex items-center gap-2",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-blue-500"})]}),i.get(a)?.status||c("loading")]}),e.jsxs("span",{className:"text-xs text-gray-500",children:[Math.round(i.get(a)?.progress||0),"%"]})]}),e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5 overflow-hidden",children:e.jsx("div",{className:"bg-blue-500 h-1.5 rounded-full transition-all duration-500 ease-out",style:{width:`${i.get(a)?.progress||5}%`}})})]})]}),e.jsx("div",{className:"bg-red-500/5 border border-red-500/10 rounded-xl p-5 animate-in slide-in-from-bottom-4 duration-500 delay-100",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 bg-red-500/10 p-2 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6 text-red-500",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-2",children:"Como adicionar canais do YouTube?"}),e.jsxs("p",{className:"text-gray-400 text-sm mb-3 leading-relaxed",children:["Nosso sistema possui descoberta automtica. Voc pode tentar colar a ",e.jsx("strong",{children:"URL do canal"})," diretamente."]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-black/30 rounded p-2 border border-white/5",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1 font-bold uppercase",children:"Opo 1: URL do Canal (Recomendado)"}),e.jsx("code",{className:"text-xs text-green-400 font-mono break-all",children:"https://www.youtube.com/@CanalExemplo"})]}),e.jsxs("div",{className:"bg-black/30 rounded p-2 border border-white/5",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1 font-bold uppercase",children:"Opo 2: ID do Canal (Infalvel)"}),e.jsx("p",{className:"text-gray-400 text-xs mb-1",children:"Se a URL falhar, use o ID direto:"}),e.jsx("code",{className:"text-xs text-blue-400 font-mono break-all",children:"UCef5U1dB5a2e2S-XUlnhxSA"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-3 italic",children:"Nota: O sistema converte automaticamente para o feed XML correto."})]})]})})]})})},re=({title:p,description:t,icon:s,onClick:r,variant:a="default",delay:o=0})=>{const n=()=>{switch(a){case"danger":return"bg-red-500/10 border-red-500/20 hover:border-red-500/40 text-red-400 hover:bg-red-500/20";case"warning":return"bg-yellow-500/10 border-yellow-500/20 hover:border-yellow-500/40 text-yellow-400 hover:bg-yellow-500/20";case"success":return"bg-green-500/10 border-green-500/20 hover:border-green-500/40 text-green-400 hover:bg-green-500/20";default:return"bg-white/5 border-white/10 hover:border-white/20 text-blue-400 hover:bg-white/10"}};return e.jsxs("button",{onClick:r,className:`flex flex-col items-start p-5 rounded-xl border transition-all duration-200 group text-left h-full ${n()} animate-in fade-in zoom-in-95`,style:{animationDelay:`${o}ms`},children:[e.jsx("div",{className:"mb-3 p-2 rounded-lg bg-black/20 group-hover:scale-110 transition-transform duration-200",children:s}),e.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:p}),e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed",children:t})]})},yt=({onExportOPML:p,onImportOPML:t,onShowImportModal:s,onResetDefaults:r,onCleanupErrors:a,onDeleteAll:o,feedCount:n})=>{const{t:i}=ae();return e.jsx("div",{className:"p-4 sm:p-6 overflow-y-auto custom-scrollbar h-full",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6 sm:space-y-8",children:[e.jsxs("div",{className:"text-center mb-6 sm:mb-8 animate-in slide-in-from-top-4 duration-500",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-white mb-2",children:"Ferramentas de Gerenciamento"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-400",children:"Gerencie sua coleo de feeds, faa backups e manuteno do sistema."})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsx(re,{title:"Exportar Feeds (OPML)",description:"Baixe um arquivo .opml com todos os seus feeds para backup ou para usar em outros leitores de RSS.",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),onClick:p,delay:0}),e.jsx(re,{title:"Importar OPML",description:"Adicione mltiplos feeds de uma vez carregando um arquivo .opml do seu computador.",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),onClick:t,variant:"default",delay:50}),e.jsx(re,{title:"Listas Curadas",description:"Descubra e importe colees de feeds selecionadas manualmente por categorias (Tech, Notcias, Dev).",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),onClick:s,variant:"success",delay:100}),e.jsx(re,{title:"Limpeza Inteligente",description:"Analisa e remove feeds que esto apresentando erros de conexo ou validao consistentemente.",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),onClick:a,variant:"warning",delay:150}),e.jsx(re,{title:"Restaurar Padres",description:"Substitui sua coleo atual pelos feeds iniciais recomendados. Ateno: remove personalizaes.",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),onClick:r,variant:"warning",delay:200}),e.jsx(re,{title:"Excluir Tudo",description:`Remove permanentemente todos os ${n} feeds monitorados. Esta ao no pode ser desfeita.`,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),onClick:o,variant:"danger",delay:250})]})]})})},Ft=({currentFeeds:p,setFeeds:t,closeModal:s,articles:r=[],onRefreshFeeds:a})=>{const o=We(),{categories:n,createCategory:i,resetToDefaults:c}=He(),{refreshAppearance:d}=Be(),{t:m}=ae(),[b,L]=g.useState("feeds"),[U,k]=g.useState(""),[C,M]=g.useState(""),[F,R]=g.useState(null),A=g.useRef(null),[w,v]=g.useState(new Map),[f,S]=g.useState(!1),[oe,W]=g.useState(null),[D,_]=g.useState(""),{confirm:Se,alertSuccess:E,alertError:V,confirmDanger:q}=Ie(),[Le,Me]=g.useState(new Set),[Te,Q]=g.useState(new Map),[ne,X]=g.useState(!1),[T,Z]=g.useState(null),[me,G]=g.useState(!1),[Y,K]=g.useState(!1),[ee,ie]=g.useState(""),[$,J]=g.useState(null),[Fe,xe]=g.useState(!1),[le,De]=g.useState(null);g.useEffect(()=>{if(Y&&!ee){const h=Object.keys(Pe)[0];h&&ie(h)}},[Y,ee]);const pe=Ve.useCallback(async()=>{if(f)return;S(!0);const h=p.map(u=>u.url);try{const u=await ke.validateFeeds(h),x=new Map;u.forEach(y=>x.set(y.url,y)),v(x)}catch(u){o.error("Feed validation failed",u)}finally{S(!1)}},[p,f,o]);g.useEffect(()=>{p.length>0&&b==="feeds"&&pe()},[b,pe,p.length]);const ge=async h=>{try{const u=await ke.validateFeed(h);return v(x=>new Map(x.set(h,u))),u}catch{return null}},Re=h=>{W(h),_(h);const u=prompt("Editar URL do feed:",h);u&&u!==h?Ee(h,u):W(null)},Ee=async(h,u)=>{const x=await ge(u);x&&x.status==="valid"?t(y=>y.map(N=>N.url===h?{...N,url:u}:N)):await V("O novo URL no  um feed RSS vlido."),W(null)},fe=async h=>{await q("Tem certeza que deseja remover este feed?")&&t(u=>u.filter(x=>x.url!==h))},I=(h,u)=>{t(x=>x.map(y=>y.url===h?{...y,categoryId:u}:y)),E("Categoria atualizada!")},ce=async()=>{const h=await Ne.generateOPML(p,[],{includeCategories:!1}),u=new Blob([h],{type:"text/xml"}),x=URL.createObjectURL(u),y=document.createElement("a");y.href=x,y.download=`personal_news_feeds_${new Date().toISOString().split("T")[0]}.opml`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(x)},te=async h=>{const u=Pe[ee]||Qe;if(h==="replace")await q("Isso substituir todos os seus feeds atuais. Continuar?")&&(t(u),c(),await E("Feeds substitudos!"),K(!1));else{const x=Ze(p,u),y=x.length-p.length;y===0?await E("Todos os feeds j esto na coleo."):(t(x),await E(`${y} novos feeds adicionados!`)),K(!1)}},se=async()=>{if(await q("Resetar para feeds padro? Isso apagar seus feeds atuais.")){const h=Je();t(h),d(),await E("Feeds resetados com sucesso!")}},ve=async()=>{p.length!==0&&await q(`Excluir TODOS os ${p.length} feeds? Irreversvel.`)&&(t([]),await E("Todos os feeds foram removidos."))},be=async h=>{const u=h.target.files?.[0];if(u){const x=await u.text();try{const y=qe(x),N=[],O=new Set;y.forEach(j=>{if(!p.some(P=>P.url===j.url)){const P={url:j.url,customTitle:j.title};if(j.category){const ye=j.category.toLowerCase().replace(/[^a-z0-9]/g,"-");P.categoryId=ye,n.some(he=>he.id===ye)||O.add(j.category)}N.push(P)}}),O.forEach(j=>i(j,"#6B7280")),N.length>0&&t(j=>[...j,...N]),await E(`${N.length} feeds importados!`)}catch{await V("Falha ao processar arquivo OPML")}}},we=async h=>{try{return await Xe.detectDuplicate(h,p)}catch{return{isDuplicate:!1,confidence:0,reason:"Error"}}},B=async h=>{if(h.preventDefault(),!U.trim()){await V("Insira uma URL vlida.");return}const u=U.trim(),x=await we(u);if(x.isDuplicate){J({show:!0,result:x,newUrl:u});return}H(u)},H=async h=>{R(h),Me(u=>new Set(u.add(h))),Q(u=>new Map(u.set(h,{status:"Validando...",progress:10})));try{const u=await ke.validateFeedWithDiscovery(h,(x,y)=>{Q(N=>new Map(N.set(h,{status:x,progress:y})))});u.isValid?(t(x=>[...x,{url:u.url,customTitle:u.title,categoryId:C||void 0}]),k(""),M(""),await E("Feed adicionado com sucesso!")):u.requiresUserSelection&&u.discoveredFeeds?.length?(Z({originalUrl:h,discoveredFeeds:u.discoveredFeeds}),X(!0),k("")):await Se(`Validao falhou: ${u.error}

Deseja adicionar mesmo assim?`)&&(t(x=>[...x,{url:h,categoryId:C||void 0}]),k(""),await E("Feed adicionado (sem validao)."))}catch(u){await V(`Erro: ${u.message}`)}finally{R(null),Me(u=>{const x=new Set(u);return x.delete(h),x})}},de=()=>{$&&H($.newUrl),J(null)},Ae=()=>{$?.result.duplicateOf&&(t(h=>h.filter(u=>u.url!==$.result.duplicateOf.url)),H($.newUrl),J(null))},ue=(h,u)=>{u&&(De({url:h,validation:u}),xe(!0))},l=[{id:"feeds",label:"Meus Feeds",icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"},{id:"add",label:"Adicionar",icon:"M12 4v16m8-8H4"},{id:"categories",label:m("feeds.tab.categories"),icon:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"},{id:"tools",label:"Ferramentas",icon:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z M15 12a3 3 0 11-6 0 3 3 0 016 0z"},{id:"analytics",label:m("feeds.tab.analytics"),icon:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"}];return e.jsxs("div",{className:"flex flex-col h-full w-full bg-gray-900 overflow-hidden",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-white/10 flex items-center justify-between bg-black/40 shrink-0",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl sm:text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx("span",{className:"p-2 bg-[rgb(var(--color-accent))]/20 rounded-lg text-[rgb(var(--color-accent))]",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 5c7.18 0 13 5.82 13 13M6 11c3.866 0 7 3.134 7 7m-7-7v7"})})}),m("feeds.title")]}),e.jsxs("p",{className:"text-gray-400 text-xs sm:text-sm mt-1 ml-11",children:[p.length," ",m("feeds.stats.monitored")]})]}),e.jsx("button",{onClick:s,className:"p-2 rounded-lg bg-white/5 border border-white/10 text-gray-400 hover:text-white hover:bg-white/15 hover:border-white/20 transition-all duration-200","aria-label":"Close",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex border-b border-white/10 bg-black/10 overflow-x-auto scrollbar-hide shrink-0",children:l.map(h=>e.jsxs("button",{onClick:()=>L(h.id),className:`flex-1 px-4 py-3 sm:py-4 text-sm font-medium transition-colors whitespace-nowrap min-w-[60px] sm:min-w-[100px] flex flex-col sm:flex-row items-center justify-center gap-1 sm:gap-2 ${b===h.id?"text-[rgb(var(--color-accent))] border-b-2 border-[rgb(var(--color-accent))] bg-white/5":"text-gray-400 hover:text-white hover:bg-white/5"}`,title:h.label,children:[e.jsx("svg",{className:"w-5 h-5 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:h.icon})}),e.jsx("span",{className:"text-[10px] sm:text-sm hidden sm:inline",children:h.label})]},h.id))}),e.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[b==="feeds"&&e.jsx(bt,{feeds:p,validations:w,categories:n,onRemove:fe,onRetry:ge,onEdit:Re,onShowError:ue,onMoveCategory:I,onRefreshAll:a}),b==="add"&&e.jsx(wt,{newFeedUrl:U,setNewFeedUrl:k,newFeedCategory:C,setNewFeedCategory:M,categories:n,onSubmit:B,processingUrl:F,discoveryProgress:Te}),b==="categories"&&e.jsx("div",{className:"flex-1 overflow-y-auto p-6 h-full",children:e.jsx(xt,{feeds:p,setFeeds:t,onClose:()=>L("feeds")})}),b==="tools"&&e.jsx(yt,{onExportOPML:ce,onImportOPML:()=>A.current?.click(),onShowImportModal:()=>K(!0),onResetDefaults:se,onCleanupErrors:()=>G(!0),onDeleteAll:ve,feedCount:p.length}),b==="analytics"&&e.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar h-full",children:e.jsx(ft,{feeds:p,articles:r,feedValidations:w})})]}),e.jsx("input",{type:"file",ref:A,accept:".opml,.xml",onChange:be,className:"hidden"}),e.jsx(vt,{isOpen:!!$?.show,onClose:()=>J(null),onReplace:Ae,onAddAnyway:de,existingFeed:$?.result.duplicateOf||null,newFeedUrl:$?.newUrl||"",confidence:$?.result.confidence||0}),ne&&T&&e.jsx(pt,{isOpen:ne,onClose:()=>{X(!1),Z(null)},originalUrl:T.originalUrl,discoveredFeeds:T.discoveredFeeds,onSelectFeed:async h=>{t(u=>[...u,{url:h.url,customTitle:h.title,categoryId:C||void 0}]),X(!1),Z(null),await E("Feed adicionado!")}}),e.jsx(gt,{isOpen:me,onClose:()=>G(!1),feeds:p,onRemoveFeeds:h=>t(u=>u.filter(x=>!h.includes(x.url)))}),Y&&Ce.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[70] p-4",children:e.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-xl p-6 max-w-md w-full",children:[e.jsx("h3",{className:"text-xl font-bold text-white mb-4",children:"Importar Listas Curadas"}),e.jsx("select",{value:ee,onChange:h=>ie(h.target.value),className:"w-full bg-black/30 text-white p-2 rounded mb-4 border border-white/10",children:Object.keys(Pe).map(h=>e.jsx("option",{value:h,children:h},h))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>te("merge"),className:"flex-1 bg-blue-600 text-white py-2 rounded",children:"Mesclar"}),e.jsx("button",{onClick:()=>te("replace"),className:"flex-1 bg-red-600/20 text-red-400 py-2 rounded",children:"Substituir Tudo"})]}),e.jsx("button",{onClick:()=>K(!1),className:"w-full mt-2 text-gray-500 py-2",children:"Cancelar"})]})}),document.body),Fe&&le&&Ce.createPortal(e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] flex flex-col animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-6 border-b border-white/10 flex justify-between",children:[e.jsx("h3",{className:"text-white font-bold",children:"Detalhes do Erro"}),e.jsx("button",{onClick:()=>xe(!1),className:"text-gray-400",children:""})]}),e.jsxs("div",{className:"p-6 overflow-y-auto",children:[e.jsx("p",{className:"text-red-400 font-mono mb-4",children:le.validation.error}),e.jsx("div",{className:"bg-black/30 p-4 rounded text-sm text-gray-300 font-mono break-all",children:le.url})]})]})}),document.body)]})};export{Ft as FeedManager};
