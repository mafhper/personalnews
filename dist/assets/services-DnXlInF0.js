const mo={theme:"dark-blue",layout:"bento",timeFormat:"24h",header:"sticky"},us=[{id:"all",name:"All",color:"#6B7280",order:0,isDefault:!0,isPinned:!0},{order:1,isDefault:!0,name:"Design",id:"design",color:"#F0EEE9",layoutMode:"gallery",headerPosition:"sticky",isPinned:!1,description:"Inspiração visual, UX/UI e tendências de design."},{order:2,isDefault:!0,name:"Games",id:"games",color:"#F59E0B",layoutMode:"masonry",headerPosition:"sticky",isPinned:!1,description:"Lançamentos, reviews e cultura gamer."},{order:3,isDefault:!0,name:"Tecnologia",id:"tech",color:"#3B82F6",layoutMode:"modern",headerPosition:"sticky",isPinned:!1,description:"Notícias sobre desenvolvimento, gadgets e o mundo tech."},{order:4,isDefault:!0,name:"Política",id:"politics",color:"#EF4444",layoutMode:"list",headerPosition:"sticky",isPinned:!1,description:"Cobertura política nacional e internacional."},{order:5,isDefault:!0,name:"Vídeos",id:"youtube",color:"#C4302B",layoutMode:"brutalist",headerPosition:"sticky",isPinned:!1,description:"Canais preferidos do Youtube."}],ms=[{url:"https://www.b9.com.br/feed/",categoryId:"design",customTitle:"B9"},{url:"https://css-tricks.com/feed/",categoryId:"design",customTitle:"CSS-Tricks"},{url:"https://www.dezeen.com/feed/",categoryId:"design",customTitle:"Dezeen"},{url:"https://uxdesign.cc/feed",categoryId:"design",customTitle:"UX Collective"},{url:"https://adrenaline.com.br/feed/",categoryId:"games",customTitle:"Adrenaline"},{url:"https://naogames.jogabilida.de/",categoryId:"games",customTitle:"Jogabilidade (Não Games)"},{url:"https://kotaku.com/rss",categoryId:"games",customTitle:"Kotaku"},{url:"https://www.polygon.com/feed/",categoryId:"games",customTitle:"Polygon.com"},{url:"https://g1.globo.com/rss/g1/politica/",categoryId:"politics",customTitle:"G1 Política"},{url:"https://midianinja.org/feed/",categoryId:"politics",customTitle:"Mídia Ninja"},{url:"https://piaui.folha.uol.com.br/feed/",categoryId:"politics",customTitle:"Piauí"},{url:"https://theintercept.com/brasil/feed/",categoryId:"politics",customTitle:"The Intercept Brasil"},{url:"https://9to5google.com/feed/",categoryId:"tech",customTitle:"9to5Google",hideFromAll:!0},{url:"https://9to5linux.com/feed/",categoryId:"tech",customTitle:"9to5Linux"},{url:"https://9to5mac.com/feed/",categoryId:"tech",customTitle:"9to5Mac"},{url:"https://arstechnica.com/feed/",categoryId:"tech",customTitle:"Ars Technica"},{url:"http://www.cnet.com/rss/news/",categoryId:"tech",customTitle:"CNET"},{url:"https://diolinux.com.br/feed",categoryId:"tech",customTitle:"Diolinux"},{url:"https://macmagazine.com.br/feed/",categoryId:"tech",customTitle:"MacMagazine"},{url:"https://meiobit.com/feed/",categoryId:"tech",customTitle:"Meio Bit"},{url:"https://tecnoblog.net/feed/",categoryId:"tech",customTitle:"Tecnoblog"},{url:"https://thenextweb.com/feed",categoryId:"tech",customTitle:"The Next Web"},{url:"https://www.theverge.com/rss/index.xml",categoryId:"tech",customTitle:"The Verge"},{url:"https://www.tomsguide.com/feeds.xml",categoryId:"tech",customTitle:"Tom's Guide"},{url:"https://www.xda-developers.com/feed/",categoryId:"tech",customTitle:"XDA"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCG-KRRI41P4TsaOMeAM9dug",categoryId:"youtube",customTitle:"1155 do ET",hideFromAll:!0},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCSpFnDQr88xCZ80N-X7t0nQ",categoryId:"youtube",customTitle:"Corridor Crew",hideFromAll:!0},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UC7yRILFFJ2QZCykymr8LPwA",categoryId:"youtube",customTitle:"News Rockstar",hideFromAll:!0},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCqBY-VQ2BxHOWnVpuC7swrw",categoryId:"youtube",customTitle:"NORMOSE",hideFromAll:!0},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCEf5U1dB5a2e2S-XUlnhxSA",categoryId:"youtube",customTitle:"Diolinux",hideFromAll:!0}],ds={"Brasil Mix":[{url:"https://www.b9.com.br/feed/",categoryId:"design",customTitle:"B9"},{url:"https://adrenaline.com.br/feed/",categoryId:"games",customTitle:"Adrenaline"},{url:"https://br.ign.com/feed.xml",categoryId:"games",customTitle:"IGN Brasil"},{url:"https://naogames.jogabilida.de/",categoryId:"games",customTitle:"Jogabilidade (Não Games)"},{url:"https://g1.globo.com/rss/g1/politica/",categoryId:"politics",customTitle:"G1 Política"},{url:"https://midianinja.org/feed/",categoryId:"politics",customTitle:"Mídia Ninja"},{url:"https://piaui.folha.uol.com.br/feed/",categoryId:"politics",customTitle:"Piauí"},{url:"https://theintercept.com/brasil/feed/",categoryId:"politics",customTitle:"The Intercept Brasil"},{url:"https://diolinux.com.br/feed",categoryId:"tech",customTitle:"Diolinux"},{url:"https://macmagazine.com.br/feed/",categoryId:"tech",customTitle:"MacMagazine"},{url:"https://meiobit.com/feed/",categoryId:"tech",customTitle:"Meio Bit"},{url:"https://tecnoblog.net/feed/",categoryId:"tech",customTitle:"Tecnoblog"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCG-KRRI41P4TsaOMeAM9dug",categoryId:"youtube",customTitle:"1155 do ET"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCqBY-VQ2BxHOWnVpuC7swrw",categoryId:"youtube",customTitle:"NORMOSE"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCEf5U1dB5a2e2S-XUlnhxSA",categoryId:"youtube",customTitle:"Diolinux"}],"International Mix":[{url:"https://css-tricks.com/feed/",categoryId:"design",customTitle:"CSS-Tricks"},{url:"https://www.dezeen.com/feed/",categoryId:"design",customTitle:"Dezeen"},{url:"https://uxdesign.cc/feed",categoryId:"design",customTitle:"UX Collective"},{url:"https://kotaku.com/rss",categoryId:"games",customTitle:"Kotaku"},{url:"https://www.polygon.com/feed/",categoryId:"games",customTitle:"Polygon.com"},{url:"https://9to5google.com/feed/",categoryId:"tech",customTitle:"9to5Google"},{url:"https://9to5linux.com/feed/",categoryId:"tech",customTitle:"9to5Linux"},{url:"https://9to5mac.com/feed/",categoryId:"tech",customTitle:"9to5Mac"},{url:"https://arstechnica.com/feed/",categoryId:"tech",customTitle:"Ars Technica"},{url:"http://www.cnet.com/rss/news/",categoryId:"tech",customTitle:"CNET"},{url:"https://www.digitaltrends.com/feed/",categoryId:"tech",customTitle:"Digital Trends"},{url:"https://electrek.co/feed/",categoryId:"tech",customTitle:"ElecTrek"},{url:"https://www.engadget.com/rss.xml",categoryId:"tech",customTitle:"Engadget"},{url:"https://www.omglinux.com/feed/",categoryId:"tech",customTitle:"OMG! Linux"},{url:"https://www.omgubuntu.co.uk/feed",categoryId:"tech",customTitle:"OMG! Ubuntu"},{url:"https://thenextweb.com/feed",categoryId:"tech",customTitle:"The Next Web"},{url:"https://www.theverge.com/rss/index.xml",categoryId:"tech",customTitle:"The Verge"},{url:"https://www.tomsguide.com/feeds.xml",categoryId:"tech",customTitle:"Tom's Guide"},{url:"https://www.wired.com/feed/tag/ai/latest/rss",categoryId:"tech",customTitle:"WIRED AI"},{url:"https://www.wired.com/feed/tag/wired-guide/latest/rss",categoryId:"tech",customTitle:"WIRED Guides"},{url:"https://www.wired.com/feed/category/ideas/latest/rss",categoryId:"tech",customTitle:"WIRED Ideas"},{url:"https://www.xda-developers.com/feed/",categoryId:"tech",customTitle:"XDA"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCMPGiQ8gwDXFYpwQhX6kK9A",categoryId:"youtube",customTitle:"bizlychannel"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCSpFnDQr88xCZ80N-X7t0nQ",categoryId:"youtube",customTitle:"Corridor Crew"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UC6mIxFTvXkWQVEHPsEdflzQ",categoryId:"youtube",customTitle:"GreatScott!"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UC7yRILFFJ2QZCykymr8LPwA",categoryId:"youtube",customTitle:"News Rockstar"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCj1VqrHhDte54oLgPG4xpuQ",categoryId:"youtube",customTitle:"Stuff Made Here"}],"Pacote Mix Global":[{url:"https://www.b9.com.br/feed/",categoryId:"design",customTitle:"B9"},{url:"https://css-tricks.com/feed/",categoryId:"design",customTitle:"CSS-Tricks"},{url:"https://www.dezeen.com/feed/",categoryId:"design",customTitle:"Dezeen"},{url:"https://uxdesign.cc/feed",categoryId:"design",customTitle:"UX Collective"},{url:"https://adrenaline.com.br/feed/",categoryId:"games",customTitle:"Adrenaline"},{url:"https://br.ign.com/feed.xml",categoryId:"games",customTitle:"IGN Brasil"},{url:"https://naogames.jogabilida.de/",categoryId:"games",customTitle:"Jogabilidade (Não Games)"},{url:"https://kotaku.com/rss",categoryId:"games",customTitle:"Kotaku"},{url:"https://www.polygon.com/feed/",categoryId:"games",customTitle:"Polygon.com"},{url:"https://g1.globo.com/rss/g1/politica/",categoryId:"politics",customTitle:"G1 Política"},{url:"https://midianinja.org/feed/",categoryId:"politics",customTitle:"Mídia Ninja"},{url:"https://piaui.folha.uol.com.br/feed/",categoryId:"politics",customTitle:"Piauí"},{url:"https://theintercept.com/brasil/feed/",categoryId:"politics",customTitle:"The Intercept Brasil"},{url:"https://9to5google.com/feed/",categoryId:"tech",customTitle:"9to5Google"},{url:"https://9to5linux.com/feed/",categoryId:"tech",customTitle:"9to5Linux"},{url:"https://9to5mac.com/feed/",categoryId:"tech",customTitle:"9to5Mac"},{url:"https://arstechnica.com/feed/",categoryId:"tech",customTitle:"Ars Technica"},{url:"http://www.cnet.com/rss/news/",categoryId:"tech",customTitle:"CNET"},{url:"https://www.digitaltrends.com/feed/",categoryId:"tech",customTitle:"Digital Trends"},{url:"https://diolinux.com.br/feed",categoryId:"tech",customTitle:"Diolinux"},{url:"https://electrek.co/feed/",categoryId:"tech",customTitle:"ElecTrek"},{url:"https://www.engadget.com/rss.xml",categoryId:"tech",customTitle:"Engadget"},{url:"https://macmagazine.com.br/feed/",categoryId:"tech",customTitle:"MacMagazine"},{url:"https://meiobit.com/feed/",categoryId:"tech",customTitle:"Meio Bit"},{url:"https://www.omglinux.com/feed/",categoryId:"tech",customTitle:"OMG! Linux"},{url:"https://www.omgubuntu.co.uk/feed",categoryId:"tech",customTitle:"OMG! Ubuntu"},{url:"https://tecnoblog.net/feed/",categoryId:"tech",customTitle:"Tecnoblog"},{url:"https://thenextweb.com/feed",categoryId:"tech",customTitle:"The Next Web"},{url:"https://www.theverge.com/rss/index.xml",categoryId:"tech",customTitle:"The Verge"},{url:"https://www.tomsguide.com/feeds.xml",categoryId:"tech",customTitle:"Tom's Guide"},{url:"https://www.wired.com/feed/tag/ai/latest/rss",categoryId:"tech",customTitle:"WIRED AI"},{url:"https://www.wired.com/feed/tag/wired-guide/latest/rss",categoryId:"tech",customTitle:"WIRED Guides"},{url:"https://www.wired.com/feed/category/ideas/latest/rss",categoryId:"tech",customTitle:"WIRED Ideas"},{url:"https://www.xda-developers.com/feed/",categoryId:"tech",customTitle:"XDA"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCG-KRRI41P4TsaOMeAM9dug",categoryId:"youtube",customTitle:"1155 do ET"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCMPGiQ8gwDXFYpwQhX6kK9A",categoryId:"youtube",customTitle:"bizlychannel"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCSpFnDQr88xCZ80N-X7t0nQ",categoryId:"youtube",customTitle:"Corridor Crew"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCEf5U1dB5a2e2S-XUlnhxSA",categoryId:"youtube",customTitle:"Diolinux"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UC6mIxFTvXkWQVEHPsEdflzQ",categoryId:"youtube",customTitle:"GreatScott!"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UC7yRILFFJ2QZCykymr8LPwA",categoryId:"youtube",customTitle:"News Rockstar"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCqBY-VQ2BxHOWnVpuC7swrw",categoryId:"youtube",customTitle:"NORMOSE"},{url:"https://www.youtube.com/feeds/videos.xml?channel_id=UCj1VqrHhDte54oLgPG4xpuQ",categoryId:"youtube",customTitle:"Stuff Made Here"}]},g=r=>{const e=r.replace("#","");if(!/^[a-fA-F0-9]{3}$|^[a-fA-F0-9]{6}$/.test(e))throw new Error(`Invalid hex color format: ${r}. Expected format: #RRGGBB or #RGB`);let t,o,n;if(e.length===3?(t=parseInt(e[0]+e[0],16),o=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16)):(t=parseInt(e.substring(0,2),16),o=parseInt(e.substring(2,4),16),n=parseInt(e.substring(4,6),16)),isNaN(t)||isNaN(o)||isNaN(n)||t<0||t>255||o<0||o>255||n<0||n>255)throw new Error(`Invalid hex color conversion result: ${r} -> ${t} ${o} ${n}`);return`${t} ${o} ${n}`},Ge=[{id:"dark-blue",name:"Azul Escuro",description:"Tema escuro com tons de azul e contraste otimizado",category:"dark",theme:{id:"dark-blue",name:"Azul Escuro",colors:{primary:"18 102 204",secondary:g("#1E1E1E"),accent:"138 101 8",background:g("#121212"),surface:g("#1E1E1E"),text:g("#FFFFFF"),textSecondary:g("#B0B0B0"),border:"75 85 99",success:"16 185 129",warning:"245 158 11",error:"239 68 68"},layout:"comfortable",density:"medium",borderRadius:"medium",shadows:!0,animations:!0}},{id:"dark-green",name:"Verde Escuro",description:"Tema escuro com tons de verde natural",category:"dark",theme:{id:"dark-green",name:"Verde Escuro",colors:{primary:"52 125 54",secondary:g("#1B1F1D"),accent:"122 105 17",background:g("#0D0D0D"),surface:g("#1B1F1D"),text:g("#F1F1F1"),textSecondary:g("#A8A8A8"),border:"75 85 99",success:"16 185 129",warning:"245 158 11",error:"239 68 68"},layout:"comfortable",density:"medium",borderRadius:"medium",shadows:!0,animations:!0}},{id:"dark-purple",name:"Roxo Escuro",description:"Tema escuro com tons de roxo e rosa",category:"dark",theme:{id:"dark-purple",name:"Roxo Escuro",colors:{primary:"173 46 207",secondary:g("#1A1A23"),accent:"204 51 102",background:g("#101014"),surface:g("#1A1A23"),text:g("#E0E0E0"),textSecondary:g("#9C9C9C"),border:"75 85 99",success:"16 185 129",warning:"245 158 11",error:"239 68 68"},layout:"comfortable",density:"medium",borderRadius:"medium",shadows:!0,animations:!0}},{id:"light-blue",name:"Azul Claro",description:"Tema claro com tons de azul e alto contraste",category:"light",theme:{id:"light-blue",name:"Azul Claro",colors:{primary:g("#1976D2"),secondary:g("#F5F5F5"),accent:"184 61 23",background:g("#FFFFFF"),surface:g("#F5F5F5"),text:g("#212121"),textSecondary:g("#616161"),border:"156 163 175",success:"16 185 129",warning:"245 158 11",error:"239 68 68"},layout:"comfortable",density:"medium",borderRadius:"medium",shadows:!0,animations:!0}},{id:"light-pink",name:"Rosa Claro",description:"Tema claro com tons de rosa e lilás",category:"light",theme:{id:"light-pink",name:"Rosa Claro",colors:{primary:"178 48 92",secondary:g("#FFFFFF"),accent:g("#7E57C2"),background:g("#FFF8F0"),surface:g("#FFFFFF"),text:g("#212121"),textSecondary:"97 97 97",border:"156 163 175",success:"16 185 129",warning:"245 158 11",error:"239 68 68"},layout:"comfortable",density:"medium",borderRadius:"medium",shadows:!0,animations:!0}},{id:"light-cyan",name:"Ciano Claro",description:"Tema claro minimalista com tons frios",category:"light",theme:{id:"light-cyan",name:"Ciano Claro",colors:{primary:"0 129 145",secondary:g("#FFFFFF"),accent:"184 81 49",background:g("#F0F4F8"),surface:g("#FFFFFF"),text:g("#1C1C1C"),textSecondary:g("#5E5E5E"),border:"156 163 175",success:"16 185 129",warning:"245 158 11",error:"239 68 68"},layout:"comfortable",density:"medium",borderRadius:"medium",shadows:!0,animations:!0}}],hs={currentTheme:Ge.find(r=>r.id===mo.theme)?.theme||Ge[0].theme,customThemes:[],autoDetectSystemTheme:!0,systemThemeOverride:null,themeTransitions:!0},ho=r=>{const e=["id","name","colors","layout","density","borderRadius"],t=["primary","secondary","accent","background","surface","text","textSecondary","border","success","warning","error"];for(const o of e)if(!(o in r))return console.warn(`Theme validation failed: missing field "${o}"`),!1;if(r.colors){for(const o of t)if(!(o in r.colors))return console.warn(`Theme validation failed: missing color "${o}"`),!1}if(r.colors){for(const[o,n]of Object.entries(r.colors))if(!fo(n))return console.warn(`Theme validation failed: invalid RGB format for color "${o}": "${n}"`),!1}return!0},fo=r=>/^\d{1,3}\s+\d{1,3}\s+\d{1,3}$/.test(r)?r.split(/\s+/).map(Number).every(o=>o>=0&&o<=255):!1,fs=(r,e="1.0")=>{try{if(typeof r=="string")return Pt(r,"Migrated Theme");if(ho(r))return r;if(r.colors?.accent||r.accent){const t=r.colors?.accent||r.accent;return Pt(t,r.name||"Migrated Theme")}return null}catch(t){return console.error("Theme migration failed:",t),null}},Pt=(r,e)=>{const t=r.split(/\s+/).map(Number),[o,n,i]=t,a=o*.299+n*.587+i*.114<128;return{id:`custom-${Date.now()}`,name:e,colors:{primary:r,secondary:a?"45 55 72":"229 231 235",accent:r,background:a?"26 32 44":"255 255 255",surface:a?"45 55 72":"249 250 251",text:a?"247 250 252":"17 24 39",textSecondary:a?"160 174 192":"107 114 128",border:a?"75 85 99":"209 213 219",success:"16 185 129",warning:"245 158 11",error:"239 68 68"},layout:"comfortable",density:"medium",borderRadius:"medium",shadows:!0,animations:!0}},ps=r=>{const e=document.documentElement;Object.entries(r.colors).forEach(([u,h])=>{e.style.setProperty(`--color-${u}`,h)});const o={compact:{padding:"0.5rem",gap:"0.5rem"},comfortable:{padding:"1rem",gap:"1rem"},spacious:{padding:"1.5rem",gap:"1.5rem"}}[r.layout];e.style.setProperty("--layout-padding",o.padding),e.style.setProperty("--layout-gap",o.gap);const i={low:{fontSize:"0.875rem",lineHeight:"1.25rem"},medium:{fontSize:"1rem",lineHeight:"1.5rem"},high:{fontSize:"1.125rem",lineHeight:"1.75rem"}}[r.density];e.style.setProperty("--density-font-size",i.fontSize),e.style.setProperty("--density-line-height",i.lineHeight);const a={none:"0",small:"0.25rem",medium:"0.5rem",large:"1rem"};e.style.setProperty("--border-radius",a[r.borderRadius]),e.style.setProperty("--shadows-enabled",r.shadows?"1":"0"),e.style.setProperty("--animations-enabled",r.animations?"1":"0"),e.style.setProperty("--transition-duration",r.animations?"0.2s":"0s")},gs=()=>typeof window<"u"&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":"dark",ys=r=>{const e=Ge.filter(t=>t.category===r||r==="dark"&&t.category==="colorful");return e.length>0?e[0].theme:Ge[0].theme};class po{constructor(){this.logs=[],this.maxLogs=100,this.listeners=[],this.originalConsole={log:console.log,warn:console.warn,error:console.error,info:console.info,debug:console.debug},this.init()}init(){console.log=(...e)=>{this.addLog("log",e),this.originalConsole.log(...e)},console.info=(...e)=>{this.addLog("info",e),this.originalConsole.info(...e)},console.warn=(...e)=>{this.addLog("warn",e),this.originalConsole.warn(...e)},console.error=(...e)=>{this.addLog("error",e),this.originalConsole.error(...e)}}addLog(e,t){const o=t.map(i=>typeof i=="object"?JSON.stringify(i,null,2):String(i)).join(" "),n={id:Math.random().toString(36).substr(2,9),timestamp:Date.now(),type:e,message:o,data:t};this.logs=[n,...this.logs].slice(0,this.maxLogs),this.notifyListeners()}getLogs(){return this.logs}clearLogs(){this.logs=[],this.notifyListeners()}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}log(...e){this.addLog("log",e),this.originalConsole.log(...e)}info(...e){this.addLog("info",e),this.originalConsole.info(...e)}warn(...e){this.addLog("warn",e),this.originalConsole.warn(...e)}error(...e){this.addLog("error",e),this.originalConsole.error(...e)}debug(...e){this.addLog("debug",e),this.originalConsole.debug?this.originalConsole.debug(...e):this.originalConsole.log("[DEBUG]",...e)}notifyListeners(){this.listeners.forEach(e=>e(this.logs))}}const M=new po,go=()=>M,Ts=r=>M,$t=600*1e3,jt=100,Yt=7200*1e3,it="smart-feed-cache";class yo{constructor(e={}){this.cache=new Map,this.stats={hits:0,misses:0,sets:0,evictions:0},this.options={ttl:e.ttl||$t,maxEntries:e.maxEntries||jt,enablePersistence:e.enablePersistence!==!1,enableStaleWhileRevalidate:e.enableStaleWhileRevalidate||Yt},this.options.enablePersistence&&this.loadFromStorage(),this.setupPeriodicCleanup()}get(e){const t=this.cache.get(e);if(!t)return this.stats.misses++,null;const o=Date.now(),n=o-t.timestamp;return t.accessCount++,t.lastAccessed=o,n<=this.options.ttl?(this.stats.hits++,M.debug("Cache hit for feed (fresh)",{component:"SmartCache",additionalData:{feedUrl:e,age:Math.round(n/1e3),ttl:Math.round(this.options.ttl/1e3),articlesCount:t.articles.length}}),t.articles):n<=this.options.enableStaleWhileRevalidate?(this.stats.hits++,M.debug("Cache hit for feed (stale)",{component:"SmartCache",additionalData:{feedUrl:e,age:Math.round(n/1e3),staleLimit:Math.round(this.options.enableStaleWhileRevalidate/1e3),articlesCount:t.articles.length}}),t.articles):(this.cache.delete(e),this.stats.misses++,M.debug("Cache expired for feed",{component:"SmartCache",additionalData:{feedUrl:e,age:Math.round(n/1e3),staleLimit:Math.round(this.options.enableStaleWhileRevalidate/1e3)}}),null)}getStaleWhileRevalidate(e){const t=this.cache.get(e);if(!t)return null;const o=Date.now(),n=o-t.timestamp;return n<=this.options.enableStaleWhileRevalidate?(t.lastAccessed=o,M.debug("Serving stale content while revalidating",{component:"SmartCache",additionalData:{feedUrl:e,age:Math.round(n/1e3),articlesCount:t.articles.length}}),t.articles):null}isFresh(e){const t=this.cache.get(e);return t?Date.now()-t.timestamp<=this.options.ttl:!1}isStale(e){const t=this.cache.get(e);if(!t)return!1;const o=Date.now()-t.timestamp;return o>this.options.ttl&&o<=this.options.enableStaleWhileRevalidate}set(e,t,o,n){const i=Date.now(),a={articles:t.map(u=>({...u,pubDate:new Date(u.pubDate)})),timestamp:i,feedUrl:e,title:o,etag:n?.get("etag")||void 0,lastModified:n?.get("last-modified")||void 0,accessCount:1,lastAccessed:i};this.cache.size>=this.options.maxEntries&&this.evictLeastRecentlyUsed(),this.cache.set(e,a),this.stats.sets++,M.debug("Cached articles for feed",{component:"SmartCache",additionalData:{feedUrl:e,articlesCount:t.length,title:o,hasEtag:!!a.etag,hasLastModified:!!a.lastModified,cacheSize:this.cache.size}}),this.options.enablePersistence&&this.persistToStorage()}delete(e){const t=this.cache.delete(e);return t&&(M.debug("Removed cache entry for feed",{component:"SmartCache",additionalData:{feedUrl:e}}),this.options.enablePersistence&&this.persistToStorage()),t}clear(){const e=this.cache.size;this.cache.clear(),M.info("Cleared all cache entries",{component:"SmartCache",additionalData:{clearedEntries:e}}),this.options.enablePersistence&&this.persistToStorage()}getStats(){const e=Array.from(this.cache.values()),t=e.reduce((i,a)=>i+a.articles.length,0),o=e.map(i=>i.timestamp),n=this.stats.hits+this.stats.misses>0?this.stats.hits/(this.stats.hits+this.stats.misses):0;return{totalEntries:this.cache.size,totalArticles:t,cacheSize:this.estimateCacheSize(),hitRate:n,oldestEntry:o.length>0?Math.min(...o):0,newestEntry:o.length>0?Math.max(...o):0}}getKeys(){return Array.from(this.cache.keys())}has(e){return this.cache.has(e)}getMetadata(e){const t=this.cache.get(e);if(!t)return null;const{articles:o,...n}=t;return n}cleanup(){const e=Date.now(),t=[];for(const[o,n]of this.cache.entries())e-n.timestamp>this.options.enableStaleWhileRevalidate&&t.push(o);return t.forEach(o=>this.cache.delete(o)),t.length>0&&(M.info("Cleaned up expired cache entries",{component:"SmartCache",additionalData:{expiredCount:t.length,remainingCount:this.cache.size}}),this.options.enablePersistence&&this.persistToStorage()),t.length}evictLeastRecentlyUsed(){let e=null,t=Date.now();for(const[o,n]of this.cache.entries())n.lastAccessed<t&&(t=n.lastAccessed,e=o);e&&(this.cache.delete(e),this.stats.evictions++,M.debug("Evicted LRU cache entry",{component:"SmartCache",additionalData:{evictedKey:e,lastAccessed:new Date(t).toISOString()}}))}estimateCacheSize(){let e=0;for(const t of this.cache.values())e+=JSON.stringify(t).length*2;return e}loadFromStorage(){try{const e=localStorage.getItem(it);if(!e)return;const t=JSON.parse(e),o=Date.now();for(const[n,i]of t.entries||[]){const a={...i,articles:i.articles.map(h=>({...h,pubDate:new Date(h.pubDate)}))};o-a.timestamp<=this.options.enableStaleWhileRevalidate&&this.cache.set(n,a)}M.info("Loaded cache from storage",{component:"SmartCache",additionalData:{loadedEntries:this.cache.size,totalStored:t.entries?.length||0}})}catch(e){M.error("Failed to load cache from storage",e,{component:"SmartCache"}),localStorage.removeItem(it)}}persistToStorage(){try{const e=Array.from(this.cache.entries()).map(([o,n])=>[o,{...n,articles:n.articles.map(i=>({...i,pubDate:i.pubDate.toISOString()}))}]),t={entries:e,timestamp:Date.now(),version:"1.0.0"};localStorage.setItem(it,JSON.stringify(t)),M.debug("Persisted cache to storage",{component:"SmartCache",additionalData:{entriesCount:e.length,estimatedSize:JSON.stringify(t).length}})}catch(e){M.error("Failed to persist cache to storage",e,{component:"SmartCache",additionalData:{cacheSize:this.cache.size,estimatedSize:this.estimateCacheSize()}})}}setupPeriodicCleanup(){setInterval(()=>{this.cleanup()},300*1e3)}}const gt=new yo({ttl:$t,maxEntries:jt,enablePersistence:!0,enableStaleWhileRevalidate:Yt}),To=r=>gt.get(r),wo=(r,e,t,o)=>{gt.set(r,e,t,o)},ws=r=>gt.isFresh(r),Vt={maxXmlSize:10*1024*1024,allowedRootElements:["rss","feed","rdf:rdf","rdf"],blockedPatterns:[/<!ENTITY[^>]*SYSTEM/i,/<!ENTITY[^>]*PUBLIC/i,/javascript:/gi,/vbscript:/gi]};function Eo(r,e){if(r.length>e.maxXmlSize)throw new Error(`XML size exceeds security limit of ${e.maxXmlSize} bytes`);for(const t of e.blockedPatterns)if(t.test(r))throw new Error("Potentially malicious XML content detected: blocked pattern found")}function bo(r,e){const t=r.documentElement;if(!t)throw new Error("No valid XML root element found");const o=t.tagName.toLowerCase();if(!e.allowedRootElements.some(i=>o===i.toLowerCase()))throw new Error(`Root element '${o}' is not in allowed list: ${e.allowedRootElements.join(", ")}`);const n=Array.from(r.childNodes).filter(i=>i.nodeType===Node.ELEMENT_NODE);if(n.length>1)throw new Error(`XML contains ${n.length} root nodes, but only 1 is allowed`)}function So(r,e=Vt){try{if(!r||typeof r!="string")throw new Error("Invalid XML input: must be a non-empty string");const t=r.trim();if(!t)throw new Error("Invalid XML input: must be a non-empty string");Eo(t,e);const n=new DOMParser().parseFromString(t,"application/xml"),i=n.querySelector("parsererror");if(i)throw new Error(`XML parsing error: ${i.textContent}`);return bo(n,e),n}catch(t){throw console.error("Secure XML parsing error:",t),new Error(`Failed to parse XML securely: ${t instanceof Error?t.message:"Unknown error"}`)}}function Ao(r){const e={...Vt,allowedRootElements:["rss","feed","rdf:rdf","rdf"]};return So(r,e)}class xo{constructor(e){this.PROXY_CONFIGS=[{url:"https://api.rss2json.com/v1/api.json?rss_url=",name:"RSS2JSON",responseTransform:t=>t,priority:0,enabled:!0,timeout:5e3},{url:"https://api.allorigins.win/get?url=",name:"AllOrigins",responseTransform:t=>{try{return JSON.parse(t).contents||t}catch{return t}},headers:{Accept:"application/json"},timeout:1e4,priority:1,enabled:!0},{url:"https://corsproxy.io/?",name:"CorsProxy.io",headers:{Accept:"application/rss+xml, application/atom+xml, application/xml, text/xml","User-Agent":"Personal News Dashboard/1.0"},timeout:8e3,priority:2,enabled:!0},{url:"https://cors-anywhere.herokuapp.com/",name:"CORS Anywhere",headers:{Accept:"application/rss+xml, application/atom+xml, application/xml, text/xml","User-Agent":"Personal News Dashboard/1.0","X-Requested-With":"XMLHttpRequest"},timeout:12e3,priority:3,enabled:!0},{url:"https://api.codetabs.com/v1/proxy?quest=",name:"CodeTabs",responseTransform:t=>{try{const o=JSON.parse(t);return o.data?o.data:t}catch{return t}},timeout:15e3,priority:4,enabled:!0}],this.proxyStats=new Map,this.proxyHealthCheck=new Map,this.config={maxRetries:3,healthCheckInterval:300*1e3,failureThreshold:3,recoveryThreshold:2,defaultTimeout:1e4,...e},this.initializeProxyStats(),this.startHealthMonitoring()}getAvailableProxies(){return this.PROXY_CONFIGS.filter(e=>e.enabled&&this.isProxyHealthy(e.name)).sort((e,t)=>{const o=this.proxyStats.get(e.name),n=this.proxyStats.get(t.name),i=o?.healthScore||0,a=n?.healthScore||0;return Math.abs(i-a)>.1?a-i:e.priority-t.priority})}async tryProxy(e,t){const o=Date.now();try{const n=this.buildProxyUrl(e,t),i=e.timeout||this.config.defaultTimeout,a=new AbortController,u=setTimeout(()=>a.abort(),i),h=await fetch(n,{method:"GET",signal:a.signal,headers:e.headers||{}});clearTimeout(u);const d=Date.now()-o;if(!h.ok)throw new Error(`HTTP ${h.status}: ${h.statusText}`);let y=await h.text();return e.responseTransform&&(y=e.responseTransform(y)),this.recordProxyAttempt({proxyName:e.name,proxyUrl:n,targetUrl:t,timestamp:o,success:!0,responseTime:d,statusCode:h.status}),y}catch(n){const i=Date.now()-o;throw this.recordProxyAttempt({proxyName:e.name,proxyUrl:this.buildProxyUrl(e,t),targetUrl:t,timestamp:o,success:!1,responseTime:i,error:n.message}),n}}async tryProxiesWithFailover(e){const t=this.getAvailableProxies(),o=[];if(t.length===0)throw new Error("No healthy proxies available");let n=null;for(const i of t){const a=Date.now();try{const u=await this.tryProxy(i,e),h={proxyName:i.name,proxyUrl:this.buildProxyUrl(i,e),targetUrl:e,timestamp:a,success:!0,responseTime:Date.now()-a};return o.push(h),{content:u,proxyUsed:i.name,attempts:o}}catch(u){n=u;const h={proxyName:i.name,proxyUrl:this.buildProxyUrl(i,e),targetUrl:e,timestamp:a,success:!1,responseTime:Date.now()-a,error:u.message};o.push(h),this.markProxyStatus(i.name,!1);continue}}throw new Error(`All proxies failed. Last error: ${n?.message||"Unknown error"}`)}markProxyStatus(e,t){const o=this.proxyStats.get(e);o&&(t?(o.consecutiveFailures=0,o.lastSuccess=Date.now()):(o.consecutiveFailures++,o.lastFailure=Date.now()),this.proxyHealthCheck.set(e,o.consecutiveFailures<this.config.failureThreshold),this.updateHealthScore(e))}getProxyStats(){return new Map(this.proxyStats)}getProxyStatsByName(e){return this.proxyStats.get(e)}getOverallStats(){const e=Array.from(this.proxyStats.values());return{totalProxies:this.PROXY_CONFIGS.length,healthyProxies:Array.from(this.proxyHealthCheck.values()).filter(Boolean).length,totalRequests:e.reduce((t,o)=>t+o.totalRequests,0),totalSuccesses:e.reduce((t,o)=>t+o.success,0),totalFailures:e.reduce((t,o)=>t+o.failures,0),averageResponseTime:e.length>0?e.reduce((t,o)=>t+o.avgResponseTime,0)/e.length:0}}resetStats(){this.initializeProxyStats()}disableProxy(e){const t=this.PROXY_CONFIGS.find(o=>o.name===e);t&&(t.enabled=!1,this.proxyHealthCheck.set(e,!1))}enableProxy(e){const t=this.PROXY_CONFIGS.find(o=>o.name===e);if(t){t.enabled=!0;const o=this.proxyStats.get(e);o&&(o.consecutiveFailures=0),this.proxyHealthCheck.set(e,!0)}}getConfiguration(){return{...this.config}}destroy(){this.healthCheckTimer&&(clearInterval(this.healthCheckTimer),this.healthCheckTimer=void 0)}initializeProxyStats(){this.PROXY_CONFIGS.forEach(e=>{this.proxyStats.set(e.name,{success:0,failures:0,totalRequests:0,avgResponseTime:0,lastUsed:0,lastSuccess:0,lastFailure:0,consecutiveFailures:0,healthScore:1}),this.proxyHealthCheck.set(e.name,!0)})}buildProxyUrl(e,t){return e.url+encodeURIComponent(t)}isProxyHealthy(e){return this.proxyHealthCheck.get(e)||!1}recordProxyAttempt(e){const t=this.proxyStats.get(e.proxyName);if(!t)return;t.totalRequests++,t.lastUsed=e.timestamp,e.success?(t.success++,t.lastSuccess=e.timestamp,t.consecutiveFailures=0):(t.failures++,t.lastFailure=e.timestamp,t.consecutiveFailures++);const o=t.avgResponseTime*(t.totalRequests-1)+e.responseTime;t.avgResponseTime=o/t.totalRequests,this.updateHealthScore(e.proxyName)}updateHealthScore(e){const t=this.proxyStats.get(e);if(!t)return;let o=1;if(t.totalRequests>0){const n=t.success/t.totalRequests;o*=n}if(t.consecutiveFailures>=this.config.failureThreshold)o*=.1;else{const n=t.consecutiveFailures/this.config.failureThreshold;o*=1-.4*n}if(t.avgResponseTime>5e3){const n=Math.min((t.avgResponseTime-5e3)/1e4,1);o*=1-.1*n}t.healthScore=Math.max(0,Math.min(1,o))}startHealthMonitoring(){this.healthCheckTimer=setInterval(()=>{this.performHealthCheck()},this.config.healthCheckInterval)}performHealthCheck(){this.PROXY_CONFIGS.forEach(e=>{if(!e.enabled)return;const t=this.proxyStats.get(e.name);if(!this.proxyHealthCheck.get(e.name)&&t){const n=Date.now()-t.lastFailure,i=300*1e3;n>i&&(t.consecutiveFailures=0,this.proxyHealthCheck.set(e.name,!0),this.updateHealthScore(e.name))}})}}const Io=new xo,Co=[{original:"http://feeds.feedburner.com/tecnoblog",alternatives:["https://tecnoblog.net/feed/","https://tecnoblog.net/rss/"],notes:"FeedBurner redirect to direct feed"},{original:"http://feeds.feedburner.com/Techcrunch",alternatives:["https://techcrunch.com/feed/"],notes:"FeedBurner redirect to direct feed"},{original:"http://feeds.feedburner.com/blogdoiphone/rss",alternatives:["https://blogdoiphone.com/feed/"],notes:"FeedBurner redirect to direct feed"},{original:"http://macmagazine.com.br/feed/",alternatives:["https://macmagazine.com.br/feed/"],notes:"HTTP to HTTPS redirect"},{original:"http://feeds2.feedburner.com/canaltechbr",alternatives:["https://canaltech.com.br/rss/","https://canaltech.com.br/feed/"],notes:"FeedBurner redirect to direct feed"},{original:"http://feeds.feedburner.com/guiadopc",alternatives:["https://guiadopc.com.br/feed/"],notes:"FeedBurner redirect to direct feed"},{original:"http://meiobit.com/index.xml",alternatives:["https://meiobit.com/feed/","https://meiobit.com/index.xml"],notes:"HTTP to HTTPS redirect"},{original:"http://feeds.feedburner.com/design-milk",alternatives:["https://design-milk.com/feed/"],notes:"FeedBurner redirect to direct feed"},{original:"http://feeds.feedburner.com/core77/blog",alternatives:["https://www.core77.com/rss/object.xml"],notes:"FeedBurner redirect to direct feed"},{original:"http://feeds.feedburner.com/dezeen",alternatives:["https://www.dezeen.com/feed/"],notes:"FeedBurner redirect to direct feed"},{original:"http://feeds.feedburner.com/JustCreativeDesignBlog",alternatives:["https://justcreative.com/feed/"],notes:"FeedBurner redirect to direct feed"},{original:"http://feeds2.feedburner.com/thenextweb",alternatives:["https://thenextweb.com/feed/"],notes:"FeedBurner redirect to direct feed"},{original:"http://feeds.feedburner.com/brainstorm9",alternatives:["https://www.brainstorm9.com/feed/"],notes:"FeedBurner redirect to direct feed"}];function _o(r){const e=[r],t=Co.find(o=>o.original===r);if(t&&e.push(...t.alternatives),r.startsWith("http://")){const o=r.replace("http://","https://");e.includes(o)||e.push(o)}return[...new Set(e)]}const{entries:qt,setPrototypeOf:Ot,isFrozen:Ro,getPrototypeOf:Do,getOwnPropertyDescriptor:vo}=Object;let{freeze:L,seal:G,create:ht}=Object,{apply:ft,construct:pt}=typeof Reflect<"u"&&Reflect;L||(L=function(e){return e});G||(G=function(e){return e});ft||(ft=function(e,t){for(var o=arguments.length,n=new Array(o>2?o-2:0),i=2;i<o;i++)n[i-2]=arguments[i];return e.apply(t,n)});pt||(pt=function(e){for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];return new e(...o)});const Ue=F(Array.prototype.forEach),No=F(Array.prototype.lastIndexOf),kt=F(Array.prototype.pop),be=F(Array.prototype.push),Mo=F(Array.prototype.splice),He=F(String.prototype.toLowerCase),at=F(String.prototype.toString),ct=F(String.prototype.match),Se=F(String.prototype.replace),Lo=F(String.prototype.indexOf),Fo=F(String.prototype.trim),W=F(Object.prototype.hasOwnProperty),N=F(RegExp.prototype.test),Ae=Po(TypeError);function F(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,o=new Array(t>1?t-1:0),n=1;n<t;n++)o[n-1]=arguments[n];return ft(r,e,o)}}function Po(r){return function(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return pt(r,t)}}function p(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:He;Ot&&Ot(r,null);let o=e.length;for(;o--;){let n=e[o];if(typeof n=="string"){const i=t(n);i!==n&&(Ro(e)||(e[o]=i),n=i)}r[n]=!0}return r}function Oo(r){for(let e=0;e<r.length;e++)W(r,e)||(r[e]=null);return r}function Y(r){const e=ht(null);for(const[t,o]of qt(r))W(r,t)&&(Array.isArray(o)?e[t]=Oo(o):o&&typeof o=="object"&&o.constructor===Object?e[t]=Y(o):e[t]=o);return e}function xe(r,e){for(;r!==null;){const o=vo(r,e);if(o){if(o.get)return F(o.get);if(typeof o.value=="function")return F(o.value)}r=Do(r)}function t(){return null}return t}const Ut=L(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),lt=L(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ut=L(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ko=L(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mt=L(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Uo=L(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),zt=L(["#text"]),Bt=L(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),dt=L(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Ht=L(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ze=L(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),zo=G(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Bo=G(/<%[\w\W]*|[\w\W]*%>/gm),Ho=G(/\$\{[\w\W]*/gm),Go=G(/^data-[\-\w.\u00B7-\uFFFF]+$/),Wo=G(/^aria-[\-\w]+$/),Kt=G(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Xo=G(/^(?:\w+script|data):/i),$o=G(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Jt=G(/^html$/i),jo=G(/^[a-z][.\w]*(-[.\w]+)+$/i);var Gt=Object.freeze({__proto__:null,ARIA_ATTR:Wo,ATTR_WHITESPACE:$o,CUSTOM_ELEMENT:jo,DATA_ATTR:Go,DOCTYPE_NAME:Jt,ERB_EXPR:Bo,IS_ALLOWED_URI:Kt,IS_SCRIPT_OR_DATA:Xo,MUSTACHE_EXPR:zo,TMPLIT_EXPR:Ho});const Ie={element:1,text:3,progressingInstruction:7,comment:8,document:9},Yo=function(){return typeof window>"u"?null:window},Vo=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let o=null;const n="data-tt-policy-suffix";t&&t.hasAttribute(n)&&(o=t.getAttribute(n));const i="dompurify"+(o?"#"+o:"");try{return e.createPolicy(i,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},Wt=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Qt(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Yo();const e=m=>Qt(m);if(e.version="3.3.1",e.removed=[],!r||!r.document||r.document.nodeType!==Ie.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const o=t,n=o.currentScript,{DocumentFragment:i,HTMLTemplateElement:a,Node:u,Element:h,NodeFilter:d,NamedNodeMap:y=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:b,DOMParser:k,trustedTypes:U}=r,P=h.prototype,_e=xe(P,"cloneNode"),We=xe(P,"remove"),Xe=xe(P,"nextSibling"),$e=xe(P,"childNodes"),ee=xe(P,"parentNode");if(typeof a=="function"){const m=t.createElement("template");m.content&&m.content.ownerDocument&&(t=m.content.ownerDocument)}let S,z="";const{implementation:re,createNodeIterator:je,createDocumentFragment:Ye,getElementsByTagName:Ve}=t,{importNode:qe}=o;let _=Wt();e.isSupported=typeof qt=="function"&&typeof ee=="function"&&re&&re.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ne,ERB_EXPR:pe,TMPLIT_EXPR:ge,DATA_ATTR:Re,ARIA_ATTR:Ke,IS_SCRIPT_OR_DATA:Je,ATTR_WHITESPACE:De,CUSTOM_ELEMENT:ve}=Gt;let{IS_ALLOWED_URI:ye}=Gt,x=null;const V=p({},[...Ut,...lt,...ut,...mt,...zt]);let A=null;const te=p({},[...Bt,...dt,...Ht,...ze]);let w=Object.seal(ht(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Z=null,ie=null;const q=Object.seal(ht(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ae=!0,Te=!0,Ne=!1,Me=!0,B=!1,oe=!0,f=!1,T=!1,v=!1,H=!1,ce=!1,Le=!1,Tt=!0,wt=!1;const so="user-content-";let Qe=!0,we=!1,le={},X=null;const Ze=p({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Et=null;const bt=p({},["audio","video","img","source","image","track"]);let et=null;const St=p({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Fe="http://www.w3.org/1998/Math/MathML",Pe="http://www.w3.org/2000/svg",K="http://www.w3.org/1999/xhtml";let ue=K,tt=!1,ot=null;const ro=p({},[Fe,Pe,K],at);let Oe=p({},["mi","mo","mn","ms","mtext"]),ke=p({},["annotation-xml"]);const no=p({},["title","style","font","a","script"]);let Ee=null;const io=["application/xhtml+xml","text/html"],ao="text/html";let C=null,me=null;const co=t.createElement("form"),At=function(s){return s instanceof RegExp||s instanceof Function},st=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(me&&me===s)){if((!s||typeof s!="object")&&(s={}),s=Y(s),Ee=io.indexOf(s.PARSER_MEDIA_TYPE)===-1?ao:s.PARSER_MEDIA_TYPE,C=Ee==="application/xhtml+xml"?at:He,x=W(s,"ALLOWED_TAGS")?p({},s.ALLOWED_TAGS,C):V,A=W(s,"ALLOWED_ATTR")?p({},s.ALLOWED_ATTR,C):te,ot=W(s,"ALLOWED_NAMESPACES")?p({},s.ALLOWED_NAMESPACES,at):ro,et=W(s,"ADD_URI_SAFE_ATTR")?p(Y(St),s.ADD_URI_SAFE_ATTR,C):St,Et=W(s,"ADD_DATA_URI_TAGS")?p(Y(bt),s.ADD_DATA_URI_TAGS,C):bt,X=W(s,"FORBID_CONTENTS")?p({},s.FORBID_CONTENTS,C):Ze,Z=W(s,"FORBID_TAGS")?p({},s.FORBID_TAGS,C):Y({}),ie=W(s,"FORBID_ATTR")?p({},s.FORBID_ATTR,C):Y({}),le=W(s,"USE_PROFILES")?s.USE_PROFILES:!1,ae=s.ALLOW_ARIA_ATTR!==!1,Te=s.ALLOW_DATA_ATTR!==!1,Ne=s.ALLOW_UNKNOWN_PROTOCOLS||!1,Me=s.ALLOW_SELF_CLOSE_IN_ATTR!==!1,B=s.SAFE_FOR_TEMPLATES||!1,oe=s.SAFE_FOR_XML!==!1,f=s.WHOLE_DOCUMENT||!1,H=s.RETURN_DOM||!1,ce=s.RETURN_DOM_FRAGMENT||!1,Le=s.RETURN_TRUSTED_TYPE||!1,v=s.FORCE_BODY||!1,Tt=s.SANITIZE_DOM!==!1,wt=s.SANITIZE_NAMED_PROPS||!1,Qe=s.KEEP_CONTENT!==!1,we=s.IN_PLACE||!1,ye=s.ALLOWED_URI_REGEXP||Kt,ue=s.NAMESPACE||K,Oe=s.MATHML_TEXT_INTEGRATION_POINTS||Oe,ke=s.HTML_INTEGRATION_POINTS||ke,w=s.CUSTOM_ELEMENT_HANDLING||{},s.CUSTOM_ELEMENT_HANDLING&&At(s.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(w.tagNameCheck=s.CUSTOM_ELEMENT_HANDLING.tagNameCheck),s.CUSTOM_ELEMENT_HANDLING&&At(s.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(w.attributeNameCheck=s.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),s.CUSTOM_ELEMENT_HANDLING&&typeof s.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(w.allowCustomizedBuiltInElements=s.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),B&&(Te=!1),ce&&(H=!0),le&&(x=p({},zt),A=[],le.html===!0&&(p(x,Ut),p(A,Bt)),le.svg===!0&&(p(x,lt),p(A,dt),p(A,ze)),le.svgFilters===!0&&(p(x,ut),p(A,dt),p(A,ze)),le.mathMl===!0&&(p(x,mt),p(A,Ht),p(A,ze))),s.ADD_TAGS&&(typeof s.ADD_TAGS=="function"?q.tagCheck=s.ADD_TAGS:(x===V&&(x=Y(x)),p(x,s.ADD_TAGS,C))),s.ADD_ATTR&&(typeof s.ADD_ATTR=="function"?q.attributeCheck=s.ADD_ATTR:(A===te&&(A=Y(A)),p(A,s.ADD_ATTR,C))),s.ADD_URI_SAFE_ATTR&&p(et,s.ADD_URI_SAFE_ATTR,C),s.FORBID_CONTENTS&&(X===Ze&&(X=Y(X)),p(X,s.FORBID_CONTENTS,C)),s.ADD_FORBID_CONTENTS&&(X===Ze&&(X=Y(X)),p(X,s.ADD_FORBID_CONTENTS,C)),Qe&&(x["#text"]=!0),f&&p(x,["html","head","body"]),x.table&&(p(x,["tbody"]),delete Z.tbody),s.TRUSTED_TYPES_POLICY){if(typeof s.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ae('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof s.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ae('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=s.TRUSTED_TYPES_POLICY,z=S.createHTML("")}else S===void 0&&(S=Vo(U,n)),S!==null&&typeof z=="string"&&(z=S.createHTML(""));L&&L(s),me=s}},xt=p({},[...lt,...ut,...ko]),It=p({},[...mt,...Uo]),lo=function(s){let c=ee(s);(!c||!c.tagName)&&(c={namespaceURI:ue,tagName:"template"});const l=He(s.tagName),E=He(c.tagName);return ot[s.namespaceURI]?s.namespaceURI===Pe?c.namespaceURI===K?l==="svg":c.namespaceURI===Fe?l==="svg"&&(E==="annotation-xml"||Oe[E]):!!xt[l]:s.namespaceURI===Fe?c.namespaceURI===K?l==="math":c.namespaceURI===Pe?l==="math"&&ke[E]:!!It[l]:s.namespaceURI===K?c.namespaceURI===Pe&&!ke[E]||c.namespaceURI===Fe&&!Oe[E]?!1:!It[l]&&(no[l]||!xt[l]):!!(Ee==="application/xhtml+xml"&&ot[s.namespaceURI]):!1},$=function(s){be(e.removed,{element:s});try{ee(s).removeChild(s)}catch{We(s)}},se=function(s,c){try{be(e.removed,{attribute:c.getAttributeNode(s),from:c})}catch{be(e.removed,{attribute:null,from:c})}if(c.removeAttribute(s),s==="is")if(H||ce)try{$(c)}catch{}else try{c.setAttribute(s,"")}catch{}},Ct=function(s){let c=null,l=null;if(v)s="<remove></remove>"+s;else{const I=ct(s,/^[\r\n\t ]+/);l=I&&I[0]}Ee==="application/xhtml+xml"&&ue===K&&(s='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+s+"</body></html>");const E=S?S.createHTML(s):s;if(ue===K)try{c=new k().parseFromString(E,Ee)}catch{}if(!c||!c.documentElement){c=re.createDocument(ue,"template",null);try{c.documentElement.innerHTML=tt?z:E}catch{}}const D=c.body||c.documentElement;return s&&l&&D.insertBefore(t.createTextNode(l),D.childNodes[0]||null),ue===K?Ve.call(c,f?"html":"body")[0]:f?c.documentElement:D},_t=function(s){return je.call(s.ownerDocument||s,s,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},rt=function(s){return s instanceof b&&(typeof s.nodeName!="string"||typeof s.textContent!="string"||typeof s.removeChild!="function"||!(s.attributes instanceof y)||typeof s.removeAttribute!="function"||typeof s.setAttribute!="function"||typeof s.namespaceURI!="string"||typeof s.insertBefore!="function"||typeof s.hasChildNodes!="function")},Rt=function(s){return typeof u=="function"&&s instanceof u};function J(m,s,c){Ue(m,l=>{l.call(e,s,c,me)})}const Dt=function(s){let c=null;if(J(_.beforeSanitizeElements,s,null),rt(s))return $(s),!0;const l=C(s.nodeName);if(J(_.uponSanitizeElement,s,{tagName:l,allowedTags:x}),oe&&s.hasChildNodes()&&!Rt(s.firstElementChild)&&N(/<[/\w!]/g,s.innerHTML)&&N(/<[/\w!]/g,s.textContent)||s.nodeType===Ie.progressingInstruction||oe&&s.nodeType===Ie.comment&&N(/<[/\w]/g,s.data))return $(s),!0;if(!(q.tagCheck instanceof Function&&q.tagCheck(l))&&(!x[l]||Z[l])){if(!Z[l]&&Nt(l)&&(w.tagNameCheck instanceof RegExp&&N(w.tagNameCheck,l)||w.tagNameCheck instanceof Function&&w.tagNameCheck(l)))return!1;if(Qe&&!X[l]){const E=ee(s)||s.parentNode,D=$e(s)||s.childNodes;if(D&&E){const I=D.length;for(let O=I-1;O>=0;--O){const Q=_e(D[O],!0);Q.__removalCount=(s.__removalCount||0)+1,E.insertBefore(Q,Xe(s))}}}return $(s),!0}return s instanceof h&&!lo(s)||(l==="noscript"||l==="noembed"||l==="noframes")&&N(/<\/no(script|embed|frames)/i,s.innerHTML)?($(s),!0):(B&&s.nodeType===Ie.text&&(c=s.textContent,Ue([ne,pe,ge],E=>{c=Se(c,E," ")}),s.textContent!==c&&(be(e.removed,{element:s.cloneNode()}),s.textContent=c)),J(_.afterSanitizeElements,s,null),!1)},vt=function(s,c,l){if(Tt&&(c==="id"||c==="name")&&(l in t||l in co))return!1;if(!(Te&&!ie[c]&&N(Re,c))){if(!(ae&&N(Ke,c))){if(!(q.attributeCheck instanceof Function&&q.attributeCheck(c,s))){if(!A[c]||ie[c]){if(!(Nt(s)&&(w.tagNameCheck instanceof RegExp&&N(w.tagNameCheck,s)||w.tagNameCheck instanceof Function&&w.tagNameCheck(s))&&(w.attributeNameCheck instanceof RegExp&&N(w.attributeNameCheck,c)||w.attributeNameCheck instanceof Function&&w.attributeNameCheck(c,s))||c==="is"&&w.allowCustomizedBuiltInElements&&(w.tagNameCheck instanceof RegExp&&N(w.tagNameCheck,l)||w.tagNameCheck instanceof Function&&w.tagNameCheck(l))))return!1}else if(!et[c]){if(!N(ye,Se(l,De,""))){if(!((c==="src"||c==="xlink:href"||c==="href")&&s!=="script"&&Lo(l,"data:")===0&&Et[s])){if(!(Ne&&!N(Je,Se(l,De,"")))){if(l)return!1}}}}}}}return!0},Nt=function(s){return s!=="annotation-xml"&&ct(s,ve)},Mt=function(s){J(_.beforeSanitizeAttributes,s,null);const{attributes:c}=s;if(!c||rt(s))return;const l={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:A,forceKeepAttr:void 0};let E=c.length;for(;E--;){const D=c[E],{name:I,namespaceURI:O,value:Q}=D,de=C(I),nt=Q;let R=I==="value"?nt:Fo(nt);if(l.attrName=de,l.attrValue=R,l.keepAttr=!0,l.forceKeepAttr=void 0,J(_.uponSanitizeAttribute,s,l),R=l.attrValue,wt&&(de==="id"||de==="name")&&(se(I,s),R=so+R),oe&&N(/((--!?|])>)|<\/(style|title|textarea)/i,R)){se(I,s);continue}if(de==="attributename"&&ct(R,"href")){se(I,s);continue}if(l.forceKeepAttr)continue;if(!l.keepAttr){se(I,s);continue}if(!Me&&N(/\/>/i,R)){se(I,s);continue}B&&Ue([ne,pe,ge],Ft=>{R=Se(R,Ft," ")});const Lt=C(s.nodeName);if(!vt(Lt,de,R)){se(I,s);continue}if(S&&typeof U=="object"&&typeof U.getAttributeType=="function"&&!O)switch(U.getAttributeType(Lt,de)){case"TrustedHTML":{R=S.createHTML(R);break}case"TrustedScriptURL":{R=S.createScriptURL(R);break}}if(R!==nt)try{O?s.setAttributeNS(O,I,R):s.setAttribute(I,R),rt(s)?$(s):kt(e.removed)}catch{se(I,s)}}J(_.afterSanitizeAttributes,s,null)},uo=function m(s){let c=null;const l=_t(s);for(J(_.beforeSanitizeShadowDOM,s,null);c=l.nextNode();)J(_.uponSanitizeShadowNode,c,null),Dt(c),Mt(c),c.content instanceof i&&m(c.content);J(_.afterSanitizeShadowDOM,s,null)};return e.sanitize=function(m){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=null,l=null,E=null,D=null;if(tt=!m,tt&&(m="<!-->"),typeof m!="string"&&!Rt(m))if(typeof m.toString=="function"){if(m=m.toString(),typeof m!="string")throw Ae("dirty is not a string, aborting")}else throw Ae("toString is not a function");if(!e.isSupported)return m;if(T||st(s),e.removed=[],typeof m=="string"&&(we=!1),we){if(m.nodeName){const Q=C(m.nodeName);if(!x[Q]||Z[Q])throw Ae("root node is forbidden and cannot be sanitized in-place")}}else if(m instanceof u)c=Ct("<!---->"),l=c.ownerDocument.importNode(m,!0),l.nodeType===Ie.element&&l.nodeName==="BODY"||l.nodeName==="HTML"?c=l:c.appendChild(l);else{if(!H&&!B&&!f&&m.indexOf("<")===-1)return S&&Le?S.createHTML(m):m;if(c=Ct(m),!c)return H?null:Le?z:""}c&&v&&$(c.firstChild);const I=_t(we?m:c);for(;E=I.nextNode();)Dt(E),Mt(E),E.content instanceof i&&uo(E.content);if(we)return m;if(H){if(ce)for(D=Ye.call(c.ownerDocument);c.firstChild;)D.appendChild(c.firstChild);else D=c;return(A.shadowroot||A.shadowrootmode)&&(D=qe.call(o,D,!0)),D}let O=f?c.outerHTML:c.innerHTML;return f&&x["!doctype"]&&c.ownerDocument&&c.ownerDocument.doctype&&c.ownerDocument.doctype.name&&N(Jt,c.ownerDocument.doctype.name)&&(O="<!DOCTYPE "+c.ownerDocument.doctype.name+`>
`+O),B&&Ue([ne,pe,ge],Q=>{O=Se(O,Q," ")}),S&&Le?S.createHTML(O):O},e.setConfig=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};st(m),T=!0},e.clearConfig=function(){me=null,T=!1},e.isValidAttribute=function(m,s,c){me||st({});const l=C(m),E=C(s);return vt(l,E,c)},e.addHook=function(m,s){typeof s=="function"&&be(_[m],s)},e.removeHook=function(m,s){if(s!==void 0){const c=No(_[m],s);return c===-1?void 0:Mo(_[m],c,1)[0]}return kt(_[m])},e.removeHooks=function(m){_[m]=[]},e.removeAllHooks=function(){_=Wt()},e}var Zt=Qt();const Es=Object.freeze(Object.defineProperty({__proto__:null,default:Zt},Symbol.toStringTag,{value:"Module"})),yt=Zt(typeof window<"u"?window:void 0);yt.addHook("afterSanitizeAttributes",function(r){"target"in r&&r.tagName==="A"&&(r.setAttribute("target","_blank"),r.setAttribute("rel","noopener noreferrer"))});function eo(r){return r?yt.sanitize(r,{ALLOWED_TAGS:["p","br","b","i","em","strong","u","a","img","h1","h2","h3","h4","h5","h6","ul","ol","li","blockquote","code","pre","span","div","table","thead","tbody","tr","td","th"],ALLOWED_ATTR:["href","src","alt","title","class","target","rel","width","height"],FORBID_TAGS:["script","style","iframe","object","embed","form","input","button"]}):""}function qo(r){if(!r)return"";const e=yt.sanitize(r,{ALLOWED_TAGS:[],KEEP_CONTENT:!0});if(typeof document<"u"){const o=document.createElement("textarea");return o.innerHTML=e,o.value}let t=r;for(let o=0;o<5;o++){const n=t;if(t=t.replace(/&amp;/g,"&"),t=t.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").replace(/&apos;/g,"'").replace(/&#x27;/g,"'").replace(/&#x2F;/g,"/").replace(/&#(\d+);/g,(i,a)=>String.fromCharCode(parseInt(a,10))).replace(/&#x([0-9a-f]+);/gi,(i,a)=>String.fromCharCode(parseInt(a,16))),t=t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<iframe\b[^<]*(?:(?!<\/iframe>)<[^<]*)*<\/iframe>/gi,"").replace(/on\w+\s*=\s*["'][^"']*["']/gi,"").replace(/javascript:/gi,"").replace(/vbscript:/gi,"").replace(/data:text\/html/gi,"").replace(/<[^>]*>/g,"").replace(/<[^<]*$/g,""),t===n)break}return t=t.replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F]/g,"").trim(),t}function bs(r,e=300){const t=qo(r);if(t.length<=e)return t;const o=t.substring(0,e),n=o.lastIndexOf(" ");return n>e*.8?o.substring(0,n)+"...":o+"..."}const Ko=2,Jo=1e3,fe=go();function to(r){return r?r.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim():""}function he(r){return r?r.replace(/[\n\r]+/g," ").trim():"No Title"}function oo(r){return r?r.replace(/[\n\r]+/g," ").trim():""}function j(r,e){return r.getAttribute(e)}function Qo(r){if(r.length===0)return;r.sort((t,o)=>{const n=(t.width||0)>=800,i=(o.width||0)>=800;if(n&&!i)return-1;if(!n&&i)return 1;const a=t.score+(t.source==="media:content"||t.source==="enclosure"?2:0),u=o.score+(o.source==="media:content"||o.source==="enclosure"?2:0);return t.width&&o.width&&t.width!==o.width?o.width-t.width:t.size&&o.size&&t.size!==o.size?o.size-t.size:u-a});const e=r.filter(t=>!t.width||t.width>50);return e.length>0?e[0].url:r[0].url}function Zo(r,e){let t;try{t=JSON.parse(r)}catch{throw new Error("Failed to parse JSON response")}if(t.status!=="ok"&&!t.items)throw new Error("Invalid RSS2JSON response format");const o=he(t.feed?.title||"Untitled Feed"),n=[],i=t.items||[];for(const a of i)try{const u=he(a.title||"No Title"),h=a.link||"",d=new Date(a.pubDate||a.created||Date.now()),y=to(a.description||a.content||"").substring(0,500),b=eo(a.content||a.description||""),k=oo(a.author||""),U=Array.isArray(a.categories)?a.categories:[];let P=a.thumbnail||a.enclosure?.link;P&&!P.startsWith("http")&&(P=void 0),u!=="No Title"&&h&&n.push({title:u,link:h,pubDate:d,description:y,content:b,imageUrl:P,author:k,categories:U,sourceTitle:o})}catch{fe.warn("Failed to parse JSON item",{component:"rssParser"})}return{title:o,articles:n}}function es(r,e){const t=Ao(r),o=t.getElementsByTagName("parsererror");if(o.length>0)throw new Error(`XML parsing error: ${o[0].textContent}`);let n="Untitled Feed",i;const a=t.getElementsByTagName("channel");if(a.length>0)n=a[0].getElementsByTagName("title")[0]?.textContent?.trim()||"Untitled Feed",n=he(n),i=t.getElementsByTagName("item");else{const h=t.getElementsByTagName("feed");if(h.length>0)n=h[0].getElementsByTagName("title")[0]?.textContent?.trim()||"Untitled Feed",n=he(n),i=t.getElementsByTagName("entry");else{const d=t.getElementsByTagName("item");if(d.length>0){const y=t.getElementsByTagName("channel");y.length>0&&(n=y[0].getElementsByTagName("title")[0]?.textContent?.trim()||"Untitled Feed",n=he(n)),i=d}else throw new Error("Unsupported RSS format")}}const u=[];for(let h=0;h<Math.min(i.length,50);h++){const d=i[h];try{const b=d.getElementsByTagName("title")[0]?.textContent?.trim()||"No Title",k=he(b);let U="";const P=d.getElementsByTagName("link");P.length>0&&(U=P[0].textContent?.trim()||P[0].getAttribute("href")||"");let _e=new Date;const We=d.getElementsByTagName("pubDate"),Xe=d.getElementsByTagName("published"),$e=d.getElementsByTagName("date"),ee=We[0]||Xe[0]||$e[0];if(ee?.textContent){const f=new Date(ee.textContent.trim());isNaN(f.getTime())||(_e=f)}let S="",z="";const re=d.getElementsByTagName("description"),je=d.getElementsByTagName("summary"),Ye=d.getElementsByTagName("content"),Ve=d.getElementsByTagName("content:encoded"),qe=d.getElementsByTagName("body"),_=re[0]||je[0];_?.textContent&&(S=_.textContent);const ne=Ve[0]||Ye[0]||qe[0]||re[0];ne?.textContent&&(z=ne.textContent),!S&&z&&(S=z),!z&&S&&(z=S);const pe=to(S).substring(0,500),ge=eo(z);let Re="";const Ke=d.getElementsByTagName("author"),Je=d.getElementsByTagName("creator"),De=d.getElementsByTagName("dc:creator"),ve=Ke[0]||De[0]||Je[0];ve?.textContent&&(Re=oo(ve.textContent.trim()));const ye=[],x=d.getElementsByTagName("category");for(let f=0;f<x.length;f++){const T=x[f].textContent?.trim();T&&ye.push(T)}const V=[];let A="",te="";const w=d.getElementsByTagName("enclosure");for(let f=0;f<w.length;f++){const T=w[f],v=j(T,"type")||"",H=j(T,"url");H&&(v.startsWith("image/")?V.push({url:H,size:parseInt(j(T,"length")||"0"),source:"enclosure",score:10}):v.startsWith("audio/")&&!A&&(A=H))}const Z=f=>{const T=j(f,"url"),v=j(f,"type")||j(f,"medium")||"",H=parseInt(j(f,"width")||"0"),ce=parseInt(j(f,"height")||"0");T&&(v.startsWith("image")||v==="image")&&V.push({url:T,width:H,height:ce,source:"media:content",score:10+(H>600?5:0)})},ie=d.getElementsByTagName("media:group");for(let f=0;f<ie.length;f++){const T=ie[f].getElementsByTagName("media:content");for(let v=0;v<T.length;v++)Z(T[v])}const q=d.getElementsByTagName("media:content");for(let f=0;f<q.length;f++)Z(q[f]);const ae=d.getElementsByTagName("media:thumbnail");for(let f=0;f<ae.length;f++){const T=j(ae[f],"url"),v=parseInt(j(ae[f],"width")||"0");T&&V.push({url:T,width:v,source:"media:thumbnail",score:5})}const Te=z||S||"",Ne=[/<img[^>]+src=["']([^"']+)["'][^>]*>/gi],Me=Te.substring(0,3e3);for(const f of Ne){let T;for(;(T=f.exec(Me))!==null&&!(T[1]&&(V.push({url:T[1],source:"html",score:1}),V.length>3)););}if(A&&!te){const f=d.getElementsByTagName("itunes:duration")[0],T=d.getElementsByTagName("duration")[0];f?.textContent?te=f.textContent.trim():T?.textContent&&(te=T.textContent.trim())}const B=Qo(V);let oe;if(B)try{const f=new URL(B);(f.protocol==="http:"||f.protocol==="https:")&&!B.includes("?text=")&&!B.match(/^[A-Z0-9]{6}\?text=/i)&&B.includes(".")&&(oe=B)}catch{}k!=="No Title"&&U&&u.push({title:k,link:U,pubDate:_e,description:pe,content:ge||void 0,imageUrl:oe,author:Re||void 0,categories:ye,sourceTitle:n,audioUrl:A||void 0,audioDuration:te||void 0})}catch{fe.warn(`Failed to parse article ${h+1}`,{component:"rssParser"})}}return{title:n,articles:u}}function ts(r){if(!r||r.trim().length===0)return!1;const e=r.trim();return e.toLowerCase().includes("<!doctype html")||e.toLowerCase().startsWith("<html")?!1:e.startsWith("<")||e.startsWith("{")}async function os(r,e){const t=_o(r);let o=new Error("Unknown error");for(const n of t)try{const i=await Io.tryProxiesWithFailover(n),a=i.content;if(!ts(a))throw new Error(`Invalid response format from proxy (${i.proxyUsed})`);if(a.trim().startsWith("{"))try{const h=Zo(a,n);if(h.articles.length>0)return h}catch{}const u=es(a,n);if(u.articles.length>0)return u}catch(i){o=i instanceof Error?i:new Error(String(i)),fe.warn(`Failed to fetch/parse ${n} via ProxyManager`,{component:"rssParser",additionalData:{error:o.message}})}throw new Error(`Failed to fetch RSS feed: ${o.message}`)}function ss(r){return new Promise(e=>setTimeout(e,r))}async function rs(r,e={}){const{maxRetries:t=Ko,signal:o}=e;let n=new Error("Unknown error");for(let i=1;i<=t;i++)try{const a=await os(r,o);return a.articles.length>0&&wo(r,a.articles,a.title),a}catch(a){if(n=a instanceof Error?a:new Error(String(a)),o?.aborted)throw new Error("Request was cancelled");if(i===t)break;const u=Jo*Math.pow(2,i-1);await ss(u)}throw fe.error(`All ${t} attempts failed`,n,{component:"rssParser",additionalData:{feedUrl:r}}),n}async function Ss(r,e={}){const{skipCache:t=!1}=e;if(!t){const o=To(r);if(o&&o.length>0)return fe.debug("Using cached articles",{component:"rssParser",additionalData:{feedUrl:r,cachedCount:o.length}}),{title:o[0].sourceTitle,articles:o}}try{return await rs(r,e)}catch(o){return fe.warn("Creating placeholder for failed feed",{component:"rssParser",additionalData:{url:r,error:o instanceof Error?o.message:String(o)}}),{title:"Feed Unavailable",articles:[{title:"RSS Feed Temporarily Unavailable",link:r,pubDate:new Date,description:"Unable to fetch this RSS feed. This may be due to CORS restrictions or temporary server issues. The feed will be retried automatically.",sourceTitle:"System Notice",categories:["system","unavailable"]}]}}}function As(r){const t=new DOMParser().parseFromString(r,"text/xml"),o=[],n=(a,u)=>{const h=a.getAttribute("xmlUrl"),d=a.getAttribute("text")||a.getAttribute("title");if(h)o.push({url:h,title:d||void 0,category:u});else if(a.children.length>0){const y=d||u;for(let b=0;b<a.children.length;b++){const k=a.children[b];k.tagName.toLowerCase()==="outline"&&n(k,y)}}},i=t.getElementsByTagName("body")[0];if(i)for(let a=0;a<i.children.length;a++){const u=i.children[a];u.tagName.toLowerCase()==="outline"&&n(u)}return o}function xs(r){const e={articles:new Map,titleIndex:new Map,contentIndex:new Map,categoryIndex:new Map,sourceIndex:new Map,lastUpdated:Date.now()};return r.forEach((t,o)=>{const n=`${t.link}-${o}`;e.articles.set(n,t),Ce(t.title).forEach(u=>{e.titleIndex.has(u)||e.titleIndex.set(u,[]),e.titleIndex.get(u).push(n)}),t.description&&Ce(t.description).forEach(h=>{e.contentIndex.has(h)||e.contentIndex.set(h,[]),e.contentIndex.get(h).push(n)}),t.categories&&t.categories.forEach(u=>{Ce(u).forEach(d=>{e.categoryIndex.has(d)||e.categoryIndex.set(d,[]),e.categoryIndex.get(d).push(n)})}),Ce(t.sourceTitle).forEach(u=>{e.sourceIndex.has(u)||e.sourceIndex.set(u,[]),e.sourceIndex.get(u).push(n)})}),e}function Ce(r){return r.toLowerCase().replace(/[^\w\s]/g," ").split(/\s+/).filter(e=>e.length>2)}function Is(r,e,t={}){const{includeTitle:o=!0,includeContent:n=!0,includeCategories:i=!0,includeSource:a=!0,fuzzyThreshold:u=.6}=t;if(!e.trim())return[];const h=Ce(e),d=new Map;h.forEach(b=>{o&&Be(r.titleIndex,b,u,d,"title",3),n&&Be(r.contentIndex,b,u,d,"content",1),i&&Be(r.categoryIndex,b,u,d,"category",2),a&&Be(r.sourceIndex,b,u,d,"source",1.5)});const y=[];return d.forEach((b,k)=>{const U=r.articles.get(k);U&&y.push({article:U,score:b.score,matchedFields:Array.from(b.matchedFields)})}),y.sort((b,k)=>k.score-b.score)}function Be(r,e,t,o,n,i){r.forEach((a,u)=>{const h=ns(e,u);if(h>=t){const d=h*i;a.forEach(y=>{o.has(y)||o.set(y,{score:0,matchedFields:new Set});const b=o.get(y);b.score+=d,b.matchedFields.add(n)})}})}function ns(r,e){if(r===e)return 1;if(r.includes(e)||e.includes(r))return .9;const t=Math.max(r.length,e.length);return t===0?1:1-is(r,e)/t}function is(r,e){const t=Array(e.length+1).fill(null).map(()=>Array(r.length+1).fill(null));for(let o=0;o<=r.length;o++)t[0][o]=o;for(let o=0;o<=e.length;o++)t[o][0]=o;for(let o=1;o<=e.length;o++)for(let n=1;n<=r.length;n++){const i=r[n-1]===e[o-1]?0:1;t[o][n]=Math.min(t[o][n-1]+1,t[o-1][n]+1,t[o-1][n-1]+i)}return t[e.length][r.length]}function Cs(r,e){if(!e.trim())return r;const t=e.trim().split(/\s+/);let o=r;return t.forEach(n=>{const i=as(n),a=new RegExp(`(${i})`,"gi");o=o.replace(a,"<mark>$1</mark>")}),o}function as(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const Xt={log:r=>{}},cs={maxSize:500,maxAge:1440*60*1e3,memoryLimit:50,autoCleanupInterval:300*1e3};class ls{constructor(e={}){this.options={...cs,...e},this.cache=new Map,this.stats={hits:0,misses:0,evictions:0},this.cleanupInterval=null,this.options.autoCleanupInterval>0&&this.startAutoCleanup()}getKey(e){return`${e.link}|${e.sourceTitle}`}get(e,t){let o;if(typeof e=="string"&&t)o=`${e}|${t}`;else if(typeof e=="object")o=this.getKey(e);else throw new Error("Invalid arguments to get()");const n=this.cache.get(o);return n?(this.cache.delete(o),this.cache.set(o,{article:n.article,timestamp:n.timestamp}),this.stats.hits++,n.article):(this.stats.misses++,null)}set(e){const t=this.getKey(e);this.cache.delete(t),this.cache.set(t,{article:e,timestamp:Date.now()}),this.enforceConstraints()}setMany(e){e.forEach(t=>this.set(t))}has(e,t){let o;if(typeof e=="string"&&t)o=`${e}|${t}`;else if(typeof e=="object")o=this.getKey(e);else throw new Error("Invalid arguments to has()");return this.cache.has(o)}delete(e,t){let o;if(typeof e=="string"&&t)o=`${e}|${t}`;else if(typeof e=="object")o=this.getKey(e);else throw new Error("Invalid arguments to delete()");return this.cache.delete(o)}clear(){this.cache.clear()}size(){return this.cache.size}getAll(){return Array.from(this.cache.values()).map(e=>e.article)}getStats(){const e=Date.now();let t=0,o=e,n=0;this.cache.forEach(({timestamp:y})=>{t+=e-y,y<o&&(o=y),y>n&&(n=y)});const i=this.cache.size,a=i>0?t/i:0,u=i>0?e-o:0,h=i>0?e-n:0;let d=null;return"memory"in performance&&(d=Math.round(performance.memory.usedJSHeapSize/(1024*1024))),{hits:this.stats.hits,misses:this.stats.misses,hitRate:this.stats.hits+this.stats.misses>0?this.stats.hits/(this.stats.hits+this.stats.misses):0,size:i,maxSize:this.options.maxSize,evictions:this.stats.evictions,oldestItemAge:u,newestItemAge:h,averageAge:a,memoryUsage:d}}enforceConstraints(){this.enforceMaxSize(),this.enforceMaxAge(),this.enforceMemoryLimit()}enforceMaxSize(){if(this.cache.size<=this.options.maxSize)return;const e=this.cache.size-this.options.maxSize;if(e<=0)return;const t=Array.from(this.cache.entries()).sort((o,n)=>o[1].timestamp-n[1].timestamp);for(let o=0;o<e;o++)o<t.length&&(this.cache.delete(t[o][0]),this.stats.evictions++)}enforceMaxAge(){if(this.options.maxAge<=0)return;const e=Date.now();this.cache.forEach((t,o)=>{e-t.timestamp>this.options.maxAge&&(this.cache.delete(o),this.stats.evictions++)})}enforceMemoryLimit(){if(this.options.memoryLimit<=0||!("memory"in performance))return;const t=performance.memory.usedJSHeapSize/(1024*1024);if(t<this.options.memoryLimit)return;const o=Math.max(1,Math.ceil(this.cache.size*.1)),n=Array.from(this.cache.entries()).sort((i,a)=>i[1].timestamp-a[1].timestamp);for(let i=0;i<o&&i<n.length;i++)this.cache.delete(n[i][0]),this.stats.evictions++;Xt.log(`Evicted ${o} articles from cache due to memory limit (${t.toFixed(2)}MB used)`)}startAutoCleanup(){this.cleanupInterval===null&&(this.cleanupInterval=window.setInterval(()=>{this.cleanup()},this.options.autoCleanupInterval),Xt.log(`Started automatic cache cleanup every ${this.options.autoCleanupInterval/1e3} seconds`))}stopAutoCleanup(){this.cleanupInterval!==null&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null)}cleanup(){this.cache.size,this.enforceMaxAge(),this.enforceMemoryLimit(),this.cache.size}resetStats(){this.stats={hits:0,misses:0,evictions:0}}}const _s=new ls;export{ds as C,us as D,mo as I,_s as a,ys as b,ps as c,Ge as d,hs as e,To as f,gs as g,ms as h,ws as i,xs as j,qo as k,Cs as l,fs as m,Zt as n,Io as o,Ss as p,As as q,bs as r,Is as s,Es as t,Ts as u,ho as v};
