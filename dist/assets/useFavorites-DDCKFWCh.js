import{r as i}from"./performance-DGmBAmJn.js";import{o as m}from"./index-Cghj9Ouz.js";const u=t=>{const s=`${t.link}-${t.title}`;let r=0;for(let n=0;n<s.length;n++){const l=s.charCodeAt(n);r=(r<<5)-r+l,r=r&r}return Math.abs(r).toString(36)},D=t=>({id:u(t),title:t.title,link:t.link,pubDate:t.pubDate.toISOString(),sourceTitle:t.sourceTitle,imageUrl:t.imageUrl,description:t.description,author:t.author,categories:t.categories,favoritedAt:new Date().toISOString()}),k=t=>({title:t.title,link:t.link,pubDate:new Date(t.pubDate),sourceTitle:t.sourceTitle,imageUrl:t.imageUrl,description:t.description,author:t.author,categories:t.categories}),F=()=>{const[t,s]=m("favorites-data",{articles:[],lastUpdated:new Date().toISOString()}),r=i.useMemo(()=>t.articles,[t.articles]),n=i.useCallback(e=>{const a=u(e);return r.some(o=>o.id===a)},[r]),l=i.useCallback(e=>{if(n(e))return;const a=D(e);s(o=>({articles:[a,...o.articles],lastUpdated:new Date().toISOString()}))},[n,s]),c=i.useCallback(e=>{const a=u(e);s(o=>({articles:o.articles.filter(w=>w.id!==a),lastUpdated:new Date().toISOString()}))},[s]),d=i.useCallback(e=>{n(e)?c(e):l(e)},[n,l,c]),g=i.useCallback(()=>{s({articles:[],lastUpdated:new Date().toISOString()})},[s]),p=i.useCallback(()=>r.length,[r.length]),S=i.useCallback(()=>{const e={...t,exportedAt:new Date().toISOString(),version:"1.0"};return JSON.stringify(e,null,2)},[t]),f=i.useCallback(e=>{try{const a=JSON.parse(e);if(!a.articles||!Array.isArray(a.articles))throw new Error("Invalid favorites data format");for(const o of a.articles)if(!o.id||!o.title||!o.link||!o.pubDate)throw new Error("Invalid article data in favorites");return s({articles:a.articles,lastUpdated:new Date().toISOString()}),!0}catch(a){return console.error("Failed to import favorites:",a),!1}},[s]),C=i.useCallback(e=>!e||e==="All"?r:r.filter(a=>a.categories?.some(o=>o.toLowerCase()===e.toLowerCase())),[r]),v=i.useCallback(e=>e?r.filter(a=>a.sourceTitle.toLowerCase().includes(e.toLowerCase())||a.author?.toLowerCase().includes(e.toLowerCase())):r,[r]);return{favorites:r,isFavorite:n,addToFavorites:l,removeFromFavorites:c,toggleFavorite:d,clearAllFavorites:g,getFavoritesCount:p,exportFavorites:S,importFavorites:f,getFavoritesByCategory:C,getFavoritesBySource:v}};export{k as f,F as u};
